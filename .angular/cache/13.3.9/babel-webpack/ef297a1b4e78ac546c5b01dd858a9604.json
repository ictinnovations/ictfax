{"ast":null,"code":"import { ChangeDetectionStrategy, ChangeDetectorRef, Component, Inject, Injectable, InjectionToken, Injector, NgModule } from '@angular/core';\nimport { CommonModule, Location } from '@angular/common';\nimport { ActivatedRoute, Router, RouterModule } from '@angular/router';\nimport { FormsModule } from '@angular/forms';\nimport { NB_WINDOW, NbAlertModule, NbButtonModule, NbCardModule, NbCheckboxModule, NbIconModule, NbInputModule, NbLayoutModule } from '@nebular/theme';\nimport { BehaviorSubject, of } from 'rxjs';\nimport { catchError, delay, filter, map, share, switchMap, takeWhile } from 'rxjs/operators';\nimport { HttpClient, HttpErrorResponse, HttpHeaders, HttpResponse } from '@angular/common/http';\nimport * as ɵngcc0 from '@angular/core';\nimport * as ɵngcc1 from '@angular/common/http';\nimport * as ɵngcc2 from '@angular/router';\nimport * as ɵngcc3 from '@angular/common';\nimport * as ɵngcc4 from '@nebular/theme';\nimport * as ɵngcc5 from '@angular/forms';\nconst _c0 = [\"*\"];\n\nfunction NbLoginComponent_nb_alert_4_li_5_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵelementStart(0, \"li\", 26);\n    ɵngcc0.ɵɵtext(1);\n    ɵngcc0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const error_r10 = ctx.$implicit;\n    ɵngcc0.ɵɵadvance(1);\n    ɵngcc0.ɵɵtextInterpolate(error_r10);\n  }\n}\n\nfunction NbLoginComponent_nb_alert_4_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵelementStart(0, \"nb-alert\", 22)(1, \"p\", 23)(2, \"b\");\n    ɵngcc0.ɵɵtext(3, \"Oh snap!\");\n    ɵngcc0.ɵɵelementEnd()();\n    ɵngcc0.ɵɵelementStart(4, \"ul\", 24);\n    ɵngcc0.ɵɵtemplate(5, NbLoginComponent_nb_alert_4_li_5_Template, 2, 1, \"li\", 25);\n    ɵngcc0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = ɵngcc0.ɵɵnextContext();\n    ɵngcc0.ɵɵadvance(5);\n    ɵngcc0.ɵɵproperty(\"ngForOf\", ctx_r0.errors);\n  }\n}\n\nfunction NbLoginComponent_nb_alert_5_li_5_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵelementStart(0, \"li\", 26);\n    ɵngcc0.ɵɵtext(1);\n    ɵngcc0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const message_r12 = ctx.$implicit;\n    ɵngcc0.ɵɵadvance(1);\n    ɵngcc0.ɵɵtextInterpolate(message_r12);\n  }\n}\n\nfunction NbLoginComponent_nb_alert_5_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵelementStart(0, \"nb-alert\", 27)(1, \"p\", 23)(2, \"b\");\n    ɵngcc0.ɵɵtext(3, \"Hooray!\");\n    ɵngcc0.ɵɵelementEnd()();\n    ɵngcc0.ɵɵelementStart(4, \"ul\", 24);\n    ɵngcc0.ɵɵtemplate(5, NbLoginComponent_nb_alert_5_li_5_Template, 2, 1, \"li\", 25);\n    ɵngcc0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const ctx_r1 = ɵngcc0.ɵɵnextContext();\n    ɵngcc0.ɵɵadvance(5);\n    ɵngcc0.ɵɵproperty(\"ngForOf\", ctx_r1.messages);\n  }\n}\n\nfunction NbLoginComponent_ng_container_13_p_1_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵelementStart(0, \"p\", 29);\n    ɵngcc0.ɵɵtext(1, \" Email is required! \");\n    ɵngcc0.ɵɵelementEnd();\n  }\n}\n\nfunction NbLoginComponent_ng_container_13_p_2_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵelementStart(0, \"p\", 29);\n    ɵngcc0.ɵɵtext(1, \" Email should be the real one! \");\n    ɵngcc0.ɵɵelementEnd();\n  }\n}\n\nfunction NbLoginComponent_ng_container_13_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵelementContainerStart(0);\n    ɵngcc0.ɵɵtemplate(1, NbLoginComponent_ng_container_13_p_1_Template, 2, 0, \"p\", 28);\n    ɵngcc0.ɵɵtemplate(2, NbLoginComponent_ng_container_13_p_2_Template, 2, 0, \"p\", 28);\n    ɵngcc0.ɵɵelementContainerEnd();\n  }\n\n  if (rf & 2) {\n    ɵngcc0.ɵɵnextContext();\n\n    const _r3 = ɵngcc0.ɵɵreference(12);\n\n    ɵngcc0.ɵɵadvance(1);\n    ɵngcc0.ɵɵproperty(\"ngIf\", _r3.errors == null ? null : _r3.errors.required);\n    ɵngcc0.ɵɵadvance(1);\n    ɵngcc0.ɵɵproperty(\"ngIf\", _r3.errors == null ? null : _r3.errors.pattern);\n  }\n}\n\nfunction NbLoginComponent_ng_container_22_p_1_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵelementStart(0, \"p\", 29);\n    ɵngcc0.ɵɵtext(1, \" Password is required! \");\n    ɵngcc0.ɵɵelementEnd();\n  }\n}\n\nfunction NbLoginComponent_ng_container_22_p_2_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵelementStart(0, \"p\", 29);\n    ɵngcc0.ɵɵtext(1);\n    ɵngcc0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r16 = ɵngcc0.ɵɵnextContext(2);\n    ɵngcc0.ɵɵadvance(1);\n    ɵngcc0.ɵɵtextInterpolate2(\" Password should contain from \", ctx_r16.getConfigValue(\"forms.validation.password.minLength\"), \" to \", ctx_r16.getConfigValue(\"forms.validation.password.maxLength\"), \" characters \");\n  }\n}\n\nfunction NbLoginComponent_ng_container_22_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵelementContainerStart(0);\n    ɵngcc0.ɵɵtemplate(1, NbLoginComponent_ng_container_22_p_1_Template, 2, 0, \"p\", 28);\n    ɵngcc0.ɵɵtemplate(2, NbLoginComponent_ng_container_22_p_2_Template, 2, 2, \"p\", 28);\n    ɵngcc0.ɵɵelementContainerEnd();\n  }\n\n  if (rf & 2) {\n    ɵngcc0.ɵɵnextContext();\n\n    const _r5 = ɵngcc0.ɵɵreference(21);\n\n    ɵngcc0.ɵɵadvance(1);\n    ɵngcc0.ɵɵproperty(\"ngIf\", _r5.errors == null ? null : _r5.errors.required);\n    ɵngcc0.ɵɵadvance(1);\n    ɵngcc0.ɵɵproperty(\"ngIf\", (_r5.errors == null ? null : _r5.errors.minlength) || (_r5.errors == null ? null : _r5.errors.maxlength));\n  }\n}\n\nfunction NbLoginComponent_nb_checkbox_24_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r18 = ɵngcc0.ɵɵgetCurrentView();\n\n    ɵngcc0.ɵɵelementStart(0, \"nb-checkbox\", 30);\n    ɵngcc0.ɵɵlistener(\"ngModelChange\", function NbLoginComponent_nb_checkbox_24_Template_nb_checkbox_ngModelChange_0_listener($event) {\n      ɵngcc0.ɵɵrestoreView(_r18);\n      const ctx_r17 = ɵngcc0.ɵɵnextContext();\n      return ctx_r17.user.rememberMe = $event;\n    });\n    ɵngcc0.ɵɵtext(1, \"Remember me\");\n    ɵngcc0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r7 = ɵngcc0.ɵɵnextContext();\n    ɵngcc0.ɵɵproperty(\"ngModel\", ctx_r7.user.rememberMe);\n  }\n}\n\nfunction NbLoginComponent_section_27_ng_container_3_a_1_nb_icon_1_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵelement(0, \"nb-icon\", 39);\n  }\n\n  if (rf & 2) {\n    const socialLink_r20 = ɵngcc0.ɵɵnextContext(2).$implicit;\n    ɵngcc0.ɵɵproperty(\"icon\", socialLink_r20.icon);\n  }\n}\n\nfunction NbLoginComponent_section_27_ng_container_3_a_1_ng_template_2_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵtext(0);\n  }\n\n  if (rf & 2) {\n    const socialLink_r20 = ɵngcc0.ɵɵnextContext(2).$implicit;\n    ɵngcc0.ɵɵtextInterpolate(socialLink_r20.title);\n  }\n}\n\nfunction NbLoginComponent_section_27_ng_container_3_a_1_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵelementStart(0, \"a\", 36);\n    ɵngcc0.ɵɵtemplate(1, NbLoginComponent_section_27_ng_container_3_a_1_nb_icon_1_Template, 1, 1, \"nb-icon\", 37);\n    ɵngcc0.ɵɵtemplate(2, NbLoginComponent_section_27_ng_container_3_a_1_ng_template_2_Template, 1, 1, \"ng-template\", null, 38, ɵngcc0.ɵɵtemplateRefExtractor);\n    ɵngcc0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const _r24 = ɵngcc0.ɵɵreference(3);\n\n    const socialLink_r20 = ɵngcc0.ɵɵnextContext().$implicit;\n    ɵngcc0.ɵɵclassProp(\"with-icon\", socialLink_r20.icon);\n    ɵngcc0.ɵɵproperty(\"routerLink\", socialLink_r20.link);\n    ɵngcc0.ɵɵattribute(\"target\", socialLink_r20.target)(\"class\", socialLink_r20.icon);\n    ɵngcc0.ɵɵadvance(1);\n    ɵngcc0.ɵɵproperty(\"ngIf\", socialLink_r20.icon)(\"ngIfElse\", _r24);\n  }\n}\n\nfunction NbLoginComponent_section_27_ng_container_3_a_2_nb_icon_1_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵelement(0, \"nb-icon\", 39);\n  }\n\n  if (rf & 2) {\n    const socialLink_r20 = ɵngcc0.ɵɵnextContext(2).$implicit;\n    ɵngcc0.ɵɵproperty(\"icon\", socialLink_r20.icon);\n  }\n}\n\nfunction NbLoginComponent_section_27_ng_container_3_a_2_ng_template_2_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵtext(0);\n  }\n\n  if (rf & 2) {\n    const socialLink_r20 = ɵngcc0.ɵɵnextContext(2).$implicit;\n    ɵngcc0.ɵɵtextInterpolate(socialLink_r20.title);\n  }\n}\n\nfunction NbLoginComponent_section_27_ng_container_3_a_2_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵelementStart(0, \"a\");\n    ɵngcc0.ɵɵtemplate(1, NbLoginComponent_section_27_ng_container_3_a_2_nb_icon_1_Template, 1, 1, \"nb-icon\", 37);\n    ɵngcc0.ɵɵtemplate(2, NbLoginComponent_section_27_ng_container_3_a_2_ng_template_2_Template, 1, 1, \"ng-template\", null, 38, ɵngcc0.ɵɵtemplateRefExtractor);\n    ɵngcc0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const _r30 = ɵngcc0.ɵɵreference(3);\n\n    const socialLink_r20 = ɵngcc0.ɵɵnextContext().$implicit;\n    ɵngcc0.ɵɵclassProp(\"with-icon\", socialLink_r20.icon);\n    ɵngcc0.ɵɵattribute(\"href\", socialLink_r20.url, ɵngcc0.ɵɵsanitizeUrl)(\"target\", socialLink_r20.target)(\"class\", socialLink_r20.icon);\n    ɵngcc0.ɵɵadvance(1);\n    ɵngcc0.ɵɵproperty(\"ngIf\", socialLink_r20.icon)(\"ngIfElse\", _r30);\n  }\n}\n\nfunction NbLoginComponent_section_27_ng_container_3_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵelementContainerStart(0);\n    ɵngcc0.ɵɵtemplate(1, NbLoginComponent_section_27_ng_container_3_a_1_Template, 4, 7, \"a\", 34);\n    ɵngcc0.ɵɵtemplate(2, NbLoginComponent_section_27_ng_container_3_a_2_Template, 4, 7, \"a\", 35);\n    ɵngcc0.ɵɵelementContainerEnd();\n  }\n\n  if (rf & 2) {\n    const socialLink_r20 = ctx.$implicit;\n    ɵngcc0.ɵɵadvance(1);\n    ɵngcc0.ɵɵproperty(\"ngIf\", socialLink_r20.link);\n    ɵngcc0.ɵɵadvance(1);\n    ɵngcc0.ɵɵproperty(\"ngIf\", socialLink_r20.url);\n  }\n}\n\nfunction NbLoginComponent_section_27_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵelementStart(0, \"section\", 31);\n    ɵngcc0.ɵɵtext(1, \" or enter with: \");\n    ɵngcc0.ɵɵelementStart(2, \"div\", 32);\n    ɵngcc0.ɵɵtemplate(3, NbLoginComponent_section_27_ng_container_3_Template, 3, 2, \"ng-container\", 33);\n    ɵngcc0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const ctx_r8 = ɵngcc0.ɵɵnextContext();\n    ɵngcc0.ɵɵadvance(3);\n    ɵngcc0.ɵɵproperty(\"ngForOf\", ctx_r8.socialLinks);\n  }\n}\n\nfunction NbRegisterComponent_nb_alert_2_li_5_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵelementStart(0, \"li\", 28);\n    ɵngcc0.ɵɵtext(1);\n    ɵngcc0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const error_r14 = ctx.$implicit;\n    ɵngcc0.ɵɵadvance(1);\n    ɵngcc0.ɵɵtextInterpolate(error_r14);\n  }\n}\n\nfunction NbRegisterComponent_nb_alert_2_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵelementStart(0, \"nb-alert\", 24)(1, \"p\", 25)(2, \"b\");\n    ɵngcc0.ɵɵtext(3, \"Oh snap!\");\n    ɵngcc0.ɵɵelementEnd()();\n    ɵngcc0.ɵɵelementStart(4, \"ul\", 26);\n    ɵngcc0.ɵɵtemplate(5, NbRegisterComponent_nb_alert_2_li_5_Template, 2, 1, \"li\", 27);\n    ɵngcc0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = ɵngcc0.ɵɵnextContext();\n    ɵngcc0.ɵɵadvance(5);\n    ɵngcc0.ɵɵproperty(\"ngForOf\", ctx_r0.errors);\n  }\n}\n\nfunction NbRegisterComponent_nb_alert_3_li_5_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵelementStart(0, \"li\", 28);\n    ɵngcc0.ɵɵtext(1);\n    ɵngcc0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const message_r16 = ctx.$implicit;\n    ɵngcc0.ɵɵadvance(1);\n    ɵngcc0.ɵɵtextInterpolate(message_r16);\n  }\n}\n\nfunction NbRegisterComponent_nb_alert_3_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵelementStart(0, \"nb-alert\", 29)(1, \"p\", 25)(2, \"b\");\n    ɵngcc0.ɵɵtext(3, \"Hooray!\");\n    ɵngcc0.ɵɵelementEnd()();\n    ɵngcc0.ɵɵelementStart(4, \"ul\", 26);\n    ɵngcc0.ɵɵtemplate(5, NbRegisterComponent_nb_alert_3_li_5_Template, 2, 1, \"li\", 27);\n    ɵngcc0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const ctx_r1 = ɵngcc0.ɵɵnextContext();\n    ɵngcc0.ɵɵadvance(5);\n    ɵngcc0.ɵɵproperty(\"ngForOf\", ctx_r1.messages);\n  }\n}\n\nfunction NbRegisterComponent_ng_container_11_p_1_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵelementStart(0, \"p\", 31);\n    ɵngcc0.ɵɵtext(1, \" Full name is required! \");\n    ɵngcc0.ɵɵelementEnd();\n  }\n}\n\nfunction NbRegisterComponent_ng_container_11_p_2_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵelementStart(0, \"p\", 31);\n    ɵngcc0.ɵɵtext(1);\n    ɵngcc0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r18 = ɵngcc0.ɵɵnextContext(2);\n    ɵngcc0.ɵɵadvance(1);\n    ɵngcc0.ɵɵtextInterpolate2(\" Full name should contains from \", ctx_r18.getConfigValue(\"forms.validation.fullName.minLength\"), \" to \", ctx_r18.getConfigValue(\"forms.validation.fullName.maxLength\"), \" characters \");\n  }\n}\n\nfunction NbRegisterComponent_ng_container_11_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵelementContainerStart(0);\n    ɵngcc0.ɵɵtemplate(1, NbRegisterComponent_ng_container_11_p_1_Template, 2, 0, \"p\", 30);\n    ɵngcc0.ɵɵtemplate(2, NbRegisterComponent_ng_container_11_p_2_Template, 2, 2, \"p\", 30);\n    ɵngcc0.ɵɵelementContainerEnd();\n  }\n\n  if (rf & 2) {\n    ɵngcc0.ɵɵnextContext();\n\n    const _r3 = ɵngcc0.ɵɵreference(10);\n\n    ɵngcc0.ɵɵadvance(1);\n    ɵngcc0.ɵɵproperty(\"ngIf\", _r3.errors == null ? null : _r3.errors.required);\n    ɵngcc0.ɵɵadvance(1);\n    ɵngcc0.ɵɵproperty(\"ngIf\", (_r3.errors == null ? null : _r3.errors.minlength) || (_r3.errors == null ? null : _r3.errors.maxlength));\n  }\n}\n\nfunction NbRegisterComponent_ng_container_17_p_1_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵelementStart(0, \"p\", 31);\n    ɵngcc0.ɵɵtext(1, \" Email is required! \");\n    ɵngcc0.ɵɵelementEnd();\n  }\n}\n\nfunction NbRegisterComponent_ng_container_17_p_2_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵelementStart(0, \"p\", 31);\n    ɵngcc0.ɵɵtext(1, \" Email should be the real one! \");\n    ɵngcc0.ɵɵelementEnd();\n  }\n}\n\nfunction NbRegisterComponent_ng_container_17_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵelementContainerStart(0);\n    ɵngcc0.ɵɵtemplate(1, NbRegisterComponent_ng_container_17_p_1_Template, 2, 0, \"p\", 30);\n    ɵngcc0.ɵɵtemplate(2, NbRegisterComponent_ng_container_17_p_2_Template, 2, 0, \"p\", 30);\n    ɵngcc0.ɵɵelementContainerEnd();\n  }\n\n  if (rf & 2) {\n    ɵngcc0.ɵɵnextContext();\n\n    const _r5 = ɵngcc0.ɵɵreference(16);\n\n    ɵngcc0.ɵɵadvance(1);\n    ɵngcc0.ɵɵproperty(\"ngIf\", _r5.errors == null ? null : _r5.errors.required);\n    ɵngcc0.ɵɵadvance(1);\n    ɵngcc0.ɵɵproperty(\"ngIf\", _r5.errors == null ? null : _r5.errors.pattern);\n  }\n}\n\nfunction NbRegisterComponent_ng_container_23_p_1_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵelementStart(0, \"p\", 31);\n    ɵngcc0.ɵɵtext(1, \" Password is required! \");\n    ɵngcc0.ɵɵelementEnd();\n  }\n}\n\nfunction NbRegisterComponent_ng_container_23_p_2_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵelementStart(0, \"p\", 31);\n    ɵngcc0.ɵɵtext(1);\n    ɵngcc0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r22 = ɵngcc0.ɵɵnextContext(2);\n    ɵngcc0.ɵɵadvance(1);\n    ɵngcc0.ɵɵtextInterpolate2(\" Password should contain from \", ctx_r22.getConfigValue(\"forms.validation.password.minLength\"), \" to \", ctx_r22.getConfigValue(\"forms.validation.password.maxLength\"), \" characters \");\n  }\n}\n\nfunction NbRegisterComponent_ng_container_23_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵelementContainerStart(0);\n    ɵngcc0.ɵɵtemplate(1, NbRegisterComponent_ng_container_23_p_1_Template, 2, 0, \"p\", 30);\n    ɵngcc0.ɵɵtemplate(2, NbRegisterComponent_ng_container_23_p_2_Template, 2, 2, \"p\", 30);\n    ɵngcc0.ɵɵelementContainerEnd();\n  }\n\n  if (rf & 2) {\n    ɵngcc0.ɵɵnextContext();\n\n    const _r7 = ɵngcc0.ɵɵreference(22);\n\n    ɵngcc0.ɵɵadvance(1);\n    ɵngcc0.ɵɵproperty(\"ngIf\", _r7.errors == null ? null : _r7.errors.required);\n    ɵngcc0.ɵɵadvance(1);\n    ɵngcc0.ɵɵproperty(\"ngIf\", (_r7.errors == null ? null : _r7.errors.minlength) || (_r7.errors == null ? null : _r7.errors.maxlength));\n  }\n}\n\nfunction NbRegisterComponent_ng_container_29_p_1_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵelementStart(0, \"p\", 31);\n    ɵngcc0.ɵɵtext(1, \" Password confirmation is required! \");\n    ɵngcc0.ɵɵelementEnd();\n  }\n}\n\nfunction NbRegisterComponent_ng_container_29_p_2_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵelementStart(0, \"p\", 31);\n    ɵngcc0.ɵɵtext(1, \" Password does not match the confirm password. \");\n    ɵngcc0.ɵɵelementEnd();\n  }\n}\n\nfunction NbRegisterComponent_ng_container_29_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵelementContainerStart(0);\n    ɵngcc0.ɵɵtemplate(1, NbRegisterComponent_ng_container_29_p_1_Template, 2, 0, \"p\", 30);\n    ɵngcc0.ɵɵtemplate(2, NbRegisterComponent_ng_container_29_p_2_Template, 2, 0, \"p\", 30);\n    ɵngcc0.ɵɵelementContainerEnd();\n  }\n\n  if (rf & 2) {\n    ɵngcc0.ɵɵnextContext();\n\n    const _r9 = ɵngcc0.ɵɵreference(28);\n\n    const _r7 = ɵngcc0.ɵɵreference(22);\n\n    ɵngcc0.ɵɵadvance(1);\n    ɵngcc0.ɵɵproperty(\"ngIf\", _r9.errors == null ? null : _r9.errors.required);\n    ɵngcc0.ɵɵadvance(1);\n    ɵngcc0.ɵɵproperty(\"ngIf\", _r7.value != _r9.value && !(_r9.errors == null ? null : _r9.errors.required));\n  }\n}\n\nfunction NbRegisterComponent_div_30_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r26 = ɵngcc0.ɵɵgetCurrentView();\n\n    ɵngcc0.ɵɵelementStart(0, \"div\", 32)(1, \"nb-checkbox\", 33);\n    ɵngcc0.ɵɵlistener(\"ngModelChange\", function NbRegisterComponent_div_30_Template_nb_checkbox_ngModelChange_1_listener($event) {\n      ɵngcc0.ɵɵrestoreView(_r26);\n      const ctx_r25 = ɵngcc0.ɵɵnextContext();\n      return ctx_r25.user.terms = $event;\n    });\n    ɵngcc0.ɵɵtext(2, \" Agree to \");\n    ɵngcc0.ɵɵelementStart(3, \"a\", 34)(4, \"strong\");\n    ɵngcc0.ɵɵtext(5, \"Terms & Conditions\");\n    ɵngcc0.ɵɵelementEnd()()()();\n  }\n\n  if (rf & 2) {\n    const ctx_r11 = ɵngcc0.ɵɵnextContext();\n    ɵngcc0.ɵɵadvance(1);\n    ɵngcc0.ɵɵproperty(\"ngModel\", ctx_r11.user.terms)(\"required\", ctx_r11.getConfigValue(\"forms.register.terms\"));\n  }\n}\n\nfunction NbRegisterComponent_section_33_ng_container_3_a_1_nb_icon_1_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵelement(0, \"nb-icon\", 43);\n  }\n\n  if (rf & 2) {\n    const socialLink_r28 = ɵngcc0.ɵɵnextContext(2).$implicit;\n    ɵngcc0.ɵɵproperty(\"icon\", socialLink_r28.icon);\n  }\n}\n\nfunction NbRegisterComponent_section_33_ng_container_3_a_1_ng_template_2_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵtext(0);\n  }\n\n  if (rf & 2) {\n    const socialLink_r28 = ɵngcc0.ɵɵnextContext(2).$implicit;\n    ɵngcc0.ɵɵtextInterpolate(socialLink_r28.title);\n  }\n}\n\nfunction NbRegisterComponent_section_33_ng_container_3_a_1_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵelementStart(0, \"a\", 40);\n    ɵngcc0.ɵɵtemplate(1, NbRegisterComponent_section_33_ng_container_3_a_1_nb_icon_1_Template, 1, 1, \"nb-icon\", 41);\n    ɵngcc0.ɵɵtemplate(2, NbRegisterComponent_section_33_ng_container_3_a_1_ng_template_2_Template, 1, 1, \"ng-template\", null, 42, ɵngcc0.ɵɵtemplateRefExtractor);\n    ɵngcc0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const _r32 = ɵngcc0.ɵɵreference(3);\n\n    const socialLink_r28 = ɵngcc0.ɵɵnextContext().$implicit;\n    ɵngcc0.ɵɵclassProp(\"with-icon\", socialLink_r28.icon);\n    ɵngcc0.ɵɵproperty(\"routerLink\", socialLink_r28.link);\n    ɵngcc0.ɵɵattribute(\"target\", socialLink_r28.target)(\"class\", socialLink_r28.icon);\n    ɵngcc0.ɵɵadvance(1);\n    ɵngcc0.ɵɵproperty(\"ngIf\", socialLink_r28.icon)(\"ngIfElse\", _r32);\n  }\n}\n\nfunction NbRegisterComponent_section_33_ng_container_3_a_2_nb_icon_1_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵelement(0, \"nb-icon\", 43);\n  }\n\n  if (rf & 2) {\n    const socialLink_r28 = ɵngcc0.ɵɵnextContext(2).$implicit;\n    ɵngcc0.ɵɵproperty(\"icon\", socialLink_r28.icon);\n  }\n}\n\nfunction NbRegisterComponent_section_33_ng_container_3_a_2_ng_template_2_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵtext(0);\n  }\n\n  if (rf & 2) {\n    const socialLink_r28 = ɵngcc0.ɵɵnextContext(2).$implicit;\n    ɵngcc0.ɵɵtextInterpolate(socialLink_r28.title);\n  }\n}\n\nfunction NbRegisterComponent_section_33_ng_container_3_a_2_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵelementStart(0, \"a\");\n    ɵngcc0.ɵɵtemplate(1, NbRegisterComponent_section_33_ng_container_3_a_2_nb_icon_1_Template, 1, 1, \"nb-icon\", 41);\n    ɵngcc0.ɵɵtemplate(2, NbRegisterComponent_section_33_ng_container_3_a_2_ng_template_2_Template, 1, 1, \"ng-template\", null, 42, ɵngcc0.ɵɵtemplateRefExtractor);\n    ɵngcc0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const _r38 = ɵngcc0.ɵɵreference(3);\n\n    const socialLink_r28 = ɵngcc0.ɵɵnextContext().$implicit;\n    ɵngcc0.ɵɵclassProp(\"with-icon\", socialLink_r28.icon);\n    ɵngcc0.ɵɵattribute(\"href\", socialLink_r28.url, ɵngcc0.ɵɵsanitizeUrl)(\"target\", socialLink_r28.target)(\"class\", socialLink_r28.icon);\n    ɵngcc0.ɵɵadvance(1);\n    ɵngcc0.ɵɵproperty(\"ngIf\", socialLink_r28.icon)(\"ngIfElse\", _r38);\n  }\n}\n\nfunction NbRegisterComponent_section_33_ng_container_3_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵelementContainerStart(0);\n    ɵngcc0.ɵɵtemplate(1, NbRegisterComponent_section_33_ng_container_3_a_1_Template, 4, 7, \"a\", 38);\n    ɵngcc0.ɵɵtemplate(2, NbRegisterComponent_section_33_ng_container_3_a_2_Template, 4, 7, \"a\", 39);\n    ɵngcc0.ɵɵelementContainerEnd();\n  }\n\n  if (rf & 2) {\n    const socialLink_r28 = ctx.$implicit;\n    ɵngcc0.ɵɵadvance(1);\n    ɵngcc0.ɵɵproperty(\"ngIf\", socialLink_r28.link);\n    ɵngcc0.ɵɵadvance(1);\n    ɵngcc0.ɵɵproperty(\"ngIf\", socialLink_r28.url);\n  }\n}\n\nfunction NbRegisterComponent_section_33_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵelementStart(0, \"section\", 35);\n    ɵngcc0.ɵɵtext(1, \" or enter with: \");\n    ɵngcc0.ɵɵelementStart(2, \"div\", 36);\n    ɵngcc0.ɵɵtemplate(3, NbRegisterComponent_section_33_ng_container_3_Template, 3, 2, \"ng-container\", 37);\n    ɵngcc0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const ctx_r12 = ɵngcc0.ɵɵnextContext();\n    ɵngcc0.ɵɵadvance(3);\n    ɵngcc0.ɵɵproperty(\"ngForOf\", ctx_r12.socialLinks);\n  }\n}\n\nfunction NbRequestPasswordComponent_nb_alert_4_li_5_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵelementStart(0, \"li\", 19);\n    ɵngcc0.ɵɵtext(1);\n    ɵngcc0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const error_r6 = ctx.$implicit;\n    ɵngcc0.ɵɵadvance(1);\n    ɵngcc0.ɵɵtextInterpolate(error_r6);\n  }\n}\n\nfunction NbRequestPasswordComponent_nb_alert_4_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵelementStart(0, \"nb-alert\", 15)(1, \"p\", 16)(2, \"b\");\n    ɵngcc0.ɵɵtext(3, \"Oh snap!\");\n    ɵngcc0.ɵɵelementEnd()();\n    ɵngcc0.ɵɵelementStart(4, \"ul\", 17);\n    ɵngcc0.ɵɵtemplate(5, NbRequestPasswordComponent_nb_alert_4_li_5_Template, 2, 1, \"li\", 18);\n    ɵngcc0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = ɵngcc0.ɵɵnextContext();\n    ɵngcc0.ɵɵadvance(5);\n    ɵngcc0.ɵɵproperty(\"ngForOf\", ctx_r0.errors);\n  }\n}\n\nfunction NbRequestPasswordComponent_nb_alert_5_li_5_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵelementStart(0, \"li\", 19);\n    ɵngcc0.ɵɵtext(1);\n    ɵngcc0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const message_r8 = ctx.$implicit;\n    ɵngcc0.ɵɵadvance(1);\n    ɵngcc0.ɵɵtextInterpolate(message_r8);\n  }\n}\n\nfunction NbRequestPasswordComponent_nb_alert_5_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵelementStart(0, \"nb-alert\", 20)(1, \"p\", 16)(2, \"b\");\n    ɵngcc0.ɵɵtext(3, \"Hooray!\");\n    ɵngcc0.ɵɵelementEnd()();\n    ɵngcc0.ɵɵelementStart(4, \"ul\", 17);\n    ɵngcc0.ɵɵtemplate(5, NbRequestPasswordComponent_nb_alert_5_li_5_Template, 2, 1, \"li\", 18);\n    ɵngcc0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const ctx_r1 = ɵngcc0.ɵɵnextContext();\n    ɵngcc0.ɵɵadvance(5);\n    ɵngcc0.ɵɵproperty(\"ngForOf\", ctx_r1.messages);\n  }\n}\n\nfunction NbRequestPasswordComponent_ng_container_13_p_1_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵelementStart(0, \"p\", 22);\n    ɵngcc0.ɵɵtext(1, \" Email is required! \");\n    ɵngcc0.ɵɵelementEnd();\n  }\n}\n\nfunction NbRequestPasswordComponent_ng_container_13_p_2_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵelementStart(0, \"p\", 22);\n    ɵngcc0.ɵɵtext(1, \" Email should be the real one! \");\n    ɵngcc0.ɵɵelementEnd();\n  }\n}\n\nfunction NbRequestPasswordComponent_ng_container_13_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵelementContainerStart(0);\n    ɵngcc0.ɵɵtemplate(1, NbRequestPasswordComponent_ng_container_13_p_1_Template, 2, 0, \"p\", 21);\n    ɵngcc0.ɵɵtemplate(2, NbRequestPasswordComponent_ng_container_13_p_2_Template, 2, 0, \"p\", 21);\n    ɵngcc0.ɵɵelementContainerEnd();\n  }\n\n  if (rf & 2) {\n    ɵngcc0.ɵɵnextContext();\n\n    const _r3 = ɵngcc0.ɵɵreference(12);\n\n    ɵngcc0.ɵɵadvance(1);\n    ɵngcc0.ɵɵproperty(\"ngIf\", _r3.errors == null ? null : _r3.errors.required);\n    ɵngcc0.ɵɵadvance(1);\n    ɵngcc0.ɵɵproperty(\"ngIf\", _r3.errors == null ? null : _r3.errors.pattern);\n  }\n}\n\nfunction NbResetPasswordComponent_nb_alert_4_li_5_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵelementStart(0, \"li\", 23);\n    ɵngcc0.ɵɵtext(1);\n    ɵngcc0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const error_r8 = ctx.$implicit;\n    ɵngcc0.ɵɵadvance(1);\n    ɵngcc0.ɵɵtextInterpolate(error_r8);\n  }\n}\n\nfunction NbResetPasswordComponent_nb_alert_4_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵelementStart(0, \"nb-alert\", 19)(1, \"p\", 20)(2, \"b\");\n    ɵngcc0.ɵɵtext(3, \"Oh snap!\");\n    ɵngcc0.ɵɵelementEnd()();\n    ɵngcc0.ɵɵelementStart(4, \"ul\", 21);\n    ɵngcc0.ɵɵtemplate(5, NbResetPasswordComponent_nb_alert_4_li_5_Template, 2, 1, \"li\", 22);\n    ɵngcc0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = ɵngcc0.ɵɵnextContext();\n    ɵngcc0.ɵɵadvance(5);\n    ɵngcc0.ɵɵproperty(\"ngForOf\", ctx_r0.errors);\n  }\n}\n\nfunction NbResetPasswordComponent_nb_alert_5_li_5_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵelementStart(0, \"li\", 23);\n    ɵngcc0.ɵɵtext(1);\n    ɵngcc0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const message_r10 = ctx.$implicit;\n    ɵngcc0.ɵɵadvance(1);\n    ɵngcc0.ɵɵtextInterpolate(message_r10);\n  }\n}\n\nfunction NbResetPasswordComponent_nb_alert_5_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵelementStart(0, \"nb-alert\", 24)(1, \"p\", 20)(2, \"b\");\n    ɵngcc0.ɵɵtext(3, \"Hooray!\");\n    ɵngcc0.ɵɵelementEnd()();\n    ɵngcc0.ɵɵelementStart(4, \"ul\", 21);\n    ɵngcc0.ɵɵtemplate(5, NbResetPasswordComponent_nb_alert_5_li_5_Template, 2, 1, \"li\", 22);\n    ɵngcc0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const ctx_r1 = ɵngcc0.ɵɵnextContext();\n    ɵngcc0.ɵɵadvance(5);\n    ɵngcc0.ɵɵproperty(\"ngForOf\", ctx_r1.messages);\n  }\n}\n\nfunction NbResetPasswordComponent_ng_container_13_p_1_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵelementStart(0, \"p\", 26);\n    ɵngcc0.ɵɵtext(1, \" Password is required! \");\n    ɵngcc0.ɵɵelementEnd();\n  }\n}\n\nfunction NbResetPasswordComponent_ng_container_13_p_2_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵelementStart(0, \"p\", 26);\n    ɵngcc0.ɵɵtext(1);\n    ɵngcc0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r12 = ɵngcc0.ɵɵnextContext(2);\n    ɵngcc0.ɵɵadvance(1);\n    ɵngcc0.ɵɵtextInterpolate2(\" Password should contains from \", ctx_r12.getConfigValue(\"forms.validation.password.minLength\"), \" to \", ctx_r12.getConfigValue(\"forms.validation.password.maxLength\"), \" characters \");\n  }\n}\n\nfunction NbResetPasswordComponent_ng_container_13_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵelementContainerStart(0);\n    ɵngcc0.ɵɵtemplate(1, NbResetPasswordComponent_ng_container_13_p_1_Template, 2, 0, \"p\", 25);\n    ɵngcc0.ɵɵtemplate(2, NbResetPasswordComponent_ng_container_13_p_2_Template, 2, 2, \"p\", 25);\n    ɵngcc0.ɵɵelementContainerEnd();\n  }\n\n  if (rf & 2) {\n    ɵngcc0.ɵɵnextContext();\n\n    const _r3 = ɵngcc0.ɵɵreference(12);\n\n    ɵngcc0.ɵɵadvance(1);\n    ɵngcc0.ɵɵproperty(\"ngIf\", _r3.errors == null ? null : _r3.errors.required);\n    ɵngcc0.ɵɵadvance(1);\n    ɵngcc0.ɵɵproperty(\"ngIf\", (_r3.errors == null ? null : _r3.errors.minlength) || (_r3.errors == null ? null : _r3.errors.maxlength));\n  }\n}\n\nfunction NbResetPasswordComponent_ng_container_19_p_1_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵelementStart(0, \"p\", 26);\n    ɵngcc0.ɵɵtext(1, \" Password confirmation is required! \");\n    ɵngcc0.ɵɵelementEnd();\n  }\n}\n\nfunction NbResetPasswordComponent_ng_container_19_p_2_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵelementStart(0, \"p\", 26);\n    ɵngcc0.ɵɵtext(1, \" Password does not match the confirm password. \");\n    ɵngcc0.ɵɵelementEnd();\n  }\n}\n\nfunction NbResetPasswordComponent_ng_container_19_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵelementContainerStart(0);\n    ɵngcc0.ɵɵtemplate(1, NbResetPasswordComponent_ng_container_19_p_1_Template, 2, 0, \"p\", 25);\n    ɵngcc0.ɵɵtemplate(2, NbResetPasswordComponent_ng_container_19_p_2_Template, 2, 0, \"p\", 25);\n    ɵngcc0.ɵɵelementContainerEnd();\n  }\n\n  if (rf & 2) {\n    ɵngcc0.ɵɵnextContext();\n\n    const _r5 = ɵngcc0.ɵɵreference(18);\n\n    const _r3 = ɵngcc0.ɵɵreference(12);\n\n    ɵngcc0.ɵɵadvance(1);\n    ɵngcc0.ɵɵproperty(\"ngIf\", _r5.invalid && (_r5.errors == null ? null : _r5.errors.required));\n    ɵngcc0.ɵɵadvance(1);\n    ɵngcc0.ɵɵproperty(\"ngIf\", _r3.value != _r5.value && !(_r5.errors == null ? null : _r5.errors.required));\n  }\n}\n\nconst _c1 = \"[_nghost-%COMP%]   .form-group[_ngcontent-%COMP%]:last-of-type{margin-bottom:3rem}\";\nconst socialLinks = [];\nconst defaultAuthOptions = {\n  strategies: [],\n  forms: {\n    login: {\n      redirectDelay: 500,\n      strategy: 'email',\n      rememberMe: true,\n      showMessages: {\n        success: true,\n        error: true\n      },\n      socialLinks: socialLinks\n    },\n    register: {\n      redirectDelay: 500,\n      strategy: 'email',\n      showMessages: {\n        success: true,\n        error: true\n      },\n      terms: true,\n      socialLinks: socialLinks\n    },\n    requestPassword: {\n      redirectDelay: 500,\n      strategy: 'email',\n      showMessages: {\n        success: true,\n        error: true\n      },\n      socialLinks: socialLinks\n    },\n    resetPassword: {\n      redirectDelay: 500,\n      strategy: 'email',\n      showMessages: {\n        success: true,\n        error: true\n      },\n      socialLinks: socialLinks\n    },\n    logout: {\n      redirectDelay: 500,\n      strategy: 'email'\n    },\n    validation: {\n      password: {\n        required: true,\n        minLength: 4,\n        maxLength: 50\n      },\n      email: {\n        required: true\n      },\n      fullName: {\n        required: false,\n        minLength: 4,\n        maxLength: 50\n      }\n    }\n  }\n};\nconst NB_AUTH_OPTIONS = new InjectionToken('Nebular Auth Options');\nconst NB_AUTH_USER_OPTIONS = new InjectionToken('Nebular User Auth Options');\nconst NB_AUTH_STRATEGIES = new InjectionToken('Nebular Auth Strategies');\nconst NB_AUTH_TOKENS = new InjectionToken('Nebular Auth Tokens');\nconst NB_AUTH_INTERCEPTOR_HEADER = new InjectionToken('Nebular Simple Interceptor Header');\nconst NB_AUTH_TOKEN_INTERCEPTOR_FILTER = new InjectionToken('Nebular Interceptor Filter');\n/**\n * Extending object that entered in first argument.\n *\n * Returns extended object or false if have no target object or incorrect type.\n *\n * If you wish to clone source object (without modify it), just use empty new\n * object as first argument, like this:\n *   deepExtend({}, yourObj_1, [yourObj_N]);\n */\n\nconst deepExtend = function (...objects) {\n  if (arguments.length < 1 || typeof arguments[0] !== 'object') {\n    return false;\n  }\n\n  if (arguments.length < 2) {\n    return arguments[0];\n  }\n\n  const target = arguments[0]; // convert arguments to array and cut off target object\n\n  const args = Array.prototype.slice.call(arguments, 1);\n  let val, src;\n  args.forEach(function (obj) {\n    // skip argument if it is array or isn't object\n    if (typeof obj !== 'object' || Array.isArray(obj)) {\n      return;\n    }\n\n    Object.keys(obj).forEach(function (key) {\n      src = target[key]; // source value\n\n      val = obj[key]; // new value\n      // recursion prevention\n\n      if (val === target) {\n        return;\n        /**\n         * if new value isn't object then just overwrite by new value\n         * instead of extending.\n         */\n      } else if (typeof val !== 'object' || val === null) {\n        target[key] = val;\n        return; // just clone arrays (and recursive clone objects inside)\n      } else if (Array.isArray(val)) {\n        target[key] = deepCloneArray(val);\n        return; // custom cloning and overwrite for specific objects\n      } else if (isSpecificValue(val)) {\n        target[key] = cloneSpecificValue(val);\n        return; // overwrite by new value if source isn't object or array\n      } else if (typeof src !== 'object' || src === null || Array.isArray(src)) {\n        target[key] = deepExtend({}, val);\n        return; // source value and new value is objects both, extending...\n      } else {\n        target[key] = deepExtend(src, val);\n        return;\n      }\n    });\n  });\n  return target;\n};\n\nfunction isSpecificValue(val) {\n  return val instanceof Date || val instanceof RegExp ? true : false;\n}\n\nfunction cloneSpecificValue(val) {\n  if (val instanceof Date) {\n    return new Date(val.getTime());\n  } else if (val instanceof RegExp) {\n    return new RegExp(val);\n  } else {\n    throw new Error('cloneSpecificValue: Unexpected situation');\n  }\n}\n/**\n * Recursive cloning array.\n */\n\n\nfunction deepCloneArray(arr) {\n  const clone = [];\n  arr.forEach(function (item, index) {\n    if (typeof item === 'object' && item !== null) {\n      if (Array.isArray(item)) {\n        clone[index] = deepCloneArray(item);\n      } else if (isSpecificValue(item)) {\n        clone[index] = cloneSpecificValue(item);\n      } else {\n        clone[index] = deepExtend({}, item);\n      }\n    } else {\n      clone[index] = item;\n    }\n  });\n  return clone;\n} // getDeepFromObject({result: {data: 1}}, 'result.data', 2); // returns 1\n\n\nfunction getDeepFromObject(object = {}, name, defaultValue) {\n  const keys = name.split('.'); // clone the object\n\n  let level = deepExtend({}, object || {});\n  keys.forEach(k => {\n    if (level && typeof level[k] !== 'undefined') {\n      level = level[k];\n    } else {\n      level = undefined;\n    }\n  });\n  return typeof level === 'undefined' ? defaultValue : level;\n}\n\nfunction urlBase64Decode(str) {\n  let output = str.replace(/-/g, '+').replace(/_/g, '/');\n\n  switch (output.length % 4) {\n    case 0:\n      {\n        break;\n      }\n\n    case 2:\n      {\n        output += '==';\n        break;\n      }\n\n    case 3:\n      {\n        output += '=';\n        break;\n      }\n\n    default:\n      {\n        throw new Error('Illegal base64url string!');\n      }\n  }\n\n  return b64DecodeUnicode(output);\n}\n\nfunction b64decode(str) {\n  const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';\n  let output = '';\n  str = String(str).replace(/=+$/, '');\n\n  if (str.length % 4 === 1) {\n    throw new Error(`'atob' failed: The string to be decoded is not correctly encoded.`);\n  }\n\n  for ( // initialize result and counters\n  let bc = 0, bs, buffer, idx = 0; // get next character\n  buffer = str.charAt(idx++); // character found in table? initialize bit storage and add its ascii value;\n  ~buffer && (bs = bc % 4 ? bs * 64 + buffer : buffer, // and if not first of each 4 characters,\n  // convert the first 8 bits to one ascii character\n  bc++ % 4) ? output += String.fromCharCode(255 & bs >> (-2 * bc & 6)) : 0) {\n    // try to find character in table (0-63, not found => -1)\n    buffer = chars.indexOf(buffer);\n  }\n\n  return output;\n} // https://developer.mozilla.org/en/docs/Web/API/WindowBase64/Base64_encoding_and_decoding#The_Unicode_Problem\n\n\nfunction b64DecodeUnicode(str) {\n  return decodeURIComponent(Array.prototype.map.call(b64decode(str), c => {\n    return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);\n  }).join(''));\n}\n\nclass NbAuthToken {\n  constructor() {\n    this.payload = null;\n  }\n\n  getName() {\n    return this.constructor.NAME;\n  }\n\n  getPayload() {\n    return this.payload;\n  }\n\n}\n\nclass NbAuthTokenNotFoundError extends Error {\n  constructor(message) {\n    super(message);\n    Object.setPrototypeOf(this, new.target.prototype);\n  }\n\n}\n\nclass NbAuthIllegalTokenError extends Error {\n  constructor(message) {\n    super(message);\n    Object.setPrototypeOf(this, new.target.prototype);\n  }\n\n}\n\nclass NbAuthEmptyTokenError extends NbAuthIllegalTokenError {\n  constructor(message) {\n    super(message);\n    Object.setPrototypeOf(this, new.target.prototype);\n  }\n\n}\n\nclass NbAuthIllegalJWTTokenError extends NbAuthIllegalTokenError {\n  constructor(message) {\n    super(message);\n    Object.setPrototypeOf(this, new.target.prototype);\n  }\n\n}\n\nfunction nbAuthCreateToken(tokenClass, token, ownerStrategyName, createdAt) {\n  return new tokenClass(token, ownerStrategyName, createdAt);\n}\n\nfunction decodeJwtPayload(payload) {\n  if (payload.length === 0) {\n    throw new NbAuthEmptyTokenError('Cannot extract from an empty payload.');\n  }\n\n  const parts = payload.split('.');\n\n  if (parts.length !== 3) {\n    throw new NbAuthIllegalJWTTokenError(`The payload ${payload} is not valid JWT payload and must consist of three parts.`);\n  }\n\n  let decoded;\n\n  try {\n    decoded = urlBase64Decode(parts[1]);\n  } catch (e) {\n    throw new NbAuthIllegalJWTTokenError(`The payload ${payload} is not valid JWT payload and cannot be parsed.`);\n  }\n\n  if (!decoded) {\n    throw new NbAuthIllegalJWTTokenError(`The payload ${payload} is not valid JWT payload and cannot be decoded.`);\n  }\n\n  return JSON.parse(decoded);\n}\n/**\n * Wrapper for simple (text) token\n */\n\n\nlet NbAuthSimpleToken = /*#__PURE__*/(() => {\n  class NbAuthSimpleToken extends NbAuthToken {\n    constructor(token, ownerStrategyName, createdAt) {\n      super();\n      this.token = token;\n      this.ownerStrategyName = ownerStrategyName;\n      this.createdAt = createdAt;\n\n      try {\n        this.parsePayload();\n      } catch (err) {\n        if (!(err instanceof NbAuthTokenNotFoundError)) {\n          // token is present but has got a problem, including illegal\n          throw err;\n        }\n      }\n\n      this.createdAt = this.prepareCreatedAt(createdAt);\n    }\n\n    parsePayload() {\n      this.payload = null;\n    }\n\n    prepareCreatedAt(date) {\n      return date ? date : new Date();\n    }\n    /**\n     * Returns the token's creation date\n     * @returns {Date}\n     */\n\n\n    getCreatedAt() {\n      return this.createdAt;\n    }\n    /**\n     * Returns the token value\n     * @returns string\n     */\n\n\n    getValue() {\n      return this.token;\n    }\n\n    getOwnerStrategyName() {\n      return this.ownerStrategyName;\n    }\n    /**\n     * Is non empty and valid\n     * @returns {boolean}\n     */\n\n\n    isValid() {\n      return !!this.getValue();\n    }\n    /**\n     * Validate value and convert to string, if value is not valid return empty string\n     * @returns {string}\n     */\n\n\n    toString() {\n      return !!this.token ? this.token : '';\n    }\n\n  }\n\n  NbAuthSimpleToken.NAME = 'nb:auth:simple:token';\n  /**\n   * Wrapper for JWT token with additional methods.\n   */\n\n  return NbAuthSimpleToken;\n})();\nlet NbAuthJWTToken = /*#__PURE__*/(() => {\n  class NbAuthJWTToken extends NbAuthSimpleToken {\n    /**\n     * for JWT token, the iat (issued at) field of the token payload contains the creation Date\n     */\n    prepareCreatedAt(date) {\n      const decoded = this.getPayload();\n      return decoded && decoded.iat ? new Date(Number(decoded.iat) * 1000) : super.prepareCreatedAt(date);\n    }\n    /**\n     * Returns payload object\n     * @returns any\n     */\n\n\n    parsePayload() {\n      if (!this.token) {\n        throw new NbAuthTokenNotFoundError('Token not found. ');\n      }\n\n      this.payload = decodeJwtPayload(this.token);\n    }\n    /**\n     * Returns expiration date\n     * @returns Date\n     */\n\n\n    getTokenExpDate() {\n      const decoded = this.getPayload();\n\n      if (decoded && !decoded.hasOwnProperty('exp')) {\n        return null;\n      }\n\n      const date = new Date(0);\n      date.setUTCSeconds(decoded.exp); // 'cause jwt token are set in seconds\n\n      return date;\n    }\n    /**\n     * Is data expired\n     * @returns {boolean}\n     */\n\n\n    isValid() {\n      return super.isValid() && (!this.getTokenExpDate() || new Date() < this.getTokenExpDate());\n    }\n\n  }\n\n  NbAuthJWTToken.NAME = 'nb:auth:jwt:token';\n  return NbAuthJWTToken;\n})();\n\nconst prepareOAuth2Token = data => {\n  if (typeof data === 'string') {\n    try {\n      return JSON.parse(data);\n    } catch (e) {}\n  }\n\n  return data;\n};\n\nconst ɵ0 = prepareOAuth2Token;\n/**\n * Wrapper for OAuth2 token whose access_token is a JWT Token\n */\n\nlet NbAuthOAuth2Token = /*#__PURE__*/(() => {\n  class NbAuthOAuth2Token extends NbAuthSimpleToken {\n    constructor(data = {}, ownerStrategyName, createdAt) {\n      // we may get it as string when retrieving from a storage\n      super(prepareOAuth2Token(data), ownerStrategyName, createdAt);\n    }\n    /**\n     * Returns the token value\n     * @returns string\n     */\n\n\n    getValue() {\n      return this.token.access_token;\n    }\n    /**\n     * Returns the refresh token\n     * @returns string\n     */\n\n\n    getRefreshToken() {\n      return this.token.refresh_token;\n    }\n    /**\n     *  put refreshToken in the token payload\n      * @param refreshToken\n     */\n\n\n    setRefreshToken(refreshToken) {\n      this.token.refresh_token = refreshToken;\n    }\n    /**\n     * Parses token payload\n     * @returns any\n     */\n\n\n    parsePayload() {\n      if (!this.token) {\n        throw new NbAuthTokenNotFoundError('Token not found.');\n      } else {\n        if (!Object.keys(this.token).length) {\n          throw new NbAuthEmptyTokenError('Cannot extract payload from an empty token.');\n        }\n      }\n\n      this.payload = this.token;\n    }\n    /**\n     * Returns the token type\n     * @returns string\n     */\n\n\n    getType() {\n      return this.token.token_type;\n    }\n    /**\n     * Is data expired\n     * @returns {boolean}\n     */\n\n\n    isValid() {\n      return super.isValid() && (!this.getTokenExpDate() || new Date() < this.getTokenExpDate());\n    }\n    /**\n     * Returns expiration date\n     * @returns Date\n     */\n\n\n    getTokenExpDate() {\n      if (!this.token.hasOwnProperty('expires_in')) {\n        return null;\n      }\n\n      return new Date(this.createdAt.getTime() + Number(this.token.expires_in) * 1000);\n    }\n    /**\n     * Convert to string\n     * @returns {string}\n     */\n\n\n    toString() {\n      return JSON.stringify(this.token);\n    }\n\n  }\n\n  NbAuthOAuth2Token.NAME = 'nb:auth:oauth2:token';\n  /**\n   * Wrapper for OAuth2 token embedding JWT tokens\n   */\n\n  return NbAuthOAuth2Token;\n})();\nlet NbAuthOAuth2JWTToken = /*#__PURE__*/(() => {\n  class NbAuthOAuth2JWTToken extends NbAuthOAuth2Token {\n    parsePayload() {\n      super.parsePayload();\n      this.parseAccessTokenPayload();\n    }\n\n    parseAccessTokenPayload() {\n      const accessToken = this.getValue();\n\n      if (!accessToken) {\n        throw new NbAuthTokenNotFoundError('access_token key not found.');\n      }\n\n      this.accessTokenPayload = decodeJwtPayload(accessToken);\n    }\n    /**\n     * Returns access token payload\n     * @returns any\n     */\n\n\n    getAccessTokenPayload() {\n      return this.accessTokenPayload;\n    }\n    /**\n     * for Oauth2 JWT token, the iat (issued at) field of the access_token payload\n     */\n\n\n    prepareCreatedAt(date) {\n      const payload = this.accessTokenPayload;\n      return payload && payload.iat ? new Date(Number(payload.iat) * 1000) : super.prepareCreatedAt(date);\n    }\n    /**\n     * Is token valid\n     * @returns {boolean}\n     */\n\n\n    isValid() {\n      return this.accessTokenPayload && super.isValid();\n    }\n    /**\n     * Returns expiration date :\n     * - exp if set,\n     * - super.getExpDate() otherwise\n     * @returns Date\n     */\n\n\n    getTokenExpDate() {\n      if (this.accessTokenPayload && this.accessTokenPayload.hasOwnProperty('exp')) {\n        const date = new Date(0);\n        date.setUTCSeconds(this.accessTokenPayload.exp);\n        return date;\n      } else {\n        return super.getTokenExpDate();\n      }\n    }\n\n  }\n\n  NbAuthOAuth2JWTToken.NAME = 'nb:auth:oauth2:jwt:token';\n  return NbAuthOAuth2JWTToken;\n})();\n\nvar __decorate$4 = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nvar __metadata$3 = this && this.__metadata || function (k, v) {\n  if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\n\nvar __param$1 = this && this.__param || function (paramIndex, decorator) {\n  return function (target, key) {\n    decorator(target, key, paramIndex);\n  };\n};\n\nconst NB_AUTH_FALLBACK_TOKEN = new InjectionToken('Nebular Auth Options');\n/**\n * Creates a token parcel which could be stored/restored\n */\n\nlet NbAuthTokenParceler = /*#__PURE__*/(() => {\n  let NbAuthTokenParceler = class NbAuthTokenParceler {\n    constructor(fallbackClass, tokenClasses) {\n      this.fallbackClass = fallbackClass;\n      this.tokenClasses = tokenClasses;\n    }\n\n    wrap(token) {\n      return JSON.stringify({\n        name: token.getName(),\n        ownerStrategyName: token.getOwnerStrategyName(),\n        createdAt: token.getCreatedAt().getTime(),\n        value: token.toString()\n      });\n    }\n\n    unwrap(value) {\n      let tokenClass = this.fallbackClass;\n      let tokenValue = '';\n      let tokenOwnerStrategyName = '';\n      let tokenCreatedAt = null;\n      const tokenPack = this.parseTokenPack(value);\n\n      if (tokenPack) {\n        tokenClass = this.getClassByName(tokenPack.name) || this.fallbackClass;\n        tokenValue = tokenPack.value;\n        tokenOwnerStrategyName = tokenPack.ownerStrategyName;\n        tokenCreatedAt = new Date(Number(tokenPack.createdAt));\n      }\n\n      return nbAuthCreateToken(tokenClass, tokenValue, tokenOwnerStrategyName, tokenCreatedAt);\n    } // TODO: this could be moved to a separate token registry\n\n\n    getClassByName(name) {\n      return this.tokenClasses.find(tokenClass => tokenClass.NAME === name);\n    }\n\n    parseTokenPack(value) {\n      try {\n        return JSON.parse(value);\n      } catch (e) {}\n\n      return null;\n    }\n\n  };\n\n  NbAuthTokenParceler.ɵfac = function NbAuthTokenParceler_Factory(t) {\n    return new (t || NbAuthTokenParceler)(ɵngcc0.ɵɵinject(NB_AUTH_FALLBACK_TOKEN), ɵngcc0.ɵɵinject(NB_AUTH_TOKENS));\n  };\n\n  NbAuthTokenParceler.ɵprov = /*@__PURE__*/ɵngcc0.ɵɵdefineInjectable({\n    token: NbAuthTokenParceler,\n    factory: function (t) {\n      return NbAuthTokenParceler.ɵfac(t);\n    }\n  });\n  return NbAuthTokenParceler;\n})();\nNbAuthTokenParceler = __decorate$4([__param$1(0, Inject(NB_AUTH_FALLBACK_TOKEN)), __param$1(1, Inject(NB_AUTH_TOKENS)), __metadata$3(\"design:paramtypes\", [Object, Array])], NbAuthTokenParceler);\n\nvar __decorate$3 = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nvar __metadata$2 = this && this.__metadata || function (k, v) {\n  if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\n\nclass NbTokenStorage {}\n/**\n * Service that uses browser localStorage as a storage.\n *\n * The token storage is provided into auth module the following way:\n * ```ts\n * { provide: NbTokenStorage, useClass: NbTokenLocalStorage },\n * ```\n *\n * If you need to change the storage behaviour or provide your own - just extend your class from basic `NbTokenStorage`\n * or `NbTokenLocalStorage` and provide in your `app.module`:\n * ```ts\n * { provide: NbTokenStorage, useClass: NbTokenCustomStorage },\n * ```\n *\n */\n\n\nlet NbTokenLocalStorage = /*#__PURE__*/(() => {\n  let NbTokenLocalStorage = class NbTokenLocalStorage extends NbTokenStorage {\n    constructor(parceler) {\n      super();\n      this.parceler = parceler;\n      this.key = 'auth_app_token';\n    }\n    /**\n     * Returns token from localStorage\n     * @returns {NbAuthToken}\n     */\n\n\n    get() {\n      const raw = localStorage.getItem(this.key);\n      return this.parceler.unwrap(raw);\n    }\n    /**\n     * Sets token to localStorage\n     * @param {NbAuthToken} token\n     */\n\n\n    set(token) {\n      const raw = this.parceler.wrap(token);\n      localStorage.setItem(this.key, raw);\n    }\n    /**\n     * Clears token from localStorage\n     */\n\n\n    clear() {\n      localStorage.removeItem(this.key);\n    }\n\n  };\n\n  NbTokenLocalStorage.ɵfac = function NbTokenLocalStorage_Factory(t) {\n    return new (t || NbTokenLocalStorage)(ɵngcc0.ɵɵinject(NbAuthTokenParceler));\n  };\n\n  NbTokenLocalStorage.ɵprov = /*@__PURE__*/ɵngcc0.ɵɵdefineInjectable({\n    token: NbTokenLocalStorage,\n    factory: function (t) {\n      return NbTokenLocalStorage.ɵfac(t);\n    }\n  });\n  return NbTokenLocalStorage;\n})();\nNbTokenLocalStorage = __decorate$3([__metadata$2(\"design:paramtypes\", [NbAuthTokenParceler])], NbTokenLocalStorage);\n\nvar __decorate$2 = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nvar __metadata$1 = this && this.__metadata || function (k, v) {\n  if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\n/**\n * Service that allows you to manage authentication token - get, set, clear and also listen to token changes over time.\n */\n\n\nlet NbTokenService = /*#__PURE__*/(() => {\n  let NbTokenService = class NbTokenService {\n    constructor(tokenStorage) {\n      this.tokenStorage = tokenStorage;\n      this.token$ = new BehaviorSubject(null);\n      this.publishStoredToken();\n    }\n    /**\n     * Publishes token when it changes.\n     * @returns {Observable<NbAuthToken>}\n     */\n\n\n    tokenChange() {\n      return this.token$.pipe(filter(value => !!value), share());\n    }\n    /**\n     * Sets a token into the storage. This method is used by the NbAuthService automatically.\n     *\n     * @param {NbAuthToken} token\n     * @returns {Observable<any>}\n     */\n\n\n    set(token) {\n      this.tokenStorage.set(token);\n      this.publishStoredToken();\n      return of(null);\n    }\n    /**\n     * Returns observable of current token\n     * @returns {Observable<NbAuthToken>}\n     */\n\n\n    get() {\n      const token = this.tokenStorage.get();\n      return of(token);\n    }\n    /**\n     * Removes the token and published token value\n     *\n     * @returns {Observable<any>}\n     */\n\n\n    clear() {\n      this.tokenStorage.clear();\n      this.publishStoredToken();\n      return of(null);\n    }\n\n    publishStoredToken() {\n      this.token$.next(this.tokenStorage.get());\n    }\n\n  };\n\n  NbTokenService.ɵfac = function NbTokenService_Factory(t) {\n    return new (t || NbTokenService)(ɵngcc0.ɵɵinject(NbTokenStorage));\n  };\n\n  NbTokenService.ɵprov = /*@__PURE__*/ɵngcc0.ɵɵdefineInjectable({\n    token: NbTokenService,\n    factory: function (t) {\n      return NbTokenService.ɵfac(t);\n    }\n  });\n  return NbTokenService;\n})();\nNbTokenService = __decorate$2([__metadata$1(\"design:paramtypes\", [NbTokenStorage])], NbTokenService);\n\nvar __decorate$1 = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nvar __metadata = this && this.__metadata || function (k, v) {\n  if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\n\nvar __param = this && this.__param || function (paramIndex, decorator) {\n  return function (target, key) {\n    decorator(target, key, paramIndex);\n  };\n};\n/**\n * @license\n * Copyright Akveo. All Rights Reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n */\n\n/**\n * Common authentication service.\n * Should be used to as an interlayer between UI Components and Auth Strategy.\n */\n\n\nlet NbAuthService = /*#__PURE__*/(() => {\n  let NbAuthService = class NbAuthService {\n    constructor(tokenService, strategies) {\n      this.tokenService = tokenService;\n      this.strategies = strategies;\n    }\n    /**\n     * Retrieves current authenticated token stored\n     * @returns {Observable<any>}\n     */\n\n\n    getToken() {\n      return this.tokenService.get();\n    }\n    /**\n     * Returns true if auth token is present in the token storage\n     * @returns {Observable<boolean>}\n     */\n\n\n    isAuthenticated() {\n      return this.getToken().pipe(map(token => token.isValid()));\n    }\n    /**\n     * Returns true if valid auth token is present in the token storage.\n     * If not, calls the strategy refreshToken, and returns isAuthenticated() if success, false otherwise\n     * @returns {Observable<boolean>}\n     */\n\n\n    isAuthenticatedOrRefresh() {\n      return this.getToken().pipe(switchMap(token => {\n        if (token.getValue() && !token.isValid()) {\n          return this.refreshToken(token.getOwnerStrategyName(), token).pipe(switchMap(res => {\n            if (res.isSuccess()) {\n              return this.isAuthenticated();\n            } else {\n              return of(false);\n            }\n          }));\n        } else {\n          return of(token.isValid());\n        }\n      }));\n    }\n    /**\n     * Returns tokens stream\n     * @returns {Observable<NbAuthSimpleToken>}\n     */\n\n\n    onTokenChange() {\n      return this.tokenService.tokenChange();\n    }\n    /**\n     * Returns authentication status stream\n     * @returns {Observable<boolean>}\n     */\n\n\n    onAuthenticationChange() {\n      return this.onTokenChange().pipe(map(token => token.isValid()));\n    }\n    /**\n     * Authenticates with the selected strategy\n     * Stores received token in the token storage\n     *\n     * Example:\n     * authenticate('email', {email: 'email@example.com', password: 'test'})\n     *\n     * @param strategyName\n     * @param data\n     * @returns {Observable<NbAuthResult>}\n     */\n\n\n    authenticate(strategyName, data) {\n      return this.getStrategy(strategyName).authenticate(data).pipe(switchMap(result => {\n        return this.processResultToken(result);\n      }));\n    }\n    /**\n     * Registers with the selected strategy\n     * Stores received token in the token storage\n     *\n     * Example:\n     * register('email', {email: 'email@example.com', name: 'Some Name', password: 'test'})\n     *\n     * @param strategyName\n     * @param data\n     * @returns {Observable<NbAuthResult>}\n     */\n\n\n    register(strategyName, data) {\n      return this.getStrategy(strategyName).register(data).pipe(switchMap(result => {\n        return this.processResultToken(result);\n      }));\n    }\n    /**\n     * Sign outs with the selected strategy\n     * Removes token from the token storage\n     *\n     * Example:\n     * logout('email')\n     *\n     * @param strategyName\n     * @returns {Observable<NbAuthResult>}\n     */\n\n\n    logout(strategyName) {\n      return this.getStrategy(strategyName).logout().pipe(switchMap(result => {\n        if (result.isSuccess()) {\n          this.tokenService.clear().pipe(map(() => result));\n        }\n\n        return of(result);\n      }));\n    }\n    /**\n     * Sends forgot password request to the selected strategy\n     *\n     * Example:\n     * requestPassword('email', {email: 'email@example.com'})\n     *\n     * @param strategyName\n     * @param data\n     * @returns {Observable<NbAuthResult>}\n     */\n\n\n    requestPassword(strategyName, data) {\n      return this.getStrategy(strategyName).requestPassword(data);\n    }\n    /**\n     * Tries to reset password with the selected strategy\n     *\n     * Example:\n     * resetPassword('email', {newPassword: 'test'})\n     *\n     * @param strategyName\n     * @param data\n     * @returns {Observable<NbAuthResult>}\n     */\n\n\n    resetPassword(strategyName, data) {\n      return this.getStrategy(strategyName).resetPassword(data);\n    }\n    /**\n     * Sends a refresh token request\n     * Stores received token in the token storage\n     *\n     * Example:\n     * refreshToken('email', {token: token})\n     *\n     * @param {string} strategyName\n     * @param data\n     * @returns {Observable<NbAuthResult>}\n     */\n\n\n    refreshToken(strategyName, data) {\n      return this.getStrategy(strategyName).refreshToken(data).pipe(switchMap(result => {\n        return this.processResultToken(result);\n      }));\n    }\n    /**\n     * Get registered strategy by name\n     *\n     * Example:\n     * getStrategy('email')\n     *\n     * @param {string} provider\n     * @returns {NbAbstractAuthProvider}\n     */\n\n\n    getStrategy(strategyName) {\n      const found = this.strategies.find(strategy => strategy.getName() === strategyName);\n\n      if (!found) {\n        throw new TypeError(`There is no Auth Strategy registered under '${strategyName}' name`);\n      }\n\n      return found;\n    }\n\n    processResultToken(result) {\n      if (result.isSuccess() && result.getToken()) {\n        return this.tokenService.set(result.getToken()).pipe(map(token => {\n          return result;\n        }));\n      }\n\n      return of(result);\n    }\n\n  };\n\n  NbAuthService.ɵfac = function NbAuthService_Factory(t) {\n    return new (t || NbAuthService)(ɵngcc0.ɵɵinject(NbTokenService), ɵngcc0.ɵɵinject(NB_AUTH_STRATEGIES));\n  };\n\n  NbAuthService.ɵprov = /*@__PURE__*/ɵngcc0.ɵɵdefineInjectable({\n    token: NbAuthService,\n    factory: function (t) {\n      return NbAuthService.ɵfac(t);\n    }\n  });\n  return NbAuthService;\n})();\nNbAuthService = __decorate$1([__param(1, Inject(NB_AUTH_STRATEGIES)), __metadata(\"design:paramtypes\", [NbTokenService, Object])], NbAuthService);\n\nclass NbAuthStrategy {\n  // we should keep this any and validation should be done in `register` method instead\n  // otherwise it won't be possible to pass an empty object\n  setOptions(options) {\n    this.options = deepExtend({}, this.defaultOptions, options);\n  }\n\n  getOption(key) {\n    return getDeepFromObject(this.options, key, null);\n  }\n\n  createToken(value, failWhenInvalidToken) {\n    const token = nbAuthCreateToken(this.getOption('token.class'), value, this.getName()); // At this point, nbAuthCreateToken failed with NbAuthIllegalTokenError which MUST be intercepted by strategies\n    // Or token is created. It MAY be created even if backend did not return any token, in this case it is !Valid\n\n    if (failWhenInvalidToken && !token.isValid()) {\n      // If we require a valid token (i.e. isValid), then we MUST throw NbAuthIllegalTokenError so that the strategies\n      // intercept it\n      throw new NbAuthIllegalTokenError('Token is empty or invalid.');\n    }\n\n    return token;\n  }\n\n  getName() {\n    return this.getOption('name');\n  }\n\n  createFailResponse(data) {\n    return new HttpResponse({\n      body: {},\n      status: 401\n    });\n  }\n\n  createSuccessResponse(data) {\n    return new HttpResponse({\n      body: {},\n      status: 200\n    });\n  }\n\n  getActionEndpoint(action) {\n    const actionEndpoint = this.getOption(`${action}.endpoint`);\n    const baseEndpoint = this.getOption('baseEndpoint');\n    return actionEndpoint ? baseEndpoint + actionEndpoint : '';\n  }\n\n}\n\nclass NbAuthResult {\n  // TODO: better pass object\n  constructor(success, response, redirect, errors, messages, token = null) {\n    this.success = success;\n    this.response = response;\n    this.redirect = redirect;\n    this.errors = [];\n    this.messages = [];\n    this.errors = this.errors.concat([errors]);\n\n    if (errors instanceof Array) {\n      this.errors = errors;\n    }\n\n    this.messages = this.messages.concat([messages]);\n\n    if (messages instanceof Array) {\n      this.messages = messages;\n    }\n\n    this.token = token;\n  }\n\n  getResponse() {\n    return this.response;\n  }\n\n  getToken() {\n    return this.token;\n  }\n\n  getRedirect() {\n    return this.redirect;\n  }\n\n  getErrors() {\n    return this.errors.filter(val => !!val);\n  }\n\n  getMessages() {\n    return this.messages.filter(val => !!val);\n  }\n\n  isSuccess() {\n    return this.success;\n  }\n\n  isFailure() {\n    return !this.success;\n  }\n\n}\n\nclass NbAuthStrategyOptions {}\n/**\n * @license\n * Copyright Akveo. All Rights Reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n */\n\n\nclass NbDummyAuthStrategyOptions extends NbAuthStrategyOptions {\n  constructor() {\n    super(...arguments);\n    this.token = {\n      class: NbAuthSimpleToken\n    };\n    this.delay = 1000;\n    this.alwaysFail = false;\n  }\n\n}\n\nconst dummyStrategyOptions = new NbDummyAuthStrategyOptions();\n\nvar __decorate$5 = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nvar NbDummyAuthStrategy_1;\n/**\n * Dummy auth strategy. Could be useful for auth setup when backend is not available yet.\n *\n *\n * Strategy settings.\n *\n * ```ts\n * export class NbDummyAuthStrategyOptions extends NbAuthStrategyOptions {\n *   name = 'dummy';\n *   token = {\n *     class: NbAuthSimpleToken,\n *   };\n *   delay? = 1000;\n *   alwaysFail? = false;\n * }\n * ```\n */\n\nlet NbDummyAuthStrategy = NbDummyAuthStrategy_1 = class NbDummyAuthStrategy extends NbAuthStrategy {\n  /**\n   * Dummy auth strategy. Could be useful for auth setup when backend is not available yet.\n   *\n   *\n   * Strategy settings.\n   *\n   * ```ts\n   * export class NbDummyAuthStrategyOptions extends NbAuthStrategyOptions {\n   *   name = 'dummy';\n   *   token = {\n   *     class: NbAuthSimpleToken,\n   *   };\n   *   delay? = 1000;\n   *   alwaysFail? = false;\n   * }\n   * ```\n   */\n  constructor() {\n    super(...arguments);\n    this.defaultOptions = dummyStrategyOptions;\n  }\n\n  static setup(options) {\n    return [NbDummyAuthStrategy_1, options];\n  }\n\n  authenticate(data) {\n    return of(this.createDummyResult(data)).pipe(delay(this.getOption('delay')));\n  }\n\n  register(data) {\n    return of(this.createDummyResult(data)).pipe(delay(this.getOption('delay')));\n  }\n\n  requestPassword(data) {\n    return of(this.createDummyResult(data)).pipe(delay(this.getOption('delay')));\n  }\n\n  resetPassword(data) {\n    return of(this.createDummyResult(data)).pipe(delay(this.getOption('delay')));\n  }\n\n  logout(data) {\n    return of(this.createDummyResult(data)).pipe(delay(this.getOption('delay')));\n  }\n\n  refreshToken(data) {\n    return of(this.createDummyResult(data)).pipe(delay(this.getOption('delay')));\n  }\n\n  createDummyResult(data) {\n    if (this.getOption('alwaysFail')) {\n      return new NbAuthResult(false, this.createFailResponse(data), null, ['Something went wrong.']);\n    }\n\n    try {\n      const token = this.createToken('test token', true);\n      return new NbAuthResult(true, this.createSuccessResponse(data), '/', [], ['Successfully logged in.'], token);\n    } catch (err) {\n      return new NbAuthResult(false, this.createFailResponse(data), null, [err.message]);\n    }\n  }\n\n};\n\nNbDummyAuthStrategy.ɵfac = /*@__PURE__*/function () {\n  let ɵNbDummyAuthStrategy_BaseFactory;\n  return function NbDummyAuthStrategy_Factory(t) {\n    return (ɵNbDummyAuthStrategy_BaseFactory || (ɵNbDummyAuthStrategy_BaseFactory = ɵngcc0.ɵɵgetInheritedFactory(NbDummyAuthStrategy)))(t || NbDummyAuthStrategy);\n  };\n}();\n\nNbDummyAuthStrategy.ɵprov = /*@__PURE__*/ɵngcc0.ɵɵdefineInjectable({\n  token: NbDummyAuthStrategy,\n  factory: function (t) {\n    return NbDummyAuthStrategy.ɵfac(t);\n  }\n});\n/**\n * @license\n * Copyright Akveo. All Rights Reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n */\n\nvar NbOAuth2ResponseType = /*#__PURE__*/(() => {\n  (function (NbOAuth2ResponseType) {\n    NbOAuth2ResponseType[\"CODE\"] = \"code\";\n    NbOAuth2ResponseType[\"TOKEN\"] = \"token\";\n  })(NbOAuth2ResponseType || (NbOAuth2ResponseType = {}));\n\n  return NbOAuth2ResponseType;\n})();\n// TODO: client_credentials\nvar NbOAuth2GrantType = /*#__PURE__*/(() => {\n  (function (NbOAuth2GrantType) {\n    NbOAuth2GrantType[\"AUTHORIZATION_CODE\"] = \"authorization_code\";\n    NbOAuth2GrantType[\"PASSWORD\"] = \"password\";\n    NbOAuth2GrantType[\"REFRESH_TOKEN\"] = \"refresh_token\";\n  })(NbOAuth2GrantType || (NbOAuth2GrantType = {}));\n\n  return NbOAuth2GrantType;\n})();\nvar NbOAuth2ClientAuthMethod = /*#__PURE__*/(() => {\n  (function (NbOAuth2ClientAuthMethod) {\n    NbOAuth2ClientAuthMethod[\"NONE\"] = \"none\";\n    NbOAuth2ClientAuthMethod[\"BASIC\"] = \"basic\";\n    NbOAuth2ClientAuthMethod[\"REQUEST_BODY\"] = \"request-body\";\n  })(NbOAuth2ClientAuthMethod || (NbOAuth2ClientAuthMethod = {}));\n\n  return NbOAuth2ClientAuthMethod;\n})();\n\nclass NbOAuth2AuthStrategyOptions extends NbAuthStrategyOptions {\n  constructor() {\n    super(...arguments);\n    this.baseEndpoint = '';\n    this.clientId = '';\n    this.clientSecret = '';\n    this.clientAuthMethod = NbOAuth2ClientAuthMethod.NONE;\n    this.redirect = {\n      success: '/',\n      failure: null\n    };\n    this.defaultErrors = ['Something went wrong, please try again.'];\n    this.defaultMessages = ['You have been successfully authenticated.'];\n    this.authorize = {\n      endpoint: 'authorize',\n      responseType: NbOAuth2ResponseType.CODE\n    };\n    this.token = {\n      endpoint: 'token',\n      grantType: NbOAuth2GrantType.AUTHORIZATION_CODE,\n      requireValidToken: false,\n      class: NbAuthOAuth2Token\n    };\n    this.refresh = {\n      endpoint: 'token',\n      grantType: NbOAuth2GrantType.REFRESH_TOKEN\n    };\n  }\n\n}\n\nconst auth2StrategyOptions = new NbOAuth2AuthStrategyOptions();\n\nvar __decorate$6 = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nvar __metadata$4 = this && this.__metadata || function (k, v) {\n  if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\n\nvar __param$2 = this && this.__param || function (paramIndex, decorator) {\n  return function (target, key) {\n    decorator(target, key, paramIndex);\n  };\n};\n\nvar NbOAuth2AuthStrategy_1;\n/**\n * @license\n * Copyright Akveo. All Rights Reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n */\n\n/**\n * OAuth2 authentication strategy.\n *\n * Strategy settings:\n *\n * ```ts\n * export enum NbOAuth2ResponseType {\n *   CODE = 'code',\n *   TOKEN = 'token',\n * }\n *\n * export enum NbOAuth2GrantType {\n *   AUTHORIZATION_CODE = 'authorization_code',\n *   PASSWORD = 'password',\n *   REFRESH_TOKEN = 'refresh_token',\n * }\n *\n * export class NbOAuth2AuthStrategyOptions {\n *   name: string;\n *   baseEndpoint?: string = '';\n *   clientId: string = '';\n *   clientSecret: string = '';\n *   clientAuthMethod: string = NbOAuth2ClientAuthMethod.NONE;\n *   redirect?: { success?: string; failure?: string } = {\n *     success: '/',\n *     failure: null,\n *   };\n *   defaultErrors?: any[] = ['Something went wrong, please try again.'];\n *   defaultMessages?: any[] = ['You have been successfully authenticated.'];\n *   authorize?: {\n *     endpoint?: string;\n *     redirectUri?: string;\n *     responseType?: string;\n *     requireValidToken: false,\n *     scope?: string;\n *     state?: string;\n *     params?: { [key: string]: string };\n *   } = {\n *     endpoint: 'authorize',\n *     responseType: NbOAuth2ResponseType.CODE,\n *   };\n *   token?: {\n *     endpoint?: string;\n *     grantType?: string;\n *     requireValidToken: false,\n *     redirectUri?: string;\n *     scope?: string;\n *     class: NbAuthTokenClass,\n *   } = {\n *     endpoint: 'token',\n *     grantType: NbOAuth2GrantType.AUTHORIZATION_CODE,\n *     class: NbAuthOAuth2Token,\n *   };\n *   refresh?: {\n *     endpoint?: string;\n *     grantType?: string;\n *     scope?: string;\n *     requireValidToken: false,\n *   } = {\n *     endpoint: 'token',\n *     grantType: NbOAuth2GrantType.REFRESH_TOKEN,\n *   };\n * }\n * ```\n *\n */\n\nlet NbOAuth2AuthStrategy = NbOAuth2AuthStrategy_1 = class NbOAuth2AuthStrategy extends NbAuthStrategy {\n  constructor(http, route, window) {\n    super();\n    this.http = http;\n    this.route = route;\n    this.window = window;\n    this.redirectResultHandlers = {\n      [NbOAuth2ResponseType.CODE]: () => {\n        return of(this.route.snapshot.queryParams).pipe(switchMap(params => {\n          if (params.code) {\n            return this.requestToken(params.code);\n          }\n\n          return of(new NbAuthResult(false, params, this.getOption('redirect.failure'), this.getOption('defaultErrors'), []));\n        }));\n      },\n      [NbOAuth2ResponseType.TOKEN]: () => {\n        const module = 'authorize';\n        const requireValidToken = this.getOption(`${module}.requireValidToken`);\n        return of(this.route.snapshot.fragment).pipe(map(fragment => this.parseHashAsQueryParams(fragment)), map(params => {\n          if (!params.error) {\n            return new NbAuthResult(true, params, this.getOption('redirect.success'), [], this.getOption('defaultMessages'), this.createToken(params, requireValidToken));\n          }\n\n          return new NbAuthResult(false, params, this.getOption('redirect.failure'), this.getOption('defaultErrors'), []);\n        }), catchError(err => {\n          const errors = [];\n\n          if (err instanceof NbAuthIllegalTokenError) {\n            errors.push(err.message);\n          } else {\n            errors.push('Something went wrong.');\n          }\n\n          return of(new NbAuthResult(false, err, this.getOption('redirect.failure'), errors));\n        }));\n      }\n    };\n    this.redirectResults = {\n      [NbOAuth2ResponseType.CODE]: () => {\n        return of(this.route.snapshot.queryParams).pipe(map(params => !!(params && (params.code || params.error))));\n      },\n      [NbOAuth2ResponseType.TOKEN]: () => {\n        return of(this.route.snapshot.fragment).pipe(map(fragment => this.parseHashAsQueryParams(fragment)), map(params => !!(params && (params.access_token || params.error))));\n      }\n    };\n    this.defaultOptions = auth2StrategyOptions;\n  }\n\n  static setup(options) {\n    return [NbOAuth2AuthStrategy_1, options];\n  }\n\n  get responseType() {\n    return this.getOption('authorize.responseType');\n  }\n\n  get clientAuthMethod() {\n    return this.getOption('clientAuthMethod');\n  }\n\n  authenticate(data) {\n    if (this.getOption('token.grantType') === NbOAuth2GrantType.PASSWORD) {\n      return this.passwordToken(data.email, data.password);\n    } else {\n      return this.isRedirectResult().pipe(switchMap(result => {\n        if (!result) {\n          this.authorizeRedirect();\n          return of(new NbAuthResult(true));\n        }\n\n        return this.getAuthorizationResult();\n      }));\n    }\n  }\n\n  getAuthorizationResult() {\n    const redirectResultHandler = this.redirectResultHandlers[this.responseType];\n\n    if (redirectResultHandler) {\n      return redirectResultHandler.call(this);\n    }\n\n    throw new Error(`'${this.responseType}' responseType is not supported,\n                      only 'token' and 'code' are supported now`);\n  }\n\n  refreshToken(token) {\n    const module = 'refresh';\n    const url = this.getActionEndpoint(module);\n    const requireValidToken = this.getOption(`${module}.requireValidToken`);\n    let headers = this.buildAuthHeader() || new HttpHeaders();\n    headers = headers.append('Content-Type', 'application/x-www-form-urlencoded');\n    return this.http.post(url, this.buildRefreshRequestData(token), {\n      headers: headers\n    }).pipe(map(res => {\n      return new NbAuthResult(true, res, this.getOption('redirect.success'), [], this.getOption('defaultMessages'), this.createRefreshedToken(res, token, requireValidToken));\n    }), catchError(res => this.handleResponseError(res)));\n  }\n\n  passwordToken(username, password) {\n    const module = 'token';\n    const url = this.getActionEndpoint(module);\n    const requireValidToken = this.getOption(`${module}.requireValidToken`);\n    let headers = this.buildAuthHeader() || new HttpHeaders();\n    headers = headers.append('Content-Type', 'application/x-www-form-urlencoded');\n    return this.http.post(url, this.buildPasswordRequestData(username, password), {\n      headers: headers\n    }).pipe(map(res => {\n      return new NbAuthResult(true, res, this.getOption('redirect.success'), [], this.getOption('defaultMessages'), this.createToken(res, requireValidToken));\n    }), catchError(res => this.handleResponseError(res)));\n  }\n\n  authorizeRedirect() {\n    this.window.location.href = this.buildRedirectUrl();\n  }\n\n  isRedirectResult() {\n    return this.redirectResults[this.responseType].call(this);\n  }\n\n  requestToken(code) {\n    const module = 'token';\n    const url = this.getActionEndpoint(module);\n    const requireValidToken = this.getOption(`${module}.requireValidToken`);\n    let headers = this.buildAuthHeader() || new HttpHeaders();\n    headers = headers.append('Content-Type', 'application/x-www-form-urlencoded');\n    return this.http.post(url, this.buildCodeRequestData(code), {\n      headers: headers\n    }).pipe(map(res => {\n      return new NbAuthResult(true, res, this.getOption('redirect.success'), [], this.getOption('defaultMessages'), this.createToken(res, requireValidToken));\n    }), catchError(res => this.handleResponseError(res)));\n  }\n\n  buildCodeRequestData(code) {\n    const params = {\n      grant_type: this.getOption('token.grantType'),\n      code: code,\n      redirect_uri: this.getOption('token.redirectUri'),\n      client_id: this.getOption('clientId')\n    };\n    return this.urlEncodeParameters(this.cleanParams(this.addCredentialsToParams(params)));\n  }\n\n  buildRefreshRequestData(token) {\n    const params = {\n      grant_type: this.getOption('refresh.grantType'),\n      refresh_token: token.getRefreshToken(),\n      scope: this.getOption('refresh.scope')\n    };\n    return this.urlEncodeParameters(this.cleanParams(this.addCredentialsToParams(params)));\n  }\n\n  buildPasswordRequestData(username, password) {\n    const params = {\n      grant_type: this.getOption('token.grantType'),\n      username: username,\n      password: password,\n      scope: this.getOption('token.scope')\n    };\n    return this.urlEncodeParameters(this.cleanParams(this.addCredentialsToParams(params)));\n  }\n\n  buildAuthHeader() {\n    if (this.clientAuthMethod === NbOAuth2ClientAuthMethod.BASIC) {\n      if (this.getOption('clientId') && this.getOption('clientSecret')) {\n        return new HttpHeaders({\n          'Authorization': 'Basic ' + btoa(this.getOption('clientId') + ':' + this.getOption('clientSecret'))\n        });\n      } else {\n        throw Error('For basic client authentication method, please provide both clientId & clientSecret.');\n      }\n    }\n  }\n\n  cleanParams(params) {\n    Object.entries(params).forEach(([key, val]) => !val && delete params[key]);\n    return params;\n  }\n\n  addCredentialsToParams(params) {\n    if (this.clientAuthMethod === NbOAuth2ClientAuthMethod.REQUEST_BODY) {\n      if (this.getOption('clientId') && this.getOption('clientSecret')) {\n        return Object.assign({}, params, {\n          client_id: this.getOption('clientId'),\n          client_secret: this.getOption('clientSecret')\n        });\n      } else {\n        throw Error('For request body client authentication method, please provide both clientId & clientSecret.');\n      }\n    }\n\n    return params;\n  }\n\n  handleResponseError(res) {\n    let errors = [];\n\n    if (res instanceof HttpErrorResponse) {\n      if (res.error.error_description) {\n        errors.push(res.error.error_description);\n      } else {\n        errors = this.getOption('defaultErrors');\n      }\n    } else if (res instanceof NbAuthIllegalTokenError) {\n      errors.push(res.message);\n    } else {\n      errors.push('Something went wrong.');\n    }\n\n    return of(new NbAuthResult(false, res, this.getOption('redirect.failure'), errors, []));\n  }\n\n  buildRedirectUrl() {\n    const params = Object.assign({\n      response_type: this.getOption('authorize.responseType'),\n      client_id: this.getOption('clientId'),\n      redirect_uri: this.getOption('authorize.redirectUri'),\n      scope: this.getOption('authorize.scope'),\n      state: this.getOption('authorize.state')\n    }, this.getOption('authorize.params'));\n    const endpoint = this.getActionEndpoint('authorize');\n    const query = this.urlEncodeParameters(this.cleanParams(params));\n    return `${endpoint}?${query}`;\n  }\n\n  parseHashAsQueryParams(hash) {\n    return hash ? hash.split('&').reduce((acc, part) => {\n      const item = part.split('=');\n      acc[item[0]] = decodeURIComponent(item[1]);\n      return acc;\n    }, {}) : {};\n  }\n\n  urlEncodeParameters(params) {\n    return Object.keys(params).map(k => {\n      return `${encodeURIComponent(k)}=${encodeURIComponent(params[k])}`;\n    }).join('&');\n  }\n\n  createRefreshedToken(res, existingToken, requireValidToken) {\n    const refreshedToken = this.createToken(res, requireValidToken);\n\n    if (!refreshedToken.getRefreshToken() && existingToken.getRefreshToken()) {\n      refreshedToken.setRefreshToken(existingToken.getRefreshToken());\n    }\n\n    return refreshedToken;\n  }\n\n  register(data) {\n    throw new Error('`register` is not supported by `NbOAuth2AuthStrategy`, use `authenticate`.');\n  }\n\n  requestPassword(data) {\n    throw new Error('`requestPassword` is not supported by `NbOAuth2AuthStrategy`, use `authenticate`.');\n  }\n\n  resetPassword(data = {}) {\n    throw new Error('`resetPassword` is not supported by `NbOAuth2AuthStrategy`, use `authenticate`.');\n  }\n\n  logout() {\n    return of(new NbAuthResult(true));\n  }\n\n};\n\nNbOAuth2AuthStrategy.ɵfac = function NbOAuth2AuthStrategy_Factory(t) {\n  return new (t || NbOAuth2AuthStrategy)(ɵngcc0.ɵɵinject(ɵngcc1.HttpClient), ɵngcc0.ɵɵinject(ɵngcc2.ActivatedRoute), ɵngcc0.ɵɵinject(NB_WINDOW));\n};\n\nNbOAuth2AuthStrategy.ɵprov = /*@__PURE__*/ɵngcc0.ɵɵdefineInjectable({\n  token: NbOAuth2AuthStrategy,\n  factory: function (t) {\n    return NbOAuth2AuthStrategy.ɵfac(t);\n  }\n});\nNbOAuth2AuthStrategy = NbOAuth2AuthStrategy_1 = __decorate$6([__param$2(2, Inject(NB_WINDOW)), __metadata$4(\"design:paramtypes\", [HttpClient, ActivatedRoute, Object])], NbOAuth2AuthStrategy);\n/**\n * @license\n * Copyright Akveo. All Rights Reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n */\n\nclass NbPasswordAuthStrategyOptions extends NbAuthStrategyOptions {\n  constructor() {\n    super(...arguments);\n    this.baseEndpoint = '/api/auth/';\n    this.login = {\n      alwaysFail: false,\n      endpoint: 'login',\n      method: 'post',\n      requireValidToken: false,\n      redirect: {\n        success: '/',\n        failure: null\n      },\n      defaultErrors: ['Login/Email combination is not correct, please try again.'],\n      defaultMessages: ['You have been successfully logged in.']\n    };\n    this.register = {\n      alwaysFail: false,\n      endpoint: 'register',\n      method: 'post',\n      requireValidToken: false,\n      redirect: {\n        success: '/',\n        failure: null\n      },\n      defaultErrors: ['Something went wrong, please try again.'],\n      defaultMessages: ['You have been successfully registered.']\n    };\n    this.requestPass = {\n      endpoint: 'request-pass',\n      method: 'post',\n      redirect: {\n        success: '/',\n        failure: null\n      },\n      defaultErrors: ['Something went wrong, please try again.'],\n      defaultMessages: ['Reset password instructions have been sent to your email.']\n    };\n    this.resetPass = {\n      endpoint: 'reset-pass',\n      method: 'put',\n      redirect: {\n        success: '/',\n        failure: null\n      },\n      resetPasswordTokenKey: 'reset_password_token',\n      defaultErrors: ['Something went wrong, please try again.'],\n      defaultMessages: ['Your password has been successfully changed.']\n    };\n    this.logout = {\n      alwaysFail: false,\n      endpoint: 'logout',\n      method: 'delete',\n      redirect: {\n        success: '/',\n        failure: null\n      },\n      defaultErrors: ['Something went wrong, please try again.'],\n      defaultMessages: ['You have been successfully logged out.']\n    };\n    this.refreshToken = {\n      endpoint: 'refresh-token',\n      method: 'post',\n      requireValidToken: false,\n      redirect: {\n        success: null,\n        failure: null\n      },\n      defaultErrors: ['Something went wrong, please try again.'],\n      defaultMessages: ['Your token has been successfully refreshed.']\n    };\n    this.token = {\n      class: NbAuthSimpleToken,\n      key: 'data.token',\n      getter: (module, res, options) => getDeepFromObject(res.body, options.token.key)\n    };\n    this.errors = {\n      key: 'data.errors',\n      getter: (module, res, options) => getDeepFromObject(res.error, options.errors.key, options[module].defaultErrors)\n    };\n    this.messages = {\n      key: 'data.messages',\n      getter: (module, res, options) => getDeepFromObject(res.body, options.messages.key, options[module].defaultMessages)\n    };\n  }\n\n}\n\nconst passwordStrategyOptions = new NbPasswordAuthStrategyOptions();\n\nvar __decorate$7 = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nvar __metadata$5 = this && this.__metadata || function (k, v) {\n  if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\n\nvar NbPasswordAuthStrategy_1;\n/**\n * @license\n * Copyright Akveo. All Rights Reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n */\n\n/**\n * The most common authentication provider for email/password strategy.\n *\n * Strategy settings. Note, there is no need to copy over the whole object to change the settings you need.\n * Also, this.getOption call won't work outside of the default options declaration\n * (which is inside of the `NbPasswordAuthStrategy` class), so you have to replace it with a custom helper function\n * if you need it.\n *\n * ```ts\n *export class NbPasswordAuthStrategyOptions extends NbAuthStrategyOptions {\n *  name: string;\n *  baseEndpoint? = '/api/auth/';\n *  login?: boolean | NbPasswordStrategyModule = {\n *    alwaysFail: false,\n *    endpoint: 'login',\n *    method: 'post',\n *    requireValidToken: false,\n *    redirect: {\n *      success: '/',\n *      failure: null,\n *    },\n *    defaultErrors: ['Login/Email combination is not correct, please try again.'],\n *    defaultMessages: ['You have been successfully logged in.'],\n *  };\n *  register?: boolean | NbPasswordStrategyModule = {\n *    alwaysFail: false,\n *    endpoint: 'register',\n *    method: 'post',\n *    requireValidToken: false,\n *    redirect: {\n *      success: '/',\n *      failure: null,\n *    },\n *    defaultErrors: ['Something went wrong, please try again.'],\n *    defaultMessages: ['You have been successfully registered.'],\n *  };\n *  requestPass?: boolean | NbPasswordStrategyModule = {\n *    endpoint: 'request-pass',\n *    method: 'post',\n *    redirect: {\n *      success: '/',\n *      failure: null,\n *    },\n *    defaultErrors: ['Something went wrong, please try again.'],\n *    defaultMessages: ['Reset password instructions have been sent to your email.'],\n *  };\n *  resetPass?: boolean | NbPasswordStrategyReset = {\n *    endpoint: 'reset-pass',\n *    method: 'put',\n *    redirect: {\n *      success: '/',\n *      failure: null,\n *    },\n *    resetPasswordTokenKey: 'reset_password_token',\n *    defaultErrors: ['Something went wrong, please try again.'],\n *    defaultMessages: ['Your password has been successfully changed.'],\n *  };\n *  logout?: boolean | NbPasswordStrategyReset = {\n *    alwaysFail: false,\n *    endpoint: 'logout',\n *    method: 'delete',\n *    redirect: {\n *      success: '/',\n *      failure: null,\n *    },\n *    defaultErrors: ['Something went wrong, please try again.'],\n *    defaultMessages: ['You have been successfully logged out.'],\n *  };\n *  refreshToken?: boolean | NbPasswordStrategyModule = {\n *    endpoint: 'refresh-token',\n *    method: 'post',\n *    requireValidToken: false,\n *    redirect: {\n *      success: null,\n *      failure: null,\n *    },\n *    defaultErrors: ['Something went wrong, please try again.'],\n *    defaultMessages: ['Your token has been successfully refreshed.'],\n *  };\n *  token?: NbPasswordStrategyToken = {\n *    class: NbAuthSimpleToken,\n *    key: 'data.token',\n *    getter: (module: string, res: HttpResponse<Object>, options: NbPasswordAuthStrategyOptions) => getDeepFromObject(\n *      res.body,\n *      options.token.key,\n *    ),\n *  };\n *  errors?: NbPasswordStrategyMessage = {\n *    key: 'data.errors',\n *    getter: (module: string, res: HttpErrorResponse, options: NbPasswordAuthStrategyOptions) => getDeepFromObject(\n *      res.error,\n *      options.errors.key,\n *      options[module].defaultErrors,\n *    ),\n *  };\n *  messages?: NbPasswordStrategyMessage = {\n *    key: 'data.messages',\n *    getter: (module: string, res: HttpResponse<Object>, options: NbPasswordAuthStrategyOptions) => getDeepFromObject(\n *      res.body,\n *      options.messages.key,\n *      options[module].defaultMessages,\n *    ),\n *  };\n *  validation?: {\n *    password?: {\n *      required?: boolean;\n *      minLength?: number | null;\n *      maxLength?: number | null;\n *      regexp?: string | null;\n *    };\n *    email?: {\n *      required?: boolean;\n *      regexp?: string | null;\n *    };\n *    fullName?: {\n *      required?: boolean;\n *      minLength?: number | null;\n *      maxLength?: number | null;\n *      regexp?: string | null;\n *    };\n *  };\n *}\n * ```\n */\n\nlet NbPasswordAuthStrategy = NbPasswordAuthStrategy_1 = class NbPasswordAuthStrategy extends NbAuthStrategy {\n  constructor(http, route) {\n    super();\n    this.http = http;\n    this.route = route;\n    this.defaultOptions = passwordStrategyOptions;\n  }\n\n  static setup(options) {\n    return [NbPasswordAuthStrategy_1, options];\n  }\n\n  authenticate(data) {\n    const module = 'login';\n    const method = this.getOption(`${module}.method`);\n    const url = this.getActionEndpoint(module);\n    const requireValidToken = this.getOption(`${module}.requireValidToken`);\n    return this.http.request(method, url, {\n      body: data,\n      observe: 'response'\n    }).pipe(map(res => {\n      if (this.getOption(`${module}.alwaysFail`)) {\n        throw this.createFailResponse(data);\n      }\n\n      return res;\n    }), map(res => {\n      return new NbAuthResult(true, res, this.getOption(`${module}.redirect.success`), [], this.getOption('messages.getter')(module, res, this.options), this.createToken(this.getOption('token.getter')(module, res, this.options), requireValidToken));\n    }), catchError(res => {\n      return this.handleResponseError(res, module);\n    }));\n  }\n\n  register(data) {\n    const module = 'register';\n    const method = this.getOption(`${module}.method`);\n    const url = this.getActionEndpoint(module);\n    const requireValidToken = this.getOption(`${module}.requireValidToken`);\n    return this.http.request(method, url, {\n      body: data,\n      observe: 'response'\n    }).pipe(map(res => {\n      if (this.getOption(`${module}.alwaysFail`)) {\n        throw this.createFailResponse(data);\n      }\n\n      return res;\n    }), map(res => {\n      return new NbAuthResult(true, res, this.getOption(`${module}.redirect.success`), [], this.getOption('messages.getter')(module, res, this.options), this.createToken(this.getOption('token.getter')('login', res, this.options), requireValidToken));\n    }), catchError(res => {\n      return this.handleResponseError(res, module);\n    }));\n  }\n\n  requestPassword(data) {\n    const module = 'requestPass';\n    const method = this.getOption(`${module}.method`);\n    const url = this.getActionEndpoint(module);\n    return this.http.request(method, url, {\n      body: data,\n      observe: 'response'\n    }).pipe(map(res => {\n      if (this.getOption(`${module}.alwaysFail`)) {\n        throw this.createFailResponse();\n      }\n\n      return res;\n    }), map(res => {\n      return new NbAuthResult(true, res, this.getOption(`${module}.redirect.success`), [], this.getOption('messages.getter')(module, res, this.options));\n    }), catchError(res => {\n      return this.handleResponseError(res, module);\n    }));\n  }\n\n  resetPassword(data = {}) {\n    const module = 'resetPass';\n    const method = this.getOption(`${module}.method`);\n    const url = this.getActionEndpoint(module);\n    const tokenKey = this.getOption(`${module}.resetPasswordTokenKey`);\n    data[tokenKey] = this.route.snapshot.queryParams[tokenKey];\n    return this.http.request(method, url, {\n      body: data,\n      observe: 'response'\n    }).pipe(map(res => {\n      if (this.getOption(`${module}.alwaysFail`)) {\n        throw this.createFailResponse();\n      }\n\n      return res;\n    }), map(res => {\n      return new NbAuthResult(true, res, this.getOption(`${module}.redirect.success`), [], this.getOption('messages.getter')(module, res, this.options));\n    }), catchError(res => {\n      return this.handleResponseError(res, module);\n    }));\n  }\n\n  logout() {\n    const module = 'logout';\n    const method = this.getOption(`${module}.method`);\n    const url = this.getActionEndpoint(module);\n    return of({}).pipe(switchMap(res => {\n      if (!url) {\n        return of(res);\n      }\n\n      return this.http.request(method, url, {\n        observe: 'response'\n      });\n    }), map(res => {\n      if (this.getOption(`${module}.alwaysFail`)) {\n        throw this.createFailResponse();\n      }\n\n      return res;\n    }), map(res => {\n      return new NbAuthResult(true, res, this.getOption(`${module}.redirect.success`), [], this.getOption('messages.getter')(module, res, this.options));\n    }), catchError(res => {\n      return this.handleResponseError(res, module);\n    }));\n  }\n\n  refreshToken(data) {\n    const module = 'refreshToken';\n    const method = this.getOption(`${module}.method`);\n    const url = this.getActionEndpoint(module);\n    const requireValidToken = this.getOption(`${module}.requireValidToken`);\n    return this.http.request(method, url, {\n      body: data,\n      observe: 'response'\n    }).pipe(map(res => {\n      if (this.getOption(`${module}.alwaysFail`)) {\n        throw this.createFailResponse(data);\n      }\n\n      return res;\n    }), map(res => {\n      return new NbAuthResult(true, res, this.getOption(`${module}.redirect.success`), [], this.getOption('messages.getter')(module, res, this.options), this.createToken(this.getOption('token.getter')(module, res, this.options), requireValidToken));\n    }), catchError(res => {\n      return this.handleResponseError(res, module);\n    }));\n  }\n\n  handleResponseError(res, module) {\n    let errors = [];\n\n    if (res instanceof HttpErrorResponse) {\n      errors = this.getOption('errors.getter')(module, res, this.options);\n    } else if (res instanceof NbAuthIllegalTokenError) {\n      errors.push(res.message);\n    } else {\n      errors.push('Something went wrong.');\n    }\n\n    return of(new NbAuthResult(false, res, this.getOption(`${module}.redirect.failure`), errors));\n  }\n\n};\n\nNbPasswordAuthStrategy.ɵfac = function NbPasswordAuthStrategy_Factory(t) {\n  return new (t || NbPasswordAuthStrategy)(ɵngcc0.ɵɵinject(ɵngcc1.HttpClient), ɵngcc0.ɵɵinject(ɵngcc2.ActivatedRoute));\n};\n\nNbPasswordAuthStrategy.ɵprov = /*@__PURE__*/ɵngcc0.ɵɵdefineInjectable({\n  token: NbPasswordAuthStrategy,\n  factory: function (t) {\n    return NbPasswordAuthStrategy.ɵfac(t);\n  }\n});\nNbPasswordAuthStrategy = NbPasswordAuthStrategy_1 = __decorate$7([__metadata$5(\"design:paramtypes\", [HttpClient, ActivatedRoute])], NbPasswordAuthStrategy);\n\nvar __decorate$8 = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nvar __metadata$6 = this && this.__metadata || function (k, v) {\n  if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\n/**\n * @license\n * Copyright Akveo. All Rights Reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n */\n\n\nlet NbAuthComponent = /*#__PURE__*/(() => {\n  let NbAuthComponent = class NbAuthComponent {\n    // showcase of how to use the onAuthenticationChange method\n    constructor(auth, location) {\n      this.auth = auth;\n      this.location = location;\n      this.alive = true;\n      this.authenticated = false;\n      this.token = '';\n      this.subscription = auth.onAuthenticationChange().pipe(takeWhile(() => this.alive)).subscribe(authenticated => {\n        this.authenticated = authenticated;\n      });\n    }\n\n    back() {\n      this.location.back();\n      return false;\n    }\n\n    ngOnDestroy() {\n      this.alive = false;\n    }\n\n  };\n\n  NbAuthComponent.ɵfac = function NbAuthComponent_Factory(t) {\n    return new (t || NbAuthComponent)(ɵngcc0.ɵɵdirectiveInject(NbAuthService), ɵngcc0.ɵɵdirectiveInject(ɵngcc3.Location));\n  };\n\n  NbAuthComponent.ɵcmp = /*@__PURE__*/ɵngcc0.ɵɵdefineComponent({\n    type: NbAuthComponent,\n    selectors: [[\"nb-auth\"]],\n    decls: 10,\n    vars: 0,\n    consts: [[1, \"navigation\"], [\"href\", \"#\", \"aria-label\", \"Back\", 1, \"link\", \"back-link\", 3, \"click\"], [\"icon\", \"arrow-back\"]],\n    template: function NbAuthComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        ɵngcc0.ɵɵelementStart(0, \"nb-layout\")(1, \"nb-layout-column\")(2, \"nb-card\")(3, \"nb-card-header\")(4, \"nav\", 0)(5, \"a\", 1);\n        ɵngcc0.ɵɵlistener(\"click\", function NbAuthComponent_Template_a_click_5_listener() {\n          return ctx.back();\n        });\n        ɵngcc0.ɵɵelement(6, \"nb-icon\", 2);\n        ɵngcc0.ɵɵelementEnd()()();\n        ɵngcc0.ɵɵelementStart(7, \"nb-card-body\")(8, \"nb-auth-block\");\n        ɵngcc0.ɵɵelement(9, \"router-outlet\");\n        ɵngcc0.ɵɵelementEnd()()()()();\n      }\n    },\n    directives: function () {\n      return [ɵngcc4.NbLayoutComponent, ɵngcc4.NbLayoutColumnComponent, ɵngcc4.NbCardComponent, ɵngcc4.NbCardHeaderComponent, ɵngcc4.NbIconComponent, ɵngcc4.NbCardBodyComponent, NbAuthBlockComponent, ɵngcc2.RouterOutlet];\n    },\n    styles: [\"[_nghost-%COMP%]   nb-card[_ngcontent-%COMP%]{margin:0;height:calc(100vh - 2 * 2.5rem)}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]{display:inline-block;text-decoration:none}[_nghost-%COMP%]   .navigation[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]   nb-icon[_ngcontent-%COMP%]{font-size:2rem;vertical-align:middle}[_nghost-%COMP%]   .links[_ngcontent-%COMP%]   nb-icon[_ngcontent-%COMP%]{font-size:2.5rem}[_nghost-%COMP%]   nb-card-body[_ngcontent-%COMP%]{display:flex;width:100%}[_nghost-%COMP%]   nb-auth-block[_ngcontent-%COMP%]{margin:auto}@media (max-width: 767.98px){[_nghost-%COMP%]   nb-card[_ngcontent-%COMP%]{border-radius:0;height:100vh}}[_nghost-%COMP%]     nb-layout .layout .layout-container .content .columns nb-layout-column{padding:2.5rem}@media (max-width: 767.98px){[_nghost-%COMP%]     nb-layout .layout .layout-container .content .columns nb-layout-column{padding:0}}\"]\n  });\n  return NbAuthComponent;\n})();\nNbAuthComponent = __decorate$8([__metadata$6(\"design:paramtypes\", [NbAuthService, Location])], NbAuthComponent);\n/**\n * @license\n * Copyright Akveo. All Rights Reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n */\n\nvar __decorate$9 = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nlet NbAuthBlockComponent = /*#__PURE__*/(() => {\n  let NbAuthBlockComponent = class NbAuthBlockComponent {};\n\n  NbAuthBlockComponent.ɵfac = function NbAuthBlockComponent_Factory(t) {\n    return new (t || NbAuthBlockComponent)();\n  };\n\n  NbAuthBlockComponent.ɵcmp = /*@__PURE__*/ɵngcc0.ɵɵdefineComponent({\n    type: NbAuthBlockComponent,\n    selectors: [[\"nb-auth-block\"]],\n    ngContentSelectors: _c0,\n    decls: 1,\n    vars: 0,\n    template: function NbAuthBlockComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        ɵngcc0.ɵɵprojectionDef();\n        ɵngcc0.ɵɵprojection(0);\n      }\n    },\n    styles: [\"[_nghost-%COMP%]{display:block;width:100%;max-width:35rem}[_nghost-%COMP%]     form{width:100%}[_nghost-%COMP%]     .label{display:block;margin-bottom:0.5rem}[_nghost-%COMP%]     .forgot-password{text-decoration:none;margin-bottom:0.5rem}[_nghost-%COMP%]     .caption{margin-top:0.5rem}[_nghost-%COMP%]     .alert{text-align:center}[_nghost-%COMP%]     .title{margin-top:0;margin-bottom:0.75rem;text-align:center}[_nghost-%COMP%]     .sub-title{margin-bottom:2rem;text-align:center}[_nghost-%COMP%]     .form-control-group{margin-bottom:2rem}[_nghost-%COMP%]     .form-control-group.accept-group{display:flex;justify-content:space-between;margin:2rem 0}[_nghost-%COMP%]     .label-with-link{display:flex;justify-content:space-between}[_nghost-%COMP%]     .links{text-align:center;margin-top:1.75rem}[_nghost-%COMP%]     .links .socials{margin-top:1.5rem}[_nghost-%COMP%]     .links .socials a{margin:0 1rem;text-decoration:none;vertical-align:middle}[_nghost-%COMP%]     .links .socials a.with-icon{font-size:2rem}[_nghost-%COMP%]     .another-action{margin-top:2rem;text-align:center}[_nghost-%COMP%]     .sign-in-or-up{margin-top:2rem;display:flex;justify-content:space-between}[_nghost-%COMP%]     nb-alert .alert-title, [_nghost-%COMP%]     nb-alert .alert-message{margin:0 0 0.5rem}[_nghost-%COMP%]     nb-alert .alert-message-list{list-style-type:none;padding:0;margin:0}\"]\n  });\n  return NbAuthBlockComponent;\n})();\n\nvar __decorate$10 = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nvar __metadata$7 = this && this.__metadata || function (k, v) {\n  if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\n\nvar __param$3 = this && this.__param || function (paramIndex, decorator) {\n  return function (target, key) {\n    decorator(target, key, paramIndex);\n  };\n};\n/**\n * @license\n * Copyright Akveo. All Rights Reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n */\n\n\nlet NbLoginComponent = /*#__PURE__*/(() => {\n  let NbLoginComponent = class NbLoginComponent {\n    constructor(service, options = {}, cd, router) {\n      this.service = service;\n      this.options = options;\n      this.cd = cd;\n      this.router = router;\n      this.redirectDelay = 0;\n      this.showMessages = {};\n      this.strategy = '';\n      this.errors = [];\n      this.messages = [];\n      this.user = {};\n      this.submitted = false;\n      this.socialLinks = [];\n      this.rememberMe = false;\n      this.redirectDelay = this.getConfigValue('forms.login.redirectDelay');\n      this.showMessages = this.getConfigValue('forms.login.showMessages');\n      this.strategy = this.getConfigValue('forms.login.strategy');\n      this.socialLinks = this.getConfigValue('forms.login.socialLinks');\n      this.rememberMe = this.getConfigValue('forms.login.rememberMe');\n    }\n\n    login() {\n      this.errors = [];\n      this.messages = [];\n      this.submitted = true;\n      this.service.authenticate(this.strategy, this.user).subscribe(result => {\n        this.submitted = false;\n\n        if (result.isSuccess()) {\n          this.messages = result.getMessages();\n        } else {\n          this.errors = result.getErrors();\n        }\n\n        const redirect = result.getRedirect();\n\n        if (redirect) {\n          setTimeout(() => {\n            return this.router.navigateByUrl(redirect);\n          }, this.redirectDelay);\n        }\n\n        this.cd.detectChanges();\n      });\n    }\n\n    getConfigValue(key) {\n      return getDeepFromObject(this.options, key, null);\n    }\n\n  };\n\n  NbLoginComponent.ɵfac = function NbLoginComponent_Factory(t) {\n    return new (t || NbLoginComponent)(ɵngcc0.ɵɵdirectiveInject(NbAuthService), ɵngcc0.ɵɵdirectiveInject(NB_AUTH_OPTIONS), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ChangeDetectorRef), ɵngcc0.ɵɵdirectiveInject(ɵngcc2.Router));\n  };\n\n  NbLoginComponent.ɵcmp = /*@__PURE__*/ɵngcc0.ɵɵdefineComponent({\n    type: NbLoginComponent,\n    selectors: [[\"nb-login\"]],\n    decls: 32,\n    vars: 19,\n    consts: [[\"id\", \"title\", 1, \"title\"], [1, \"sub-title\"], [\"outline\", \"danger\", \"role\", \"alert\", 4, \"ngIf\"], [\"outline\", \"success\", \"role\", \"alert\", 4, \"ngIf\"], [\"aria-labelledby\", \"title\", 3, \"ngSubmit\"], [\"form\", \"ngForm\"], [1, \"form-control-group\"], [\"for\", \"input-email\", 1, \"label\"], [\"nbInput\", \"\", \"fullWidth\", \"\", \"name\", \"email\", \"id\", \"input-email\", \"pattern\", \".+@.+\\\\..+\", \"placeholder\", \"Email address\", \"fieldSize\", \"large\", \"autofocus\", \"\", 3, \"ngModel\", \"status\", \"required\", \"ngModelChange\"], [\"email\", \"ngModel\"], [4, \"ngIf\"], [1, \"label-with-link\"], [\"for\", \"input-password\", 1, \"label\"], [\"routerLink\", \"../request-password\", 1, \"forgot-password\", \"caption-2\"], [\"nbInput\", \"\", \"fullWidth\", \"\", \"name\", \"password\", \"type\", \"password\", \"id\", \"input-password\", \"placeholder\", \"Password\", \"fieldSize\", \"large\", 3, \"ngModel\", \"status\", \"required\", \"minlength\", \"maxlength\", \"ngModelChange\"], [\"password\", \"ngModel\"], [1, \"form-control-group\", \"accept-group\"], [\"name\", \"rememberMe\", 3, \"ngModel\", \"ngModelChange\", 4, \"ngIf\"], [\"nbButton\", \"\", \"fullWidth\", \"\", \"status\", \"primary\", \"size\", \"large\", 3, \"disabled\"], [\"class\", \"links\", \"aria-label\", \"Social sign in\", 4, \"ngIf\"], [\"aria-label\", \"Register\", 1, \"another-action\"], [\"routerLink\", \"../register\", 1, \"text-link\"], [\"outline\", \"danger\", \"role\", \"alert\"], [1, \"alert-title\"], [1, \"alert-message-list\"], [\"class\", \"alert-message\", 4, \"ngFor\", \"ngForOf\"], [1, \"alert-message\"], [\"outline\", \"success\", \"role\", \"alert\"], [\"class\", \"caption status-danger\", 4, \"ngIf\"], [1, \"caption\", \"status-danger\"], [\"name\", \"rememberMe\", 3, \"ngModel\", \"ngModelChange\"], [\"aria-label\", \"Social sign in\", 1, \"links\"], [1, \"socials\"], [4, \"ngFor\", \"ngForOf\"], [3, \"routerLink\", \"with-icon\", 4, \"ngIf\"], [3, \"with-icon\", 4, \"ngIf\"], [3, \"routerLink\"], [3, \"icon\", 4, \"ngIf\", \"ngIfElse\"], [\"title\", \"\"], [3, \"icon\"]],\n    template: function NbLoginComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        ɵngcc0.ɵɵelementStart(0, \"h1\", 0);\n        ɵngcc0.ɵɵtext(1, \"Login\");\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementStart(2, \"p\", 1);\n        ɵngcc0.ɵɵtext(3, \"Hello! Log in with your email.\");\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵtemplate(4, NbLoginComponent_nb_alert_4_Template, 6, 1, \"nb-alert\", 2);\n        ɵngcc0.ɵɵtemplate(5, NbLoginComponent_nb_alert_5_Template, 6, 1, \"nb-alert\", 3);\n        ɵngcc0.ɵɵelementStart(6, \"form\", 4, 5);\n        ɵngcc0.ɵɵlistener(\"ngSubmit\", function NbLoginComponent_Template_form_ngSubmit_6_listener() {\n          return ctx.login();\n        });\n        ɵngcc0.ɵɵelementStart(8, \"div\", 6)(9, \"label\", 7);\n        ɵngcc0.ɵɵtext(10, \"Email address:\");\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementStart(11, \"input\", 8, 9);\n        ɵngcc0.ɵɵlistener(\"ngModelChange\", function NbLoginComponent_Template_input_ngModelChange_11_listener($event) {\n          return ctx.user.email = $event;\n        });\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵtemplate(13, NbLoginComponent_ng_container_13_Template, 3, 2, \"ng-container\", 10);\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementStart(14, \"div\", 6)(15, \"span\", 11)(16, \"label\", 12);\n        ɵngcc0.ɵɵtext(17, \"Password:\");\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementStart(18, \"a\", 13);\n        ɵngcc0.ɵɵtext(19, \"Forgot Password?\");\n        ɵngcc0.ɵɵelementEnd()();\n        ɵngcc0.ɵɵelementStart(20, \"input\", 14, 15);\n        ɵngcc0.ɵɵlistener(\"ngModelChange\", function NbLoginComponent_Template_input_ngModelChange_20_listener($event) {\n          return ctx.user.password = $event;\n        });\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵtemplate(22, NbLoginComponent_ng_container_22_Template, 3, 2, \"ng-container\", 10);\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementStart(23, \"div\", 16);\n        ɵngcc0.ɵɵtemplate(24, NbLoginComponent_nb_checkbox_24_Template, 2, 1, \"nb-checkbox\", 17);\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementStart(25, \"button\", 18);\n        ɵngcc0.ɵɵtext(26, \" Log In \");\n        ɵngcc0.ɵɵelementEnd()();\n        ɵngcc0.ɵɵtemplate(27, NbLoginComponent_section_27_Template, 4, 1, \"section\", 19);\n        ɵngcc0.ɵɵelementStart(28, \"section\", 20);\n        ɵngcc0.ɵɵtext(29, \" Don't have an account? \");\n        ɵngcc0.ɵɵelementStart(30, \"a\", 21);\n        ɵngcc0.ɵɵtext(31, \"Register\");\n        ɵngcc0.ɵɵelementEnd()();\n      }\n\n      if (rf & 2) {\n        const _r2 = ɵngcc0.ɵɵreference(7);\n\n        const _r3 = ɵngcc0.ɵɵreference(12);\n\n        const _r5 = ɵngcc0.ɵɵreference(21);\n\n        ɵngcc0.ɵɵadvance(4);\n        ɵngcc0.ɵɵproperty(\"ngIf\", ctx.showMessages.error && (ctx.errors == null ? null : ctx.errors.length) && !ctx.submitted);\n        ɵngcc0.ɵɵadvance(1);\n        ɵngcc0.ɵɵproperty(\"ngIf\", ctx.showMessages.success && (ctx.messages == null ? null : ctx.messages.length) && !ctx.submitted);\n        ɵngcc0.ɵɵadvance(6);\n        ɵngcc0.ɵɵproperty(\"ngModel\", ctx.user.email)(\"status\", _r3.dirty ? _r3.invalid ? \"danger\" : \"success\" : \"\")(\"required\", ctx.getConfigValue(\"forms.validation.email.required\"));\n        ɵngcc0.ɵɵattribute(\"aria-invalid\", _r3.invalid && _r3.touched ? true : null);\n        ɵngcc0.ɵɵadvance(2);\n        ɵngcc0.ɵɵproperty(\"ngIf\", _r3.invalid && _r3.touched);\n        ɵngcc0.ɵɵadvance(7);\n        ɵngcc0.ɵɵproperty(\"ngModel\", ctx.user.password)(\"status\", _r5.dirty ? _r5.invalid ? \"danger\" : \"success\" : \"\")(\"required\", ctx.getConfigValue(\"forms.validation.password.required\"))(\"minlength\", ctx.getConfigValue(\"forms.validation.password.minLength\"))(\"maxlength\", ctx.getConfigValue(\"forms.validation.password.maxLength\"));\n        ɵngcc0.ɵɵattribute(\"aria-invalid\", _r5.invalid && _r5.touched ? true : null);\n        ɵngcc0.ɵɵadvance(2);\n        ɵngcc0.ɵɵproperty(\"ngIf\", _r5.invalid && _r5.touched);\n        ɵngcc0.ɵɵadvance(2);\n        ɵngcc0.ɵɵproperty(\"ngIf\", ctx.rememberMe);\n        ɵngcc0.ɵɵadvance(1);\n        ɵngcc0.ɵɵclassProp(\"btn-pulse\", ctx.submitted);\n        ɵngcc0.ɵɵproperty(\"disabled\", ctx.submitted || !_r2.valid);\n        ɵngcc0.ɵɵadvance(2);\n        ɵngcc0.ɵɵproperty(\"ngIf\", ctx.socialLinks && ctx.socialLinks.length > 0);\n      }\n    },\n    directives: [ɵngcc3.NgIf, ɵngcc4.NbAlertComponent, ɵngcc3.NgForOf, ɵngcc5.ɵNgNoValidate, ɵngcc5.NgControlStatusGroup, ɵngcc5.NgForm, ɵngcc4.NbInputDirective, ɵngcc5.DefaultValueAccessor, ɵngcc5.PatternValidator, ɵngcc5.NgControlStatus, ɵngcc5.NgModel, ɵngcc5.RequiredValidator, ɵngcc2.RouterLinkWithHref, ɵngcc5.MinLengthValidator, ɵngcc5.MaxLengthValidator, ɵngcc4.NbCheckboxComponent, ɵngcc4.NbButtonComponent, ɵngcc4.NbIconComponent],\n    encapsulation: 2,\n    changeDetection: 0\n  });\n  return NbLoginComponent;\n})();\nNbLoginComponent = __decorate$10([__param$3(1, Inject(NB_AUTH_OPTIONS)), __metadata$7(\"design:paramtypes\", [NbAuthService, Object, ChangeDetectorRef, Router])], NbLoginComponent);\n\nvar __decorate$11 = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nvar __metadata$8 = this && this.__metadata || function (k, v) {\n  if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\n\nvar __param$4 = this && this.__param || function (paramIndex, decorator) {\n  return function (target, key) {\n    decorator(target, key, paramIndex);\n  };\n};\n/**\n * @license\n * Copyright Akveo. All Rights Reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n */\n\n\nlet NbRegisterComponent = /*#__PURE__*/(() => {\n  let NbRegisterComponent = class NbRegisterComponent {\n    constructor(service, options = {}, cd, router) {\n      this.service = service;\n      this.options = options;\n      this.cd = cd;\n      this.router = router;\n      this.redirectDelay = 0;\n      this.showMessages = {};\n      this.strategy = '';\n      this.submitted = false;\n      this.errors = [];\n      this.messages = [];\n      this.user = {};\n      this.socialLinks = [];\n      this.redirectDelay = this.getConfigValue('forms.register.redirectDelay');\n      this.showMessages = this.getConfigValue('forms.register.showMessages');\n      this.strategy = this.getConfigValue('forms.register.strategy');\n      this.socialLinks = this.getConfigValue('forms.login.socialLinks');\n    }\n\n    register() {\n      this.errors = this.messages = [];\n      this.submitted = true;\n      this.service.register(this.strategy, this.user).subscribe(result => {\n        this.submitted = false;\n\n        if (result.isSuccess()) {\n          this.messages = result.getMessages();\n        } else {\n          this.errors = result.getErrors();\n        }\n\n        const redirect = result.getRedirect();\n\n        if (redirect) {\n          setTimeout(() => {\n            return this.router.navigateByUrl(redirect);\n          }, this.redirectDelay);\n        }\n\n        this.cd.detectChanges();\n      });\n    }\n\n    getConfigValue(key) {\n      return getDeepFromObject(this.options, key, null);\n    }\n\n  };\n\n  NbRegisterComponent.ɵfac = function NbRegisterComponent_Factory(t) {\n    return new (t || NbRegisterComponent)(ɵngcc0.ɵɵdirectiveInject(NbAuthService), ɵngcc0.ɵɵdirectiveInject(NB_AUTH_OPTIONS), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ChangeDetectorRef), ɵngcc0.ɵɵdirectiveInject(ɵngcc2.Router));\n  };\n\n  NbRegisterComponent.ɵcmp = /*@__PURE__*/ɵngcc0.ɵɵdefineComponent({\n    type: NbRegisterComponent,\n    selectors: [[\"nb-register\"]],\n    decls: 38,\n    vars: 31,\n    consts: [[\"id\", \"title\", 1, \"title\"], [\"outline\", \"danger\", \"role\", \"alert\", 4, \"ngIf\"], [\"outline\", \"success\", \"role\", \"alert\", 4, \"ngIf\"], [\"aria-labelledby\", \"title\", 3, \"ngSubmit\"], [\"form\", \"ngForm\"], [1, \"form-control-group\"], [\"for\", \"input-name\", 1, \"label\"], [\"nbInput\", \"\", \"id\", \"input-name\", \"name\", \"fullName\", \"placeholder\", \"Full name\", \"autofocus\", \"\", \"fullWidth\", \"\", \"fieldSize\", \"large\", 3, \"ngModel\", \"status\", \"required\", \"minlength\", \"maxlength\", \"ngModelChange\"], [\"fullName\", \"ngModel\"], [4, \"ngIf\"], [\"for\", \"input-email\", 1, \"label\"], [\"nbInput\", \"\", \"id\", \"input-email\", \"name\", \"email\", \"pattern\", \".+@.+..+\", \"placeholder\", \"Email address\", \"fullWidth\", \"\", \"fieldSize\", \"large\", 3, \"ngModel\", \"status\", \"required\", \"ngModelChange\"], [\"email\", \"ngModel\"], [\"for\", \"input-password\", 1, \"label\"], [\"nbInput\", \"\", \"type\", \"password\", \"id\", \"input-password\", \"name\", \"password\", \"placeholder\", \"Password\", \"fullWidth\", \"\", \"fieldSize\", \"large\", 3, \"ngModel\", \"status\", \"required\", \"minlength\", \"maxlength\", \"ngModelChange\"], [\"password\", \"ngModel\"], [\"for\", \"input-re-password\", 1, \"label\"], [\"nbInput\", \"\", \"type\", \"password\", \"id\", \"input-re-password\", \"name\", \"rePass\", \"placeholder\", \"Confirm Password\", \"fullWidth\", \"\", \"fieldSize\", \"large\", 3, \"ngModel\", \"status\", \"required\", \"ngModelChange\"], [\"rePass\", \"ngModel\"], [\"class\", \"form-control-group accept-group\", 4, \"ngIf\"], [\"nbButton\", \"\", \"fullWidth\", \"\", \"status\", \"primary\", \"size\", \"large\", 3, \"disabled\"], [\"class\", \"links\", \"aria-label\", \"Social sign in\", 4, \"ngIf\"], [\"aria-label\", \"Sign in\", 1, \"another-action\"], [\"routerLink\", \"../login\", 1, \"text-link\"], [\"outline\", \"danger\", \"role\", \"alert\"], [1, \"alert-title\"], [1, \"alert-message-list\"], [\"class\", \"alert-message\", 4, \"ngFor\", \"ngForOf\"], [1, \"alert-message\"], [\"outline\", \"success\", \"role\", \"alert\"], [\"class\", \"caption status-danger\", 4, \"ngIf\"], [1, \"caption\", \"status-danger\"], [1, \"form-control-group\", \"accept-group\"], [\"name\", \"terms\", 3, \"ngModel\", \"required\", \"ngModelChange\"], [\"href\", \"#\", \"target\", \"_blank\"], [\"aria-label\", \"Social sign in\", 1, \"links\"], [1, \"socials\"], [4, \"ngFor\", \"ngForOf\"], [3, \"routerLink\", \"with-icon\", 4, \"ngIf\"], [3, \"with-icon\", 4, \"ngIf\"], [3, \"routerLink\"], [3, \"icon\", 4, \"ngIf\", \"ngIfElse\"], [\"title\", \"\"], [3, \"icon\"]],\n    template: function NbRegisterComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        ɵngcc0.ɵɵelementStart(0, \"h1\", 0);\n        ɵngcc0.ɵɵtext(1, \"Register\");\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵtemplate(2, NbRegisterComponent_nb_alert_2_Template, 6, 1, \"nb-alert\", 1);\n        ɵngcc0.ɵɵtemplate(3, NbRegisterComponent_nb_alert_3_Template, 6, 1, \"nb-alert\", 2);\n        ɵngcc0.ɵɵelementStart(4, \"form\", 3, 4);\n        ɵngcc0.ɵɵlistener(\"ngSubmit\", function NbRegisterComponent_Template_form_ngSubmit_4_listener() {\n          return ctx.register();\n        });\n        ɵngcc0.ɵɵelementStart(6, \"div\", 5)(7, \"label\", 6);\n        ɵngcc0.ɵɵtext(8, \"Full name:\");\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementStart(9, \"input\", 7, 8);\n        ɵngcc0.ɵɵlistener(\"ngModelChange\", function NbRegisterComponent_Template_input_ngModelChange_9_listener($event) {\n          return ctx.user.fullName = $event;\n        });\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵtemplate(11, NbRegisterComponent_ng_container_11_Template, 3, 2, \"ng-container\", 9);\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementStart(12, \"div\", 5)(13, \"label\", 10);\n        ɵngcc0.ɵɵtext(14, \"Email address:\");\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementStart(15, \"input\", 11, 12);\n        ɵngcc0.ɵɵlistener(\"ngModelChange\", function NbRegisterComponent_Template_input_ngModelChange_15_listener($event) {\n          return ctx.user.email = $event;\n        });\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵtemplate(17, NbRegisterComponent_ng_container_17_Template, 3, 2, \"ng-container\", 9);\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementStart(18, \"div\", 5)(19, \"label\", 13);\n        ɵngcc0.ɵɵtext(20, \"Password:\");\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementStart(21, \"input\", 14, 15);\n        ɵngcc0.ɵɵlistener(\"ngModelChange\", function NbRegisterComponent_Template_input_ngModelChange_21_listener($event) {\n          return ctx.user.password = $event;\n        });\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵtemplate(23, NbRegisterComponent_ng_container_23_Template, 3, 2, \"ng-container\", 9);\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementStart(24, \"div\", 5)(25, \"label\", 16);\n        ɵngcc0.ɵɵtext(26, \"Repeat password:\");\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementStart(27, \"input\", 17, 18);\n        ɵngcc0.ɵɵlistener(\"ngModelChange\", function NbRegisterComponent_Template_input_ngModelChange_27_listener($event) {\n          return ctx.user.confirmPassword = $event;\n        });\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵtemplate(29, NbRegisterComponent_ng_container_29_Template, 3, 2, \"ng-container\", 9);\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵtemplate(30, NbRegisterComponent_div_30_Template, 6, 2, \"div\", 19);\n        ɵngcc0.ɵɵelementStart(31, \"button\", 20);\n        ɵngcc0.ɵɵtext(32, \" Register \");\n        ɵngcc0.ɵɵelementEnd()();\n        ɵngcc0.ɵɵtemplate(33, NbRegisterComponent_section_33_Template, 4, 1, \"section\", 21);\n        ɵngcc0.ɵɵelementStart(34, \"section\", 22);\n        ɵngcc0.ɵɵtext(35, \" Already have an account? \");\n        ɵngcc0.ɵɵelementStart(36, \"a\", 23);\n        ɵngcc0.ɵɵtext(37, \"Log in\");\n        ɵngcc0.ɵɵelementEnd()();\n      }\n\n      if (rf & 2) {\n        const _r2 = ɵngcc0.ɵɵreference(5);\n\n        const _r3 = ɵngcc0.ɵɵreference(10);\n\n        const _r5 = ɵngcc0.ɵɵreference(16);\n\n        const _r7 = ɵngcc0.ɵɵreference(22);\n\n        const _r9 = ɵngcc0.ɵɵreference(28);\n\n        ɵngcc0.ɵɵadvance(2);\n        ɵngcc0.ɵɵproperty(\"ngIf\", ctx.showMessages.error && (ctx.errors == null ? null : ctx.errors.length) && !ctx.submitted);\n        ɵngcc0.ɵɵadvance(1);\n        ɵngcc0.ɵɵproperty(\"ngIf\", ctx.showMessages.success && (ctx.messages == null ? null : ctx.messages.length) && !ctx.submitted);\n        ɵngcc0.ɵɵadvance(6);\n        ɵngcc0.ɵɵproperty(\"ngModel\", ctx.user.fullName)(\"status\", _r3.dirty ? _r3.invalid ? \"danger\" : \"success\" : \"\")(\"required\", ctx.getConfigValue(\"forms.validation.fullName.required\"))(\"minlength\", ctx.getConfigValue(\"forms.validation.fullName.minLength\"))(\"maxlength\", ctx.getConfigValue(\"forms.validation.fullName.maxLength\"));\n        ɵngcc0.ɵɵattribute(\"aria-invalid\", _r3.invalid && _r3.touched ? true : null);\n        ɵngcc0.ɵɵadvance(2);\n        ɵngcc0.ɵɵproperty(\"ngIf\", _r3.invalid && _r3.touched);\n        ɵngcc0.ɵɵadvance(4);\n        ɵngcc0.ɵɵproperty(\"ngModel\", ctx.user.email)(\"status\", _r5.dirty ? _r5.invalid ? \"danger\" : \"success\" : \"\")(\"required\", ctx.getConfigValue(\"forms.validation.email.required\"));\n        ɵngcc0.ɵɵattribute(\"aria-invalid\", _r5.invalid && _r5.touched ? true : null);\n        ɵngcc0.ɵɵadvance(2);\n        ɵngcc0.ɵɵproperty(\"ngIf\", _r5.invalid && _r5.touched);\n        ɵngcc0.ɵɵadvance(4);\n        ɵngcc0.ɵɵproperty(\"ngModel\", ctx.user.password)(\"status\", _r7.dirty ? _r7.invalid ? \"danger\" : \"success\" : \"\")(\"required\", ctx.getConfigValue(\"forms.validation.password.required\"))(\"minlength\", ctx.getConfigValue(\"forms.validation.password.minLength\"))(\"maxlength\", ctx.getConfigValue(\"forms.validation.password.maxLength\"));\n        ɵngcc0.ɵɵattribute(\"aria-invalid\", _r7.invalid && _r7.touched ? true : null);\n        ɵngcc0.ɵɵadvance(2);\n        ɵngcc0.ɵɵproperty(\"ngIf\", _r7.invalid && _r7.touched);\n        ɵngcc0.ɵɵadvance(4);\n        ɵngcc0.ɵɵproperty(\"ngModel\", ctx.user.confirmPassword)(\"status\", _r9.dirty ? _r9.invalid || _r7.value != _r9.value ? \"danger\" : \"success\" : \"\")(\"required\", ctx.getConfigValue(\"forms.validation.password.required\"));\n        ɵngcc0.ɵɵattribute(\"aria-invalid\", _r9.invalid && _r9.touched ? true : null);\n        ɵngcc0.ɵɵadvance(2);\n        ɵngcc0.ɵɵproperty(\"ngIf\", _r9.invalid && _r9.touched);\n        ɵngcc0.ɵɵadvance(1);\n        ɵngcc0.ɵɵproperty(\"ngIf\", ctx.getConfigValue(\"forms.register.terms\"));\n        ɵngcc0.ɵɵadvance(1);\n        ɵngcc0.ɵɵclassProp(\"btn-pulse\", ctx.submitted);\n        ɵngcc0.ɵɵproperty(\"disabled\", ctx.submitted || !_r2.valid);\n        ɵngcc0.ɵɵadvance(2);\n        ɵngcc0.ɵɵproperty(\"ngIf\", ctx.socialLinks && ctx.socialLinks.length > 0);\n      }\n    },\n    directives: [ɵngcc3.NgIf, ɵngcc4.NbAlertComponent, ɵngcc3.NgForOf, ɵngcc5.ɵNgNoValidate, ɵngcc5.NgControlStatusGroup, ɵngcc5.NgForm, ɵngcc4.NbInputDirective, ɵngcc5.DefaultValueAccessor, ɵngcc5.NgControlStatus, ɵngcc5.NgModel, ɵngcc5.RequiredValidator, ɵngcc5.MinLengthValidator, ɵngcc5.MaxLengthValidator, ɵngcc5.PatternValidator, ɵngcc4.NbCheckboxComponent, ɵngcc4.NbButtonComponent, ɵngcc2.RouterLinkWithHref, ɵngcc4.NbIconComponent],\n    styles: [\"[_nghost-%COMP%]   .title[_ngcontent-%COMP%]{margin-bottom:2rem}\"],\n    changeDetection: 0\n  });\n  return NbRegisterComponent;\n})();\nNbRegisterComponent = __decorate$11([__param$4(1, Inject(NB_AUTH_OPTIONS)), __metadata$8(\"design:paramtypes\", [NbAuthService, Object, ChangeDetectorRef, Router])], NbRegisterComponent);\n\nvar __decorate$12 = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nvar __metadata$9 = this && this.__metadata || function (k, v) {\n  if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\n\nvar __param$5 = this && this.__param || function (paramIndex, decorator) {\n  return function (target, key) {\n    decorator(target, key, paramIndex);\n  };\n};\n/**\n * @license\n * Copyright Akveo. All Rights Reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n */\n\n\nlet NbLogoutComponent = /*#__PURE__*/(() => {\n  let NbLogoutComponent = class NbLogoutComponent {\n    constructor(service, options = {}, router) {\n      this.service = service;\n      this.options = options;\n      this.router = router;\n      this.redirectDelay = 0;\n      this.strategy = '';\n      this.redirectDelay = this.getConfigValue('forms.logout.redirectDelay');\n      this.strategy = this.getConfigValue('forms.logout.strategy');\n    }\n\n    ngOnInit() {\n      this.logout(this.strategy);\n    }\n\n    logout(strategy) {\n      this.service.logout(strategy).subscribe(result => {\n        const redirect = result.getRedirect();\n\n        if (redirect) {\n          setTimeout(() => {\n            return this.router.navigateByUrl(redirect);\n          }, this.redirectDelay);\n        }\n      });\n    }\n\n    getConfigValue(key) {\n      return getDeepFromObject(this.options, key, null);\n    }\n\n  };\n\n  NbLogoutComponent.ɵfac = function NbLogoutComponent_Factory(t) {\n    return new (t || NbLogoutComponent)(ɵngcc0.ɵɵdirectiveInject(NbAuthService), ɵngcc0.ɵɵdirectiveInject(NB_AUTH_OPTIONS), ɵngcc0.ɵɵdirectiveInject(ɵngcc2.Router));\n  };\n\n  NbLogoutComponent.ɵcmp = /*@__PURE__*/ɵngcc0.ɵɵdefineComponent({\n    type: NbLogoutComponent,\n    selectors: [[\"nb-logout\"]],\n    decls: 2,\n    vars: 0,\n    template: function NbLogoutComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        ɵngcc0.ɵɵelementStart(0, \"div\");\n        ɵngcc0.ɵɵtext(1, \"Logging out, please wait...\");\n        ɵngcc0.ɵɵelementEnd();\n      }\n    },\n    encapsulation: 2\n  });\n  return NbLogoutComponent;\n})();\nNbLogoutComponent = __decorate$12([__param$5(1, Inject(NB_AUTH_OPTIONS)), __metadata$9(\"design:paramtypes\", [NbAuthService, Object, Router])], NbLogoutComponent);\n\nvar __decorate$13 = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nvar __metadata$10 = this && this.__metadata || function (k, v) {\n  if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\n\nvar __param$6 = this && this.__param || function (paramIndex, decorator) {\n  return function (target, key) {\n    decorator(target, key, paramIndex);\n  };\n};\n/**\n * @license\n * Copyright Akveo. All Rights Reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n */\n\n\nlet NbRequestPasswordComponent = /*#__PURE__*/(() => {\n  let NbRequestPasswordComponent = class NbRequestPasswordComponent {\n    constructor(service, options = {}, cd, router) {\n      this.service = service;\n      this.options = options;\n      this.cd = cd;\n      this.router = router;\n      this.redirectDelay = 0;\n      this.showMessages = {};\n      this.strategy = '';\n      this.submitted = false;\n      this.errors = [];\n      this.messages = [];\n      this.user = {};\n      this.redirectDelay = this.getConfigValue('forms.requestPassword.redirectDelay');\n      this.showMessages = this.getConfigValue('forms.requestPassword.showMessages');\n      this.strategy = this.getConfigValue('forms.requestPassword.strategy');\n    }\n\n    requestPass() {\n      this.errors = this.messages = [];\n      this.submitted = true;\n      this.service.requestPassword(this.strategy, this.user).subscribe(result => {\n        this.submitted = false;\n\n        if (result.isSuccess()) {\n          this.messages = result.getMessages();\n        } else {\n          this.errors = result.getErrors();\n        }\n\n        const redirect = result.getRedirect();\n\n        if (redirect) {\n          setTimeout(() => {\n            return this.router.navigateByUrl(redirect);\n          }, this.redirectDelay);\n        }\n\n        this.cd.detectChanges();\n      });\n    }\n\n    getConfigValue(key) {\n      return getDeepFromObject(this.options, key, null);\n    }\n\n  };\n\n  NbRequestPasswordComponent.ɵfac = function NbRequestPasswordComponent_Factory(t) {\n    return new (t || NbRequestPasswordComponent)(ɵngcc0.ɵɵdirectiveInject(NbAuthService), ɵngcc0.ɵɵdirectiveInject(NB_AUTH_OPTIONS), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ChangeDetectorRef), ɵngcc0.ɵɵdirectiveInject(ɵngcc2.Router));\n  };\n\n  NbRequestPasswordComponent.ɵcmp = /*@__PURE__*/ɵngcc0.ɵɵdefineComponent({\n    type: NbRequestPasswordComponent,\n    selectors: [[\"nb-request-password-page\"]],\n    decls: 23,\n    vars: 10,\n    consts: [[\"id\", \"title\", 1, \"title\"], [1, \"sub-title\"], [\"outline\", \"danger\", \"role\", \"alert\", 4, \"ngIf\"], [\"outline\", \"success\", \"role\", \"alert\", 4, \"ngIf\"], [\"aria-labelledby\", \"title\", 3, \"ngSubmit\"], [\"requestPassForm\", \"ngForm\"], [1, \"form-control-group\"], [\"for\", \"input-email\", 1, \"label\"], [\"nbInput\", \"\", \"id\", \"input-email\", \"name\", \"email\", \"pattern\", \".+@.+\\\\..+\", \"placeholder\", \"Email address\", \"autofocus\", \"\", \"fullWidth\", \"\", \"fieldSize\", \"large\", 3, \"ngModel\", \"status\", \"required\", \"ngModelChange\"], [\"email\", \"ngModel\"], [4, \"ngIf\"], [\"nbButton\", \"\", \"fullWidth\", \"\", \"status\", \"primary\", \"size\", \"large\", 3, \"disabled\"], [\"aria-label\", \"Sign in or sign up\", 1, \"sign-in-or-up\"], [\"routerLink\", \"../login\", 1, \"text-link\"], [\"routerLink\", \"../register\", 1, \"text-link\"], [\"outline\", \"danger\", \"role\", \"alert\"], [1, \"alert-title\"], [1, \"alert-message-list\"], [\"class\", \"alert-message\", 4, \"ngFor\", \"ngForOf\"], [1, \"alert-message\"], [\"outline\", \"success\", \"role\", \"alert\"], [\"class\", \"caption status-danger\", 4, \"ngIf\"], [1, \"caption\", \"status-danger\"]],\n    template: function NbRequestPasswordComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        ɵngcc0.ɵɵelementStart(0, \"h1\", 0);\n        ɵngcc0.ɵɵtext(1, \"Forgot Password\");\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementStart(2, \"p\", 1);\n        ɵngcc0.ɵɵtext(3, \"Enter your email address and we\\u2019ll send a link to reset your password\");\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵtemplate(4, NbRequestPasswordComponent_nb_alert_4_Template, 6, 1, \"nb-alert\", 2);\n        ɵngcc0.ɵɵtemplate(5, NbRequestPasswordComponent_nb_alert_5_Template, 6, 1, \"nb-alert\", 3);\n        ɵngcc0.ɵɵelementStart(6, \"form\", 4, 5);\n        ɵngcc0.ɵɵlistener(\"ngSubmit\", function NbRequestPasswordComponent_Template_form_ngSubmit_6_listener() {\n          return ctx.requestPass();\n        });\n        ɵngcc0.ɵɵelementStart(8, \"div\", 6)(9, \"label\", 7);\n        ɵngcc0.ɵɵtext(10, \"Enter your email address:\");\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementStart(11, \"input\", 8, 9);\n        ɵngcc0.ɵɵlistener(\"ngModelChange\", function NbRequestPasswordComponent_Template_input_ngModelChange_11_listener($event) {\n          return ctx.user.email = $event;\n        });\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵtemplate(13, NbRequestPasswordComponent_ng_container_13_Template, 3, 2, \"ng-container\", 10);\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementStart(14, \"button\", 11);\n        ɵngcc0.ɵɵtext(15, \" Request password \");\n        ɵngcc0.ɵɵelementEnd()();\n        ɵngcc0.ɵɵelementStart(16, \"section\", 12)(17, \"p\")(18, \"a\", 13);\n        ɵngcc0.ɵɵtext(19, \"Back to Log In\");\n        ɵngcc0.ɵɵelementEnd()();\n        ɵngcc0.ɵɵelementStart(20, \"p\")(21, \"a\", 14);\n        ɵngcc0.ɵɵtext(22, \"Register\");\n        ɵngcc0.ɵɵelementEnd()()();\n      }\n\n      if (rf & 2) {\n        const _r2 = ɵngcc0.ɵɵreference(7);\n\n        const _r3 = ɵngcc0.ɵɵreference(12);\n\n        ɵngcc0.ɵɵadvance(4);\n        ɵngcc0.ɵɵproperty(\"ngIf\", ctx.showMessages.error && (ctx.errors == null ? null : ctx.errors.length) && !ctx.submitted);\n        ɵngcc0.ɵɵadvance(1);\n        ɵngcc0.ɵɵproperty(\"ngIf\", ctx.showMessages.success && (ctx.messages == null ? null : ctx.messages.length) && !ctx.submitted);\n        ɵngcc0.ɵɵadvance(6);\n        ɵngcc0.ɵɵproperty(\"ngModel\", ctx.user.email)(\"status\", _r3.dirty ? _r3.invalid ? \"danger\" : \"success\" : \"\")(\"required\", ctx.getConfigValue(\"forms.validation.email.required\"));\n        ɵngcc0.ɵɵattribute(\"aria-invalid\", _r3.invalid && _r3.touched ? true : null);\n        ɵngcc0.ɵɵadvance(2);\n        ɵngcc0.ɵɵproperty(\"ngIf\", _r3.invalid && _r3.touched);\n        ɵngcc0.ɵɵadvance(1);\n        ɵngcc0.ɵɵclassProp(\"btn-pulse\", ctx.submitted);\n        ɵngcc0.ɵɵproperty(\"disabled\", ctx.submitted || !_r2.valid);\n      }\n    },\n    directives: [ɵngcc3.NgIf, ɵngcc4.NbAlertComponent, ɵngcc3.NgForOf, ɵngcc5.ɵNgNoValidate, ɵngcc5.NgControlStatusGroup, ɵngcc5.NgForm, ɵngcc4.NbInputDirective, ɵngcc5.DefaultValueAccessor, ɵngcc5.PatternValidator, ɵngcc5.NgControlStatus, ɵngcc5.NgModel, ɵngcc5.RequiredValidator, ɵngcc4.NbButtonComponent, ɵngcc2.RouterLinkWithHref],\n    styles: [_c1],\n    changeDetection: 0\n  });\n  return NbRequestPasswordComponent;\n})();\nNbRequestPasswordComponent = __decorate$13([__param$6(1, Inject(NB_AUTH_OPTIONS)), __metadata$10(\"design:paramtypes\", [NbAuthService, Object, ChangeDetectorRef, Router])], NbRequestPasswordComponent);\n\nvar __decorate$14 = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nvar __metadata$11 = this && this.__metadata || function (k, v) {\n  if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\n\nvar __param$7 = this && this.__param || function (paramIndex, decorator) {\n  return function (target, key) {\n    decorator(target, key, paramIndex);\n  };\n};\n/**\n * @license\n * Copyright Akveo. All Rights Reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n */\n\n\nlet NbResetPasswordComponent = /*#__PURE__*/(() => {\n  let NbResetPasswordComponent = class NbResetPasswordComponent {\n    constructor(service, options = {}, cd, router) {\n      this.service = service;\n      this.options = options;\n      this.cd = cd;\n      this.router = router;\n      this.redirectDelay = 0;\n      this.showMessages = {};\n      this.strategy = '';\n      this.submitted = false;\n      this.errors = [];\n      this.messages = [];\n      this.user = {};\n      this.redirectDelay = this.getConfigValue('forms.resetPassword.redirectDelay');\n      this.showMessages = this.getConfigValue('forms.resetPassword.showMessages');\n      this.strategy = this.getConfigValue('forms.resetPassword.strategy');\n    }\n\n    resetPass() {\n      this.errors = this.messages = [];\n      this.submitted = true;\n      this.service.resetPassword(this.strategy, this.user).subscribe(result => {\n        this.submitted = false;\n\n        if (result.isSuccess()) {\n          this.messages = result.getMessages();\n        } else {\n          this.errors = result.getErrors();\n        }\n\n        const redirect = result.getRedirect();\n\n        if (redirect) {\n          setTimeout(() => {\n            return this.router.navigateByUrl(redirect);\n          }, this.redirectDelay);\n        }\n\n        this.cd.detectChanges();\n      });\n    }\n\n    getConfigValue(key) {\n      return getDeepFromObject(this.options, key, null);\n    }\n\n  };\n\n  NbResetPasswordComponent.ɵfac = function NbResetPasswordComponent_Factory(t) {\n    return new (t || NbResetPasswordComponent)(ɵngcc0.ɵɵdirectiveInject(NbAuthService), ɵngcc0.ɵɵdirectiveInject(NB_AUTH_OPTIONS), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ChangeDetectorRef), ɵngcc0.ɵɵdirectiveInject(ɵngcc2.Router));\n  };\n\n  NbResetPasswordComponent.ɵcmp = /*@__PURE__*/ɵngcc0.ɵɵdefineComponent({\n    type: NbResetPasswordComponent,\n    selectors: [[\"nb-reset-password-page\"]],\n    decls: 29,\n    vars: 17,\n    consts: [[\"id\", \"title\", 1, \"title\"], [1, \"sub-title\"], [\"outline\", \"danger\", \"role\", \"alert\", 4, \"ngIf\"], [\"outline\", \"success\", \"role\", \"alert\", 4, \"ngIf\"], [\"aria-labelledby\", \"title\", 3, \"ngSubmit\"], [\"resetPassForm\", \"ngForm\"], [1, \"form-control-group\"], [\"for\", \"input-password\", 1, \"label\"], [\"nbInput\", \"\", \"type\", \"password\", \"id\", \"input-password\", \"name\", \"password\", \"placeholder\", \"New Password\", \"autofocus\", \"\", \"fullWidth\", \"\", \"fieldSize\", \"large\", 1, \"first\", 3, \"ngModel\", \"status\", \"required\", \"minlength\", \"maxlength\", \"ngModelChange\"], [\"password\", \"ngModel\"], [4, \"ngIf\"], [1, \"form-group\"], [\"for\", \"input-re-password\", 1, \"label\"], [\"nbInput\", \"\", \"id\", \"input-re-password\", \"name\", \"rePass\", \"type\", \"password\", \"placeholder\", \"Confirm Password\", \"fullWidth\", \"\", \"fieldSize\", \"large\", 1, \"last\", 3, \"ngModel\", \"status\", \"required\", \"ngModelChange\"], [\"rePass\", \"ngModel\"], [\"nbButton\", \"\", \"status\", \"primary\", \"fullWidth\", \"\", \"size\", \"large\", 3, \"disabled\"], [\"aria-label\", \"Sign in or sign up\", 1, \"sign-in-or-up\"], [\"routerLink\", \"../login\", 1, \"text-link\"], [\"routerLink\", \"../register\", 1, \"text-link\"], [\"outline\", \"danger\", \"role\", \"alert\"], [1, \"alert-title\"], [1, \"alert-message-list\"], [\"class\", \"alert-message\", 4, \"ngFor\", \"ngForOf\"], [1, \"alert-message\"], [\"outline\", \"success\", \"role\", \"alert\"], [\"class\", \"caption status-danger\", 4, \"ngIf\"], [1, \"caption\", \"status-danger\"]],\n    template: function NbResetPasswordComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        ɵngcc0.ɵɵelementStart(0, \"h1\", 0);\n        ɵngcc0.ɵɵtext(1, \"Change password\");\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementStart(2, \"p\", 1);\n        ɵngcc0.ɵɵtext(3, \"Please set a new password\");\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵtemplate(4, NbResetPasswordComponent_nb_alert_4_Template, 6, 1, \"nb-alert\", 2);\n        ɵngcc0.ɵɵtemplate(5, NbResetPasswordComponent_nb_alert_5_Template, 6, 1, \"nb-alert\", 3);\n        ɵngcc0.ɵɵelementStart(6, \"form\", 4, 5);\n        ɵngcc0.ɵɵlistener(\"ngSubmit\", function NbResetPasswordComponent_Template_form_ngSubmit_6_listener() {\n          return ctx.resetPass();\n        });\n        ɵngcc0.ɵɵelementStart(8, \"div\", 6)(9, \"label\", 7);\n        ɵngcc0.ɵɵtext(10, \"New Password:\");\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementStart(11, \"input\", 8, 9);\n        ɵngcc0.ɵɵlistener(\"ngModelChange\", function NbResetPasswordComponent_Template_input_ngModelChange_11_listener($event) {\n          return ctx.user.password = $event;\n        });\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵtemplate(13, NbResetPasswordComponent_ng_container_13_Template, 3, 2, \"ng-container\", 10);\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementStart(14, \"div\", 11)(15, \"label\", 12);\n        ɵngcc0.ɵɵtext(16, \"Confirm Password:\");\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementStart(17, \"input\", 13, 14);\n        ɵngcc0.ɵɵlistener(\"ngModelChange\", function NbResetPasswordComponent_Template_input_ngModelChange_17_listener($event) {\n          return ctx.user.confirmPassword = $event;\n        });\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵtemplate(19, NbResetPasswordComponent_ng_container_19_Template, 3, 2, \"ng-container\", 10);\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementStart(20, \"button\", 15);\n        ɵngcc0.ɵɵtext(21, \" Change password \");\n        ɵngcc0.ɵɵelementEnd()();\n        ɵngcc0.ɵɵelementStart(22, \"section\", 16)(23, \"p\")(24, \"a\", 17);\n        ɵngcc0.ɵɵtext(25, \"Back to Log In\");\n        ɵngcc0.ɵɵelementEnd()();\n        ɵngcc0.ɵɵelementStart(26, \"p\")(27, \"a\", 18);\n        ɵngcc0.ɵɵtext(28, \"Register\");\n        ɵngcc0.ɵɵelementEnd()()();\n      }\n\n      if (rf & 2) {\n        const _r2 = ɵngcc0.ɵɵreference(7);\n\n        const _r3 = ɵngcc0.ɵɵreference(12);\n\n        const _r5 = ɵngcc0.ɵɵreference(18);\n\n        ɵngcc0.ɵɵadvance(4);\n        ɵngcc0.ɵɵproperty(\"ngIf\", ctx.showMessages.error && (ctx.errors == null ? null : ctx.errors.length) && !ctx.submitted);\n        ɵngcc0.ɵɵadvance(1);\n        ɵngcc0.ɵɵproperty(\"ngIf\", ctx.showMessages.success && (ctx.messages == null ? null : ctx.messages.length) && !ctx.submitted);\n        ɵngcc0.ɵɵadvance(6);\n        ɵngcc0.ɵɵproperty(\"ngModel\", ctx.user.password)(\"status\", _r3.dirty ? _r3.invalid ? \"danger\" : \"success\" : \"\")(\"required\", ctx.getConfigValue(\"forms.validation.password.required\"))(\"minlength\", ctx.getConfigValue(\"forms.validation.password.minLength\"))(\"maxlength\", ctx.getConfigValue(\"forms.validation.password.maxLength\"));\n        ɵngcc0.ɵɵattribute(\"aria-invalid\", _r3.invalid && _r3.touched ? true : null);\n        ɵngcc0.ɵɵadvance(2);\n        ɵngcc0.ɵɵproperty(\"ngIf\", _r3.invalid && _r3.touched);\n        ɵngcc0.ɵɵadvance(4);\n        ɵngcc0.ɵɵproperty(\"ngModel\", ctx.user.confirmPassword)(\"status\", _r5.touched ? _r5.invalid || _r3.value != _r5.value ? \"danger\" : \"success\" : \"\")(\"required\", ctx.getConfigValue(\"forms.validation.password.required\"));\n        ɵngcc0.ɵɵattribute(\"aria-invalid\", _r5.invalid && _r5.touched ? true : null);\n        ɵngcc0.ɵɵadvance(2);\n        ɵngcc0.ɵɵproperty(\"ngIf\", _r5.touched);\n        ɵngcc0.ɵɵadvance(1);\n        ɵngcc0.ɵɵclassProp(\"btn-pulse\", ctx.submitted);\n        ɵngcc0.ɵɵproperty(\"disabled\", ctx.submitted || !_r2.valid);\n      }\n    },\n    directives: [ɵngcc3.NgIf, ɵngcc4.NbAlertComponent, ɵngcc3.NgForOf, ɵngcc5.ɵNgNoValidate, ɵngcc5.NgControlStatusGroup, ɵngcc5.NgForm, ɵngcc4.NbInputDirective, ɵngcc5.DefaultValueAccessor, ɵngcc5.NgControlStatus, ɵngcc5.NgModel, ɵngcc5.RequiredValidator, ɵngcc5.MinLengthValidator, ɵngcc5.MaxLengthValidator, ɵngcc4.NbButtonComponent, ɵngcc2.RouterLinkWithHref],\n    styles: [_c1],\n    changeDetection: 0\n  });\n  return NbResetPasswordComponent;\n})();\nNbResetPasswordComponent = __decorate$14([__param$7(1, Inject(NB_AUTH_OPTIONS)), __metadata$11(\"design:paramtypes\", [NbAuthService, Object, ChangeDetectorRef, Router])], NbResetPasswordComponent);\n\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nvar NbAuthModule_1;\n\nfunction nbStrategiesFactory(options, injector) {\n  const strategies = [];\n  options.strategies.forEach(([strategyClass, strategyOptions]) => {\n    const strategy = injector.get(strategyClass);\n    strategy.setOptions(strategyOptions);\n    strategies.push(strategy);\n  });\n  return strategies;\n}\n\nfunction nbTokensFactory(strategies) {\n  const tokens = [];\n  strategies.forEach(strategy => {\n    tokens.push(strategy.getOption('token.class'));\n  });\n  return tokens;\n}\n\nfunction nbOptionsFactory(options) {\n  return deepExtend(defaultAuthOptions, options);\n}\n\nfunction nbNoOpInterceptorFilter(req) {\n  return true;\n}\n\nlet NbAuthModule = NbAuthModule_1 = class NbAuthModule {\n  static forRoot(nbAuthOptions) {\n    return {\n      ngModule: NbAuthModule_1,\n      providers: [{\n        provide: NB_AUTH_USER_OPTIONS,\n        useValue: nbAuthOptions\n      }, {\n        provide: NB_AUTH_OPTIONS,\n        useFactory: nbOptionsFactory,\n        deps: [NB_AUTH_USER_OPTIONS]\n      }, {\n        provide: NB_AUTH_STRATEGIES,\n        useFactory: nbStrategiesFactory,\n        deps: [NB_AUTH_OPTIONS, Injector]\n      }, {\n        provide: NB_AUTH_TOKENS,\n        useFactory: nbTokensFactory,\n        deps: [NB_AUTH_STRATEGIES]\n      }, {\n        provide: NB_AUTH_FALLBACK_TOKEN,\n        useValue: NbAuthSimpleToken\n      }, {\n        provide: NB_AUTH_INTERCEPTOR_HEADER,\n        useValue: 'Authorization'\n      }, {\n        provide: NB_AUTH_TOKEN_INTERCEPTOR_FILTER,\n        useValue: nbNoOpInterceptorFilter\n      }, {\n        provide: NbTokenStorage,\n        useClass: NbTokenLocalStorage\n      }, NbAuthTokenParceler, NbAuthService, NbTokenService, NbDummyAuthStrategy, NbPasswordAuthStrategy, NbOAuth2AuthStrategy]\n    };\n  }\n\n};\n\nNbAuthModule.ɵfac = function NbAuthModule_Factory(t) {\n  return new (t || NbAuthModule)();\n};\n\nNbAuthModule.ɵmod = /*@__PURE__*/ɵngcc0.ɵɵdefineNgModule({\n  type: NbAuthModule\n});\nNbAuthModule.ɵinj = /*@__PURE__*/ɵngcc0.ɵɵdefineInjector({\n  imports: [[CommonModule, NbLayoutModule, NbCardModule, NbCheckboxModule, NbAlertModule, NbInputModule, NbButtonModule, RouterModule, FormsModule, NbIconModule]]\n});\nconst routes = [{\n  path: 'auth',\n  component: NbAuthComponent,\n  children: [{\n    path: '',\n    component: NbLoginComponent\n  }, {\n    path: 'login',\n    component: NbLoginComponent\n  }, {\n    path: 'register',\n    component: NbRegisterComponent\n  }, {\n    path: 'logout',\n    component: NbLogoutComponent\n  }, {\n    path: 'request-password',\n    component: NbRequestPasswordComponent\n  }, {\n    path: 'reset-password',\n    component: NbResetPasswordComponent\n  }]\n}];\n\nvar __decorate$15 = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nvar __metadata$12 = this && this.__metadata || function (k, v) {\n  if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\n\nvar __param$8 = this && this.__param || function (paramIndex, decorator) {\n  return function (target, key) {\n    decorator(target, key, paramIndex);\n  };\n};\n\nlet NbAuthJWTInterceptor = /*#__PURE__*/(() => {\n  let NbAuthJWTInterceptor = class NbAuthJWTInterceptor {\n    constructor(injector, filter$$1) {\n      this.injector = injector;\n      this.filter = filter$$1;\n    }\n\n    intercept(req, next) {\n      // do not intercept request whose urls are filtered by the injected filter\n      if (!this.filter(req)) {\n        return this.authService.isAuthenticatedOrRefresh().pipe(switchMap(authenticated => {\n          if (authenticated) {\n            return this.authService.getToken().pipe(switchMap(token => {\n              const JWT = `Bearer ${token.getValue()}`;\n              req = req.clone({\n                setHeaders: {\n                  Authorization: JWT\n                }\n              });\n              return next.handle(req);\n            }));\n          } else {\n            // Request is sent to server without authentication so that the client code\n            // receives the 401/403 error and can act as desired ('session expired', redirect to login, aso)\n            return next.handle(req);\n          }\n        }));\n      } else {\n        return next.handle(req);\n      }\n    }\n\n    get authService() {\n      return this.injector.get(NbAuthService);\n    }\n\n  };\n\n  NbAuthJWTInterceptor.ɵfac = function NbAuthJWTInterceptor_Factory(t) {\n    return new (t || NbAuthJWTInterceptor)(ɵngcc0.ɵɵinject(ɵngcc0.Injector), ɵngcc0.ɵɵinject(NB_AUTH_TOKEN_INTERCEPTOR_FILTER));\n  };\n\n  NbAuthJWTInterceptor.ɵprov = /*@__PURE__*/ɵngcc0.ɵɵdefineInjectable({\n    token: NbAuthJWTInterceptor,\n    factory: function (t) {\n      return NbAuthJWTInterceptor.ɵfac(t);\n    }\n  });\n  return NbAuthJWTInterceptor;\n})();\nNbAuthJWTInterceptor = __decorate$15([__param$8(1, Inject(NB_AUTH_TOKEN_INTERCEPTOR_FILTER)), __metadata$12(\"design:paramtypes\", [Injector, Object])], NbAuthJWTInterceptor);\n\nvar __decorate$16 = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nvar __metadata$13 = this && this.__metadata || function (k, v) {\n  if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\n\nvar __param$9 = this && this.__param || function (paramIndex, decorator) {\n  return function (target, key) {\n    decorator(target, key, paramIndex);\n  };\n};\n\nlet NbAuthSimpleInterceptor = /*#__PURE__*/(() => {\n  let NbAuthSimpleInterceptor = class NbAuthSimpleInterceptor {\n    constructor(injector, headerName = 'Authorization') {\n      this.injector = injector;\n      this.headerName = headerName;\n    }\n\n    intercept(req, next) {\n      return this.authService.getToken().pipe(switchMap(token => {\n        if (token && token.getValue()) {\n          req = req.clone({\n            setHeaders: {\n              [this.headerName]: token.getValue()\n            }\n          });\n        }\n\n        return next.handle(req);\n      }));\n    }\n\n    get authService() {\n      return this.injector.get(NbAuthService);\n    }\n\n  };\n\n  NbAuthSimpleInterceptor.ɵfac = function NbAuthSimpleInterceptor_Factory(t) {\n    return new (t || NbAuthSimpleInterceptor)(ɵngcc0.ɵɵinject(ɵngcc0.Injector), ɵngcc0.ɵɵinject(NB_AUTH_INTERCEPTOR_HEADER));\n  };\n\n  NbAuthSimpleInterceptor.ɵprov = /*@__PURE__*/ɵngcc0.ɵɵdefineInjectable({\n    token: NbAuthSimpleInterceptor,\n    factory: function (t) {\n      return NbAuthSimpleInterceptor.ɵfac(t);\n    }\n  });\n  return NbAuthSimpleInterceptor;\n})();\nNbAuthSimpleInterceptor = __decorate$16([__param$9(1, Inject(NB_AUTH_INTERCEPTOR_HEADER)), __metadata$13(\"design:paramtypes\", [Injector, String])], NbAuthSimpleInterceptor);\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n\n(function () {\n  (typeof ngJitMode === \"undefined\" || ngJitMode) && ɵngcc0.ɵɵsetNgModuleScope(NbAuthModule, {\n    declarations: function () {\n      return [NbAuthComponent, NbAuthBlockComponent, NbLoginComponent, NbRegisterComponent, NbRequestPasswordComponent, NbResetPasswordComponent, NbLogoutComponent];\n    },\n    imports: function () {\n      return [CommonModule, NbLayoutModule, NbCardModule, NbCheckboxModule, NbAlertModule, NbInputModule, NbButtonModule, RouterModule, FormsModule, NbIconModule];\n    },\n    exports: function () {\n      return [NbAuthComponent, NbAuthBlockComponent, NbLoginComponent, NbRegisterComponent, NbRequestPasswordComponent, NbResetPasswordComponent, NbLogoutComponent];\n    }\n  });\n})();\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n\nclass NbUser {\n  constructor(id, email, password, rememberMe, terms, confirmPassword, fullName) {\n    this.id = id;\n    this.email = email;\n    this.password = password;\n    this.rememberMe = rememberMe;\n    this.terms = terms;\n    this.confirmPassword = confirmPassword;\n    this.fullName = fullName;\n  }\n\n}\n/**\n * @license\n * Copyright Akveo. All Rights Reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n */\n\n/**\n * Generated bundle index. Do not edit.\n */\n\n\nexport { defaultAuthOptions, NB_AUTH_OPTIONS, NB_AUTH_USER_OPTIONS, NB_AUTH_STRATEGIES, NB_AUTH_TOKENS, NB_AUTH_INTERCEPTOR_HEADER, NB_AUTH_TOKEN_INTERCEPTOR_FILTER, nbStrategiesFactory, nbTokensFactory, nbOptionsFactory, nbNoOpInterceptorFilter, NbAuthModule, routes, NbAuthComponent, NbAuthBlockComponent, NbLoginComponent, NbLogoutComponent, NbRegisterComponent, NbRequestPasswordComponent, NbResetPasswordComponent, NbAuthService, NbAuthResult, NbAuthJWTInterceptor, NbAuthSimpleInterceptor, NbAuthToken, NbAuthTokenNotFoundError, NbAuthIllegalTokenError, NbAuthEmptyTokenError, NbAuthIllegalJWTTokenError, nbAuthCreateToken, decodeJwtPayload, NbAuthSimpleToken, NbAuthJWTToken, NbAuthOAuth2Token, NbAuthOAuth2JWTToken, ɵ0, NbTokenStorage, NbTokenLocalStorage, NbTokenService, NB_AUTH_FALLBACK_TOKEN, NbAuthTokenParceler, NbAuthStrategy, NbAuthStrategyOptions, NbDummyAuthStrategy, NbDummyAuthStrategyOptions, dummyStrategyOptions, NbPasswordAuthStrategy, NbPasswordAuthStrategyOptions, passwordStrategyOptions, NbOAuth2AuthStrategy, NbOAuth2ResponseType, NbOAuth2GrantType, NbOAuth2ClientAuthMethod, NbOAuth2AuthStrategyOptions, auth2StrategyOptions, NbUser, deepExtend, getDeepFromObject, urlBase64Decode, b64decode, b64DecodeUnicode }; //# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O21LQUFFO0FBQ0Ysb0NBRUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzttS0FBRTtBQUNGLG9DQUVHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O29KQUFFO0FBQ0YsK0JBRUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7aUpBQUU7QUFDRiw4QkFFRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7bUtBR3dCO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7c0tBQUU7QUFDRiw4REFFRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7NEtBQUU7QUFDRixrRUFFRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7eXFDQUFFO0FBQ0YsZ0NBeUJHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7OzswM0NBU3lCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7dWVBQUU7QUFDRixrQ0FNRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OzttaUJBQUU7QUFDRixxQ0FPRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7OzZCQUFFO0FBQ0YsbUNBS0c7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OzBYQUFFO0FBQ0YsNENBT0c7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozt1WkFBRTtBQUNGLDBDQU9HO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7O2NBa0NpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7c0tBQUU7QUFDRixzQ0FFRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzsrS0FBRTtBQUNGLHlDQUVHO0FBQ0g7QUFDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztrQ0FBNEI7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3ksIENoYW5nZURldGVjdG9yUmVmLCBDb21wb25lbnQsIEluamVjdCwgSW5qZWN0YWJsZSwgSW5qZWN0aW9uVG9rZW4sIEluamVjdG9yLCBOZ01vZHVsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgQ29tbW9uTW9kdWxlLCBMb2NhdGlvbiB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbic7XG5pbXBvcnQgeyBBY3RpdmF0ZWRSb3V0ZSwgUm91dGVyLCBSb3V0ZXJNb2R1bGUgfSBmcm9tICdAYW5ndWxhci9yb3V0ZXInO1xuaW1wb3J0IHsgRm9ybXNNb2R1bGUgfSBmcm9tICdAYW5ndWxhci9mb3Jtcyc7XG5pbXBvcnQgeyBOQl9XSU5ET1csIE5iQWxlcnRNb2R1bGUsIE5iQnV0dG9uTW9kdWxlLCBOYkNhcmRNb2R1bGUsIE5iQ2hlY2tib3hNb2R1bGUsIE5iSWNvbk1vZHVsZSwgTmJJbnB1dE1vZHVsZSwgTmJMYXlvdXRNb2R1bGUgfSBmcm9tICdAbmVidWxhci90aGVtZSc7XG5pbXBvcnQgeyBCZWhhdmlvclN1YmplY3QsIG9mIH0gZnJvbSAncnhqcyc7XG5pbXBvcnQgeyBjYXRjaEVycm9yLCBkZWxheSwgZmlsdGVyLCBtYXAsIHNoYXJlLCBzd2l0Y2hNYXAsIHRha2VXaGlsZSB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcbmltcG9ydCB7IEh0dHBDbGllbnQsIEh0dHBFcnJvclJlc3BvbnNlLCBIdHRwSGVhZGVycywgSHR0cFJlc3BvbnNlIH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uL2h0dHAnO1xuXG5jb25zdCBzb2NpYWxMaW5rcyA9IFtdO1xuY29uc3QgZGVmYXVsdEF1dGhPcHRpb25zID0ge1xuICAgIHN0cmF0ZWdpZXM6IFtdLFxuICAgIGZvcm1zOiB7XG4gICAgICAgIGxvZ2luOiB7XG4gICAgICAgICAgICByZWRpcmVjdERlbGF5OiA1MDAsXG4gICAgICAgICAgICBzdHJhdGVneTogJ2VtYWlsJyxcbiAgICAgICAgICAgIHJlbWVtYmVyTWU6IHRydWUsXG4gICAgICAgICAgICBzaG93TWVzc2FnZXM6IHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgICAgIGVycm9yOiB0cnVlLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNvY2lhbExpbmtzOiBzb2NpYWxMaW5rcyxcbiAgICAgICAgfSxcbiAgICAgICAgcmVnaXN0ZXI6IHtcbiAgICAgICAgICAgIHJlZGlyZWN0RGVsYXk6IDUwMCxcbiAgICAgICAgICAgIHN0cmF0ZWd5OiAnZW1haWwnLFxuICAgICAgICAgICAgc2hvd01lc3NhZ2VzOiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogdHJ1ZSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB0ZXJtczogdHJ1ZSxcbiAgICAgICAgICAgIHNvY2lhbExpbmtzOiBzb2NpYWxMaW5rcyxcbiAgICAgICAgfSxcbiAgICAgICAgcmVxdWVzdFBhc3N3b3JkOiB7XG4gICAgICAgICAgICByZWRpcmVjdERlbGF5OiA1MDAsXG4gICAgICAgICAgICBzdHJhdGVneTogJ2VtYWlsJyxcbiAgICAgICAgICAgIHNob3dNZXNzYWdlczoge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgICAgZXJyb3I6IHRydWUsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc29jaWFsTGlua3M6IHNvY2lhbExpbmtzLFxuICAgICAgICB9LFxuICAgICAgICByZXNldFBhc3N3b3JkOiB7XG4gICAgICAgICAgICByZWRpcmVjdERlbGF5OiA1MDAsXG4gICAgICAgICAgICBzdHJhdGVneTogJ2VtYWlsJyxcbiAgICAgICAgICAgIHNob3dNZXNzYWdlczoge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgICAgZXJyb3I6IHRydWUsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc29jaWFsTGlua3M6IHNvY2lhbExpbmtzLFxuICAgICAgICB9LFxuICAgICAgICBsb2dvdXQ6IHtcbiAgICAgICAgICAgIHJlZGlyZWN0RGVsYXk6IDUwMCxcbiAgICAgICAgICAgIHN0cmF0ZWd5OiAnZW1haWwnLFxuICAgICAgICB9LFxuICAgICAgICB2YWxpZGF0aW9uOiB7XG4gICAgICAgICAgICBwYXNzd29yZDoge1xuICAgICAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgICAgICAgIG1pbkxlbmd0aDogNCxcbiAgICAgICAgICAgICAgICBtYXhMZW5ndGg6IDUwLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGVtYWlsOiB7XG4gICAgICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZnVsbE5hbWU6IHtcbiAgICAgICAgICAgICAgICByZXF1aXJlZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgbWluTGVuZ3RoOiA0LFxuICAgICAgICAgICAgICAgIG1heExlbmd0aDogNTAsXG4gICAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgIH0sXG59O1xuY29uc3QgTkJfQVVUSF9PUFRJT05TID0gbmV3IEluamVjdGlvblRva2VuKCdOZWJ1bGFyIEF1dGggT3B0aW9ucycpO1xuY29uc3QgTkJfQVVUSF9VU0VSX09QVElPTlMgPSBuZXcgSW5qZWN0aW9uVG9rZW4oJ05lYnVsYXIgVXNlciBBdXRoIE9wdGlvbnMnKTtcbmNvbnN0IE5CX0FVVEhfU1RSQVRFR0lFUyA9IG5ldyBJbmplY3Rpb25Ub2tlbignTmVidWxhciBBdXRoIFN0cmF0ZWdpZXMnKTtcbmNvbnN0IE5CX0FVVEhfVE9LRU5TID0gbmV3IEluamVjdGlvblRva2VuKCdOZWJ1bGFyIEF1dGggVG9rZW5zJyk7XG5jb25zdCBOQl9BVVRIX0lOVEVSQ0VQVE9SX0hFQURFUiA9IG5ldyBJbmplY3Rpb25Ub2tlbignTmVidWxhciBTaW1wbGUgSW50ZXJjZXB0b3IgSGVhZGVyJyk7XG5jb25zdCBOQl9BVVRIX1RPS0VOX0lOVEVSQ0VQVE9SX0ZJTFRFUiA9IG5ldyBJbmplY3Rpb25Ub2tlbignTmVidWxhciBJbnRlcmNlcHRvciBGaWx0ZXInKTtcblxuLyoqXG4gKiBFeHRlbmRpbmcgb2JqZWN0IHRoYXQgZW50ZXJlZCBpbiBmaXJzdCBhcmd1bWVudC5cbiAqXG4gKiBSZXR1cm5zIGV4dGVuZGVkIG9iamVjdCBvciBmYWxzZSBpZiBoYXZlIG5vIHRhcmdldCBvYmplY3Qgb3IgaW5jb3JyZWN0IHR5cGUuXG4gKlxuICogSWYgeW91IHdpc2ggdG8gY2xvbmUgc291cmNlIG9iamVjdCAod2l0aG91dCBtb2RpZnkgaXQpLCBqdXN0IHVzZSBlbXB0eSBuZXdcbiAqIG9iamVjdCBhcyBmaXJzdCBhcmd1bWVudCwgbGlrZSB0aGlzOlxuICogICBkZWVwRXh0ZW5kKHt9LCB5b3VyT2JqXzEsIFt5b3VyT2JqX05dKTtcbiAqL1xuY29uc3QgZGVlcEV4dGVuZCA9IGZ1bmN0aW9uICguLi5vYmplY3RzKSB7XG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPCAxIHx8IHR5cGVvZiBhcmd1bWVudHNbMF0gIT09ICdvYmplY3QnKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPCAyKSB7XG4gICAgICAgIHJldHVybiBhcmd1bWVudHNbMF07XG4gICAgfVxuICAgIGNvbnN0IHRhcmdldCA9IGFyZ3VtZW50c1swXTtcbiAgICAvLyBjb252ZXJ0IGFyZ3VtZW50cyB0byBhcnJheSBhbmQgY3V0IG9mZiB0YXJnZXQgb2JqZWN0XG4gICAgY29uc3QgYXJncyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMSk7XG4gICAgbGV0IHZhbCwgc3JjO1xuICAgIGFyZ3MuZm9yRWFjaChmdW5jdGlvbiAob2JqKSB7XG4gICAgICAgIC8vIHNraXAgYXJndW1lbnQgaWYgaXQgaXMgYXJyYXkgb3IgaXNuJ3Qgb2JqZWN0XG4gICAgICAgIGlmICh0eXBlb2Ygb2JqICE9PSAnb2JqZWN0JyB8fCBBcnJheS5pc0FycmF5KG9iaikpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBPYmplY3Qua2V5cyhvYmopLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xuICAgICAgICAgICAgc3JjID0gdGFyZ2V0W2tleV07IC8vIHNvdXJjZSB2YWx1ZVxuICAgICAgICAgICAgdmFsID0gb2JqW2tleV07IC8vIG5ldyB2YWx1ZVxuICAgICAgICAgICAgLy8gcmVjdXJzaW9uIHByZXZlbnRpb25cbiAgICAgICAgICAgIGlmICh2YWwgPT09IHRhcmdldCkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgKiBpZiBuZXcgdmFsdWUgaXNuJ3Qgb2JqZWN0IHRoZW4ganVzdCBvdmVyd3JpdGUgYnkgbmV3IHZhbHVlXG4gICAgICAgICAgICAgICAgICogaW5zdGVhZCBvZiBleHRlbmRpbmcuXG4gICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh0eXBlb2YgdmFsICE9PSAnb2JqZWN0JyB8fCB2YWwgPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICB0YXJnZXRba2V5XSA9IHZhbDtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgLy8ganVzdCBjbG9uZSBhcnJheXMgKGFuZCByZWN1cnNpdmUgY2xvbmUgb2JqZWN0cyBpbnNpZGUpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChBcnJheS5pc0FycmF5KHZhbCkpIHtcbiAgICAgICAgICAgICAgICB0YXJnZXRba2V5XSA9IGRlZXBDbG9uZUFycmF5KHZhbCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIC8vIGN1c3RvbSBjbG9uaW5nIGFuZCBvdmVyd3JpdGUgZm9yIHNwZWNpZmljIG9iamVjdHNcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGlzU3BlY2lmaWNWYWx1ZSh2YWwpKSB7XG4gICAgICAgICAgICAgICAgdGFyZ2V0W2tleV0gPSBjbG9uZVNwZWNpZmljVmFsdWUodmFsKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgLy8gb3ZlcndyaXRlIGJ5IG5ldyB2YWx1ZSBpZiBzb3VyY2UgaXNuJ3Qgb2JqZWN0IG9yIGFycmF5XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh0eXBlb2Ygc3JjICE9PSAnb2JqZWN0JyB8fCBzcmMgPT09IG51bGwgfHwgQXJyYXkuaXNBcnJheShzcmMpKSB7XG4gICAgICAgICAgICAgICAgdGFyZ2V0W2tleV0gPSBkZWVwRXh0ZW5kKHt9LCB2YWwpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAvLyBzb3VyY2UgdmFsdWUgYW5kIG5ldyB2YWx1ZSBpcyBvYmplY3RzIGJvdGgsIGV4dGVuZGluZy4uLlxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGFyZ2V0W2tleV0gPSBkZWVwRXh0ZW5kKHNyYywgdmFsKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0pO1xuICAgIHJldHVybiB0YXJnZXQ7XG59O1xuZnVuY3Rpb24gaXNTcGVjaWZpY1ZhbHVlKHZhbCkge1xuICAgIHJldHVybiAodmFsIGluc3RhbmNlb2YgRGF0ZVxuICAgICAgICB8fCB2YWwgaW5zdGFuY2VvZiBSZWdFeHApID8gdHJ1ZSA6IGZhbHNlO1xufVxuZnVuY3Rpb24gY2xvbmVTcGVjaWZpY1ZhbHVlKHZhbCkge1xuICAgIGlmICh2YWwgaW5zdGFuY2VvZiBEYXRlKSB7XG4gICAgICAgIHJldHVybiBuZXcgRGF0ZSh2YWwuZ2V0VGltZSgpKTtcbiAgICB9XG4gICAgZWxzZSBpZiAodmFsIGluc3RhbmNlb2YgUmVnRXhwKSB7XG4gICAgICAgIHJldHVybiBuZXcgUmVnRXhwKHZhbCk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2Nsb25lU3BlY2lmaWNWYWx1ZTogVW5leHBlY3RlZCBzaXR1YXRpb24nKTtcbiAgICB9XG59XG4vKipcbiAqIFJlY3Vyc2l2ZSBjbG9uaW5nIGFycmF5LlxuICovXG5mdW5jdGlvbiBkZWVwQ2xvbmVBcnJheShhcnIpIHtcbiAgICBjb25zdCBjbG9uZSA9IFtdO1xuICAgIGFyci5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtLCBpbmRleCkge1xuICAgICAgICBpZiAodHlwZW9mIGl0ZW0gPT09ICdvYmplY3QnICYmIGl0ZW0gIT09IG51bGwpIHtcbiAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KGl0ZW0pKSB7XG4gICAgICAgICAgICAgICAgY2xvbmVbaW5kZXhdID0gZGVlcENsb25lQXJyYXkoaXRlbSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChpc1NwZWNpZmljVmFsdWUoaXRlbSkpIHtcbiAgICAgICAgICAgICAgICBjbG9uZVtpbmRleF0gPSBjbG9uZVNwZWNpZmljVmFsdWUoaXRlbSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBjbG9uZVtpbmRleF0gPSBkZWVwRXh0ZW5kKHt9LCBpdGVtKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGNsb25lW2luZGV4XSA9IGl0ZW07XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gY2xvbmU7XG59XG4vLyBnZXREZWVwRnJvbU9iamVjdCh7cmVzdWx0OiB7ZGF0YTogMX19LCAncmVzdWx0LmRhdGEnLCAyKTsgLy8gcmV0dXJucyAxXG5mdW5jdGlvbiBnZXREZWVwRnJvbU9iamVjdChvYmplY3QgPSB7fSwgbmFtZSwgZGVmYXVsdFZhbHVlKSB7XG4gICAgY29uc3Qga2V5cyA9IG5hbWUuc3BsaXQoJy4nKTtcbiAgICAvLyBjbG9uZSB0aGUgb2JqZWN0XG4gICAgbGV0IGxldmVsID0gZGVlcEV4dGVuZCh7fSwgb2JqZWN0IHx8IHt9KTtcbiAgICBrZXlzLmZvckVhY2goKGspID0+IHtcbiAgICAgICAgaWYgKGxldmVsICYmIHR5cGVvZiBsZXZlbFtrXSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgIGxldmVsID0gbGV2ZWxba107XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBsZXZlbCA9IHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiB0eXBlb2YgbGV2ZWwgPT09ICd1bmRlZmluZWQnID8gZGVmYXVsdFZhbHVlIDogbGV2ZWw7XG59XG5mdW5jdGlvbiB1cmxCYXNlNjREZWNvZGUoc3RyKSB7XG4gICAgbGV0IG91dHB1dCA9IHN0ci5yZXBsYWNlKC8tL2csICcrJykucmVwbGFjZSgvXy9nLCAnLycpO1xuICAgIHN3aXRjaCAob3V0cHV0Lmxlbmd0aCAlIDQpIHtcbiAgICAgICAgY2FzZSAwOiB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBjYXNlIDI6IHtcbiAgICAgICAgICAgIG91dHB1dCArPSAnPT0nO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAzOiB7XG4gICAgICAgICAgICBvdXRwdXQgKz0gJz0nO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgZGVmYXVsdDoge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbGxlZ2FsIGJhc2U2NHVybCBzdHJpbmchJyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGI2NERlY29kZVVuaWNvZGUob3V0cHV0KTtcbn1cbmZ1bmN0aW9uIGI2NGRlY29kZShzdHIpIHtcbiAgICBjb25zdCBjaGFycyA9ICdBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWmFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6MDEyMzQ1Njc4OSsvPSc7XG4gICAgbGV0IG91dHB1dCA9ICcnO1xuICAgIHN0ciA9IFN0cmluZyhzdHIpLnJlcGxhY2UoLz0rJC8sICcnKTtcbiAgICBpZiAoc3RyLmxlbmd0aCAlIDQgPT09IDEpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGAnYXRvYicgZmFpbGVkOiBUaGUgc3RyaW5nIHRvIGJlIGRlY29kZWQgaXMgbm90IGNvcnJlY3RseSBlbmNvZGVkLmApO1xuICAgIH1cbiAgICBmb3IgKFxuICAgIC8vIGluaXRpYWxpemUgcmVzdWx0IGFuZCBjb3VudGVyc1xuICAgIGxldCBiYyA9IDAsIGJzLCBidWZmZXIsIGlkeCA9IDA7IFxuICAgIC8vIGdldCBuZXh0IGNoYXJhY3RlclxuICAgIGJ1ZmZlciA9IHN0ci5jaGFyQXQoaWR4KyspOyBcbiAgICAvLyBjaGFyYWN0ZXIgZm91bmQgaW4gdGFibGU/IGluaXRpYWxpemUgYml0IHN0b3JhZ2UgYW5kIGFkZCBpdHMgYXNjaWkgdmFsdWU7XG4gICAgfmJ1ZmZlciAmJiAoYnMgPSBiYyAlIDQgPyBicyAqIDY0ICsgYnVmZmVyIDogYnVmZmVyLFxuICAgICAgICAvLyBhbmQgaWYgbm90IGZpcnN0IG9mIGVhY2ggNCBjaGFyYWN0ZXJzLFxuICAgICAgICAvLyBjb252ZXJ0IHRoZSBmaXJzdCA4IGJpdHMgdG8gb25lIGFzY2lpIGNoYXJhY3RlclxuICAgICAgICBiYysrICUgNCkgPyBvdXRwdXQgKz0gU3RyaW5nLmZyb21DaGFyQ29kZSgyNTUgJiBicyA+PiAoLTIgKiBiYyAmIDYpKSA6IDApIHtcbiAgICAgICAgLy8gdHJ5IHRvIGZpbmQgY2hhcmFjdGVyIGluIHRhYmxlICgwLTYzLCBub3QgZm91bmQgPT4gLTEpXG4gICAgICAgIGJ1ZmZlciA9IGNoYXJzLmluZGV4T2YoYnVmZmVyKTtcbiAgICB9XG4gICAgcmV0dXJuIG91dHB1dDtcbn1cbi8vIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuL2RvY3MvV2ViL0FQSS9XaW5kb3dCYXNlNjQvQmFzZTY0X2VuY29kaW5nX2FuZF9kZWNvZGluZyNUaGVfVW5pY29kZV9Qcm9ibGVtXG5mdW5jdGlvbiBiNjREZWNvZGVVbmljb2RlKHN0cikge1xuICAgIHJldHVybiBkZWNvZGVVUklDb21wb25lbnQoQXJyYXkucHJvdG90eXBlLm1hcC5jYWxsKGI2NGRlY29kZShzdHIpLCAoYykgPT4ge1xuICAgICAgICByZXR1cm4gJyUnICsgKCcwMCcgKyBjLmNoYXJDb2RlQXQoMCkudG9TdHJpbmcoMTYpKS5zbGljZSgtMik7XG4gICAgfSkuam9pbignJykpO1xufVxuXG5jbGFzcyBOYkF1dGhUb2tlbiB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMucGF5bG9hZCA9IG51bGw7XG4gICAgfVxuICAgIGdldE5hbWUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbnN0cnVjdG9yLk5BTUU7XG4gICAgfVxuICAgIGdldFBheWxvYWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnBheWxvYWQ7XG4gICAgfVxufVxuY2xhc3MgTmJBdXRoVG9rZW5Ob3RGb3VuZEVycm9yIGV4dGVuZHMgRXJyb3Ige1xuICAgIGNvbnN0cnVjdG9yKG1lc3NhZ2UpIHtcbiAgICAgICAgc3VwZXIobWVzc2FnZSk7XG4gICAgICAgIE9iamVjdC5zZXRQcm90b3R5cGVPZih0aGlzLCBuZXcudGFyZ2V0LnByb3RvdHlwZSk7XG4gICAgfVxufVxuY2xhc3MgTmJBdXRoSWxsZWdhbFRva2VuRXJyb3IgZXh0ZW5kcyBFcnJvciB7XG4gICAgY29uc3RydWN0b3IobWVzc2FnZSkge1xuICAgICAgICBzdXBlcihtZXNzYWdlKTtcbiAgICAgICAgT2JqZWN0LnNldFByb3RvdHlwZU9mKHRoaXMsIG5ldy50YXJnZXQucHJvdG90eXBlKTtcbiAgICB9XG59XG5jbGFzcyBOYkF1dGhFbXB0eVRva2VuRXJyb3IgZXh0ZW5kcyBOYkF1dGhJbGxlZ2FsVG9rZW5FcnJvciB7XG4gICAgY29uc3RydWN0b3IobWVzc2FnZSkge1xuICAgICAgICBzdXBlcihtZXNzYWdlKTtcbiAgICAgICAgT2JqZWN0LnNldFByb3RvdHlwZU9mKHRoaXMsIG5ldy50YXJnZXQucHJvdG90eXBlKTtcbiAgICB9XG59XG5jbGFzcyBOYkF1dGhJbGxlZ2FsSldUVG9rZW5FcnJvciBleHRlbmRzIE5iQXV0aElsbGVnYWxUb2tlbkVycm9yIHtcbiAgICBjb25zdHJ1Y3RvcihtZXNzYWdlKSB7XG4gICAgICAgIHN1cGVyKG1lc3NhZ2UpO1xuICAgICAgICBPYmplY3Quc2V0UHJvdG90eXBlT2YodGhpcywgbmV3LnRhcmdldC5wcm90b3R5cGUpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIG5iQXV0aENyZWF0ZVRva2VuKHRva2VuQ2xhc3MsIHRva2VuLCBvd25lclN0cmF0ZWd5TmFtZSwgY3JlYXRlZEF0KSB7XG4gICAgcmV0dXJuIG5ldyB0b2tlbkNsYXNzKHRva2VuLCBvd25lclN0cmF0ZWd5TmFtZSwgY3JlYXRlZEF0KTtcbn1cbmZ1bmN0aW9uIGRlY29kZUp3dFBheWxvYWQocGF5bG9hZCkge1xuICAgIGlmIChwYXlsb2FkLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICB0aHJvdyBuZXcgTmJBdXRoRW1wdHlUb2tlbkVycm9yKCdDYW5ub3QgZXh0cmFjdCBmcm9tIGFuIGVtcHR5IHBheWxvYWQuJyk7XG4gICAgfVxuICAgIGNvbnN0IHBhcnRzID0gcGF5bG9hZC5zcGxpdCgnLicpO1xuICAgIGlmIChwYXJ0cy5sZW5ndGggIT09IDMpIHtcbiAgICAgICAgdGhyb3cgbmV3IE5iQXV0aElsbGVnYWxKV1RUb2tlbkVycm9yKGBUaGUgcGF5bG9hZCAke3BheWxvYWR9IGlzIG5vdCB2YWxpZCBKV1QgcGF5bG9hZCBhbmQgbXVzdCBjb25zaXN0IG9mIHRocmVlIHBhcnRzLmApO1xuICAgIH1cbiAgICBsZXQgZGVjb2RlZDtcbiAgICB0cnkge1xuICAgICAgICBkZWNvZGVkID0gdXJsQmFzZTY0RGVjb2RlKHBhcnRzWzFdKTtcbiAgICB9XG4gICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgdGhyb3cgbmV3IE5iQXV0aElsbGVnYWxKV1RUb2tlbkVycm9yKGBUaGUgcGF5bG9hZCAke3BheWxvYWR9IGlzIG5vdCB2YWxpZCBKV1QgcGF5bG9hZCBhbmQgY2Fubm90IGJlIHBhcnNlZC5gKTtcbiAgICB9XG4gICAgaWYgKCFkZWNvZGVkKSB7XG4gICAgICAgIHRocm93IG5ldyBOYkF1dGhJbGxlZ2FsSldUVG9rZW5FcnJvcihgVGhlIHBheWxvYWQgJHtwYXlsb2FkfSBpcyBub3QgdmFsaWQgSldUIHBheWxvYWQgYW5kIGNhbm5vdCBiZSBkZWNvZGVkLmApO1xuICAgIH1cbiAgICByZXR1cm4gSlNPTi5wYXJzZShkZWNvZGVkKTtcbn1cbi8qKlxuICogV3JhcHBlciBmb3Igc2ltcGxlICh0ZXh0KSB0b2tlblxuICovXG5jbGFzcyBOYkF1dGhTaW1wbGVUb2tlbiBleHRlbmRzIE5iQXV0aFRva2VuIHtcbiAgICBjb25zdHJ1Y3Rvcih0b2tlbiwgb3duZXJTdHJhdGVneU5hbWUsIGNyZWF0ZWRBdCkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLnRva2VuID0gdG9rZW47XG4gICAgICAgIHRoaXMub3duZXJTdHJhdGVneU5hbWUgPSBvd25lclN0cmF0ZWd5TmFtZTtcbiAgICAgICAgdGhpcy5jcmVhdGVkQXQgPSBjcmVhdGVkQXQ7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB0aGlzLnBhcnNlUGF5bG9hZCgpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgIGlmICghKGVyciBpbnN0YW5jZW9mIE5iQXV0aFRva2VuTm90Rm91bmRFcnJvcikpIHtcbiAgICAgICAgICAgICAgICAvLyB0b2tlbiBpcyBwcmVzZW50IGJ1dCBoYXMgZ290IGEgcHJvYmxlbSwgaW5jbHVkaW5nIGlsbGVnYWxcbiAgICAgICAgICAgICAgICB0aHJvdyBlcnI7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5jcmVhdGVkQXQgPSB0aGlzLnByZXBhcmVDcmVhdGVkQXQoY3JlYXRlZEF0KTtcbiAgICB9XG4gICAgcGFyc2VQYXlsb2FkKCkge1xuICAgICAgICB0aGlzLnBheWxvYWQgPSBudWxsO1xuICAgIH1cbiAgICBwcmVwYXJlQ3JlYXRlZEF0KGRhdGUpIHtcbiAgICAgICAgcmV0dXJuIGRhdGUgPyBkYXRlIDogbmV3IERhdGUoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgdG9rZW4ncyBjcmVhdGlvbiBkYXRlXG4gICAgICogQHJldHVybnMge0RhdGV9XG4gICAgICovXG4gICAgZ2V0Q3JlYXRlZEF0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jcmVhdGVkQXQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIHRva2VuIHZhbHVlXG4gICAgICogQHJldHVybnMgc3RyaW5nXG4gICAgICovXG4gICAgZ2V0VmFsdWUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnRva2VuO1xuICAgIH1cbiAgICBnZXRPd25lclN0cmF0ZWd5TmFtZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMub3duZXJTdHJhdGVneU5hbWU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIElzIG5vbiBlbXB0eSBhbmQgdmFsaWRcbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn1cbiAgICAgKi9cbiAgICBpc1ZhbGlkKCkge1xuICAgICAgICByZXR1cm4gISF0aGlzLmdldFZhbHVlKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFZhbGlkYXRlIHZhbHVlIGFuZCBjb252ZXJ0IHRvIHN0cmluZywgaWYgdmFsdWUgaXMgbm90IHZhbGlkIHJldHVybiBlbXB0eSBzdHJpbmdcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfVxuICAgICAqL1xuICAgIHRvU3RyaW5nKCkge1xuICAgICAgICByZXR1cm4gISF0aGlzLnRva2VuID8gdGhpcy50b2tlbiA6ICcnO1xuICAgIH1cbn1cbk5iQXV0aFNpbXBsZVRva2VuLk5BTUUgPSAnbmI6YXV0aDpzaW1wbGU6dG9rZW4nO1xuLyoqXG4gKiBXcmFwcGVyIGZvciBKV1QgdG9rZW4gd2l0aCBhZGRpdGlvbmFsIG1ldGhvZHMuXG4gKi9cbmNsYXNzIE5iQXV0aEpXVFRva2VuIGV4dGVuZHMgTmJBdXRoU2ltcGxlVG9rZW4ge1xuICAgIC8qKlxuICAgICAqIGZvciBKV1QgdG9rZW4sIHRoZSBpYXQgKGlzc3VlZCBhdCkgZmllbGQgb2YgdGhlIHRva2VuIHBheWxvYWQgY29udGFpbnMgdGhlIGNyZWF0aW9uIERhdGVcbiAgICAgKi9cbiAgICBwcmVwYXJlQ3JlYXRlZEF0KGRhdGUpIHtcbiAgICAgICAgY29uc3QgZGVjb2RlZCA9IHRoaXMuZ2V0UGF5bG9hZCgpO1xuICAgICAgICByZXR1cm4gZGVjb2RlZCAmJiBkZWNvZGVkLmlhdCA/IG5ldyBEYXRlKE51bWJlcihkZWNvZGVkLmlhdCkgKiAxMDAwKSA6IHN1cGVyLnByZXBhcmVDcmVhdGVkQXQoZGF0ZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgcGF5bG9hZCBvYmplY3RcbiAgICAgKiBAcmV0dXJucyBhbnlcbiAgICAgKi9cbiAgICBwYXJzZVBheWxvYWQoKSB7XG4gICAgICAgIGlmICghdGhpcy50b2tlbikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IE5iQXV0aFRva2VuTm90Rm91bmRFcnJvcignVG9rZW4gbm90IGZvdW5kLiAnKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnBheWxvYWQgPSBkZWNvZGVKd3RQYXlsb2FkKHRoaXMudG9rZW4pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGV4cGlyYXRpb24gZGF0ZVxuICAgICAqIEByZXR1cm5zIERhdGVcbiAgICAgKi9cbiAgICBnZXRUb2tlbkV4cERhdGUoKSB7XG4gICAgICAgIGNvbnN0IGRlY29kZWQgPSB0aGlzLmdldFBheWxvYWQoKTtcbiAgICAgICAgaWYgKGRlY29kZWQgJiYgIWRlY29kZWQuaGFzT3duUHJvcGVydHkoJ2V4cCcpKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBkYXRlID0gbmV3IERhdGUoMCk7XG4gICAgICAgIGRhdGUuc2V0VVRDU2Vjb25kcyhkZWNvZGVkLmV4cCk7IC8vICdjYXVzZSBqd3QgdG9rZW4gYXJlIHNldCBpbiBzZWNvbmRzXG4gICAgICAgIHJldHVybiBkYXRlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBJcyBkYXRhIGV4cGlyZWRcbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn1cbiAgICAgKi9cbiAgICBpc1ZhbGlkKCkge1xuICAgICAgICByZXR1cm4gc3VwZXIuaXNWYWxpZCgpICYmICghdGhpcy5nZXRUb2tlbkV4cERhdGUoKSB8fCBuZXcgRGF0ZSgpIDwgdGhpcy5nZXRUb2tlbkV4cERhdGUoKSk7XG4gICAgfVxufVxuTmJBdXRoSldUVG9rZW4uTkFNRSA9ICduYjphdXRoOmp3dDp0b2tlbic7XG5jb25zdCBwcmVwYXJlT0F1dGgyVG9rZW4gPSAoZGF0YSkgPT4ge1xuICAgIGlmICh0eXBlb2YgZGF0YSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHJldHVybiBKU09OLnBhcnNlKGRhdGEpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlKSB7IH1cbiAgICB9XG4gICAgcmV0dXJuIGRhdGE7XG59O1xuY29uc3QgybUwID0gcHJlcGFyZU9BdXRoMlRva2VuO1xuLyoqXG4gKiBXcmFwcGVyIGZvciBPQXV0aDIgdG9rZW4gd2hvc2UgYWNjZXNzX3Rva2VuIGlzIGEgSldUIFRva2VuXG4gKi9cbmNsYXNzIE5iQXV0aE9BdXRoMlRva2VuIGV4dGVuZHMgTmJBdXRoU2ltcGxlVG9rZW4ge1xuICAgIGNvbnN0cnVjdG9yKGRhdGEgPSB7fSwgb3duZXJTdHJhdGVneU5hbWUsIGNyZWF0ZWRBdCkge1xuICAgICAgICAvLyB3ZSBtYXkgZ2V0IGl0IGFzIHN0cmluZyB3aGVuIHJldHJpZXZpbmcgZnJvbSBhIHN0b3JhZ2VcbiAgICAgICAgc3VwZXIocHJlcGFyZU9BdXRoMlRva2VuKGRhdGEpLCBvd25lclN0cmF0ZWd5TmFtZSwgY3JlYXRlZEF0KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgdG9rZW4gdmFsdWVcbiAgICAgKiBAcmV0dXJucyBzdHJpbmdcbiAgICAgKi9cbiAgICBnZXRWYWx1ZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudG9rZW4uYWNjZXNzX3Rva2VuO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSByZWZyZXNoIHRva2VuXG4gICAgICogQHJldHVybnMgc3RyaW5nXG4gICAgICovXG4gICAgZ2V0UmVmcmVzaFRva2VuKCkge1xuICAgICAgICByZXR1cm4gdGhpcy50b2tlbi5yZWZyZXNoX3Rva2VuO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiAgcHV0IHJlZnJlc2hUb2tlbiBpbiB0aGUgdG9rZW4gcGF5bG9hZFxuICAgICAgKiBAcGFyYW0gcmVmcmVzaFRva2VuXG4gICAgICovXG4gICAgc2V0UmVmcmVzaFRva2VuKHJlZnJlc2hUb2tlbikge1xuICAgICAgICB0aGlzLnRva2VuLnJlZnJlc2hfdG9rZW4gPSByZWZyZXNoVG9rZW47XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFBhcnNlcyB0b2tlbiBwYXlsb2FkXG4gICAgICogQHJldHVybnMgYW55XG4gICAgICovXG4gICAgcGFyc2VQYXlsb2FkKCkge1xuICAgICAgICBpZiAoIXRoaXMudG9rZW4pIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBOYkF1dGhUb2tlbk5vdEZvdW5kRXJyb3IoJ1Rva2VuIG5vdCBmb3VuZC4nKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlmICghT2JqZWN0LmtleXModGhpcy50b2tlbikubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IE5iQXV0aEVtcHR5VG9rZW5FcnJvcignQ2Fubm90IGV4dHJhY3QgcGF5bG9hZCBmcm9tIGFuIGVtcHR5IHRva2VuLicpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMucGF5bG9hZCA9IHRoaXMudG9rZW47XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIHRva2VuIHR5cGVcbiAgICAgKiBAcmV0dXJucyBzdHJpbmdcbiAgICAgKi9cbiAgICBnZXRUeXBlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy50b2tlbi50b2tlbl90eXBlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBJcyBkYXRhIGV4cGlyZWRcbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn1cbiAgICAgKi9cbiAgICBpc1ZhbGlkKCkge1xuICAgICAgICByZXR1cm4gc3VwZXIuaXNWYWxpZCgpICYmICghdGhpcy5nZXRUb2tlbkV4cERhdGUoKSB8fCBuZXcgRGF0ZSgpIDwgdGhpcy5nZXRUb2tlbkV4cERhdGUoKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgZXhwaXJhdGlvbiBkYXRlXG4gICAgICogQHJldHVybnMgRGF0ZVxuICAgICAqL1xuICAgIGdldFRva2VuRXhwRGF0ZSgpIHtcbiAgICAgICAgaWYgKCF0aGlzLnRva2VuLmhhc093blByb3BlcnR5KCdleHBpcmVzX2luJykpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZXcgRGF0ZSh0aGlzLmNyZWF0ZWRBdC5nZXRUaW1lKCkgKyBOdW1iZXIodGhpcy50b2tlbi5leHBpcmVzX2luKSAqIDEwMDApO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDb252ZXJ0IHRvIHN0cmluZ1xuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9XG4gICAgICovXG4gICAgdG9TdHJpbmcoKSB7XG4gICAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeSh0aGlzLnRva2VuKTtcbiAgICB9XG59XG5OYkF1dGhPQXV0aDJUb2tlbi5OQU1FID0gJ25iOmF1dGg6b2F1dGgyOnRva2VuJztcbi8qKlxuICogV3JhcHBlciBmb3IgT0F1dGgyIHRva2VuIGVtYmVkZGluZyBKV1QgdG9rZW5zXG4gKi9cbmNsYXNzIE5iQXV0aE9BdXRoMkpXVFRva2VuIGV4dGVuZHMgTmJBdXRoT0F1dGgyVG9rZW4ge1xuICAgIHBhcnNlUGF5bG9hZCgpIHtcbiAgICAgICAgc3VwZXIucGFyc2VQYXlsb2FkKCk7XG4gICAgICAgIHRoaXMucGFyc2VBY2Nlc3NUb2tlblBheWxvYWQoKTtcbiAgICB9XG4gICAgcGFyc2VBY2Nlc3NUb2tlblBheWxvYWQoKSB7XG4gICAgICAgIGNvbnN0IGFjY2Vzc1Rva2VuID0gdGhpcy5nZXRWYWx1ZSgpO1xuICAgICAgICBpZiAoIWFjY2Vzc1Rva2VuKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgTmJBdXRoVG9rZW5Ob3RGb3VuZEVycm9yKCdhY2Nlc3NfdG9rZW4ga2V5IG5vdCBmb3VuZC4nKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmFjY2Vzc1Rva2VuUGF5bG9hZCA9IGRlY29kZUp3dFBheWxvYWQoYWNjZXNzVG9rZW4pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGFjY2VzcyB0b2tlbiBwYXlsb2FkXG4gICAgICogQHJldHVybnMgYW55XG4gICAgICovXG4gICAgZ2V0QWNjZXNzVG9rZW5QYXlsb2FkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5hY2Nlc3NUb2tlblBheWxvYWQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIGZvciBPYXV0aDIgSldUIHRva2VuLCB0aGUgaWF0IChpc3N1ZWQgYXQpIGZpZWxkIG9mIHRoZSBhY2Nlc3NfdG9rZW4gcGF5bG9hZFxuICAgICAqL1xuICAgIHByZXBhcmVDcmVhdGVkQXQoZGF0ZSkge1xuICAgICAgICBjb25zdCBwYXlsb2FkID0gdGhpcy5hY2Nlc3NUb2tlblBheWxvYWQ7XG4gICAgICAgIHJldHVybiBwYXlsb2FkICYmIHBheWxvYWQuaWF0ID8gbmV3IERhdGUoTnVtYmVyKHBheWxvYWQuaWF0KSAqIDEwMDApIDogc3VwZXIucHJlcGFyZUNyZWF0ZWRBdChkYXRlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogSXMgdG9rZW4gdmFsaWRcbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn1cbiAgICAgKi9cbiAgICBpc1ZhbGlkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5hY2Nlc3NUb2tlblBheWxvYWQgJiYgc3VwZXIuaXNWYWxpZCgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGV4cGlyYXRpb24gZGF0ZSA6XG4gICAgICogLSBleHAgaWYgc2V0LFxuICAgICAqIC0gc3VwZXIuZ2V0RXhwRGF0ZSgpIG90aGVyd2lzZVxuICAgICAqIEByZXR1cm5zIERhdGVcbiAgICAgKi9cbiAgICBnZXRUb2tlbkV4cERhdGUoKSB7XG4gICAgICAgIGlmICh0aGlzLmFjY2Vzc1Rva2VuUGF5bG9hZCAmJiB0aGlzLmFjY2Vzc1Rva2VuUGF5bG9hZC5oYXNPd25Qcm9wZXJ0eSgnZXhwJykpIHtcbiAgICAgICAgICAgIGNvbnN0IGRhdGUgPSBuZXcgRGF0ZSgwKTtcbiAgICAgICAgICAgIGRhdGUuc2V0VVRDU2Vjb25kcyh0aGlzLmFjY2Vzc1Rva2VuUGF5bG9hZC5leHApO1xuICAgICAgICAgICAgcmV0dXJuIGRhdGU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gc3VwZXIuZ2V0VG9rZW5FeHBEYXRlKCk7XG4gICAgICAgIH1cbiAgICB9XG59XG5OYkF1dGhPQXV0aDJKV1RUb2tlbi5OQU1FID0gJ25iOmF1dGg6b2F1dGgyOmp3dDp0b2tlbic7XG5cbnZhciBfX2RlY29yYXRlJDQgPSAodGhpcyAmJiB0aGlzLl9fZGVjb3JhdGUpIHx8IGZ1bmN0aW9uIChkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYykge1xuICAgIHZhciBjID0gYXJndW1lbnRzLmxlbmd0aCwgciA9IGMgPCAzID8gdGFyZ2V0IDogZGVzYyA9PT0gbnVsbCA/IGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHRhcmdldCwga2V5KSA6IGRlc2MsIGQ7XG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0LmRlY29yYXRlID09PSBcImZ1bmN0aW9uXCIpIHIgPSBSZWZsZWN0LmRlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKTtcbiAgICBlbHNlIGZvciAodmFyIGkgPSBkZWNvcmF0b3JzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSBpZiAoZCA9IGRlY29yYXRvcnNbaV0pIHIgPSAoYyA8IDMgPyBkKHIpIDogYyA+IDMgPyBkKHRhcmdldCwga2V5LCByKSA6IGQodGFyZ2V0LCBrZXkpKSB8fCByO1xuICAgIHJldHVybiBjID4gMyAmJiByICYmIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgciksIHI7XG59O1xudmFyIF9fbWV0YWRhdGEkMyA9ICh0aGlzICYmIHRoaXMuX19tZXRhZGF0YSkgfHwgZnVuY3Rpb24gKGssIHYpIHtcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QubWV0YWRhdGEgPT09IFwiZnVuY3Rpb25cIikgcmV0dXJuIFJlZmxlY3QubWV0YWRhdGEoaywgdik7XG59O1xudmFyIF9fcGFyYW0kMSA9ICh0aGlzICYmIHRoaXMuX19wYXJhbSkgfHwgZnVuY3Rpb24gKHBhcmFtSW5kZXgsIGRlY29yYXRvcikge1xuICAgIHJldHVybiBmdW5jdGlvbiAodGFyZ2V0LCBrZXkpIHsgZGVjb3JhdG9yKHRhcmdldCwga2V5LCBwYXJhbUluZGV4KTsgfVxufTtcbmNvbnN0IE5CX0FVVEhfRkFMTEJBQ0tfVE9LRU4gPSBuZXcgSW5qZWN0aW9uVG9rZW4oJ05lYnVsYXIgQXV0aCBPcHRpb25zJyk7XG4vKipcbiAqIENyZWF0ZXMgYSB0b2tlbiBwYXJjZWwgd2hpY2ggY291bGQgYmUgc3RvcmVkL3Jlc3RvcmVkXG4gKi9cbmxldCBOYkF1dGhUb2tlblBhcmNlbGVyID0gY2xhc3MgTmJBdXRoVG9rZW5QYXJjZWxlciB7XG4gICAgY29uc3RydWN0b3IoZmFsbGJhY2tDbGFzcywgdG9rZW5DbGFzc2VzKSB7XG4gICAgICAgIHRoaXMuZmFsbGJhY2tDbGFzcyA9IGZhbGxiYWNrQ2xhc3M7XG4gICAgICAgIHRoaXMudG9rZW5DbGFzc2VzID0gdG9rZW5DbGFzc2VzO1xuICAgIH1cbiAgICB3cmFwKHRva2VuKSB7XG4gICAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICBuYW1lOiB0b2tlbi5nZXROYW1lKCksXG4gICAgICAgICAgICBvd25lclN0cmF0ZWd5TmFtZTogdG9rZW4uZ2V0T3duZXJTdHJhdGVneU5hbWUoKSxcbiAgICAgICAgICAgIGNyZWF0ZWRBdDogdG9rZW4uZ2V0Q3JlYXRlZEF0KCkuZ2V0VGltZSgpLFxuICAgICAgICAgICAgdmFsdWU6IHRva2VuLnRvU3RyaW5nKCksXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICB1bndyYXAodmFsdWUpIHtcbiAgICAgICAgbGV0IHRva2VuQ2xhc3MgPSB0aGlzLmZhbGxiYWNrQ2xhc3M7XG4gICAgICAgIGxldCB0b2tlblZhbHVlID0gJyc7XG4gICAgICAgIGxldCB0b2tlbk93bmVyU3RyYXRlZ3lOYW1lID0gJyc7XG4gICAgICAgIGxldCB0b2tlbkNyZWF0ZWRBdCA9IG51bGw7XG4gICAgICAgIGNvbnN0IHRva2VuUGFjayA9IHRoaXMucGFyc2VUb2tlblBhY2sodmFsdWUpO1xuICAgICAgICBpZiAodG9rZW5QYWNrKSB7XG4gICAgICAgICAgICB0b2tlbkNsYXNzID0gdGhpcy5nZXRDbGFzc0J5TmFtZSh0b2tlblBhY2submFtZSkgfHwgdGhpcy5mYWxsYmFja0NsYXNzO1xuICAgICAgICAgICAgdG9rZW5WYWx1ZSA9IHRva2VuUGFjay52YWx1ZTtcbiAgICAgICAgICAgIHRva2VuT3duZXJTdHJhdGVneU5hbWUgPSB0b2tlblBhY2sub3duZXJTdHJhdGVneU5hbWU7XG4gICAgICAgICAgICB0b2tlbkNyZWF0ZWRBdCA9IG5ldyBEYXRlKE51bWJlcih0b2tlblBhY2suY3JlYXRlZEF0KSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5iQXV0aENyZWF0ZVRva2VuKHRva2VuQ2xhc3MsIHRva2VuVmFsdWUsIHRva2VuT3duZXJTdHJhdGVneU5hbWUsIHRva2VuQ3JlYXRlZEF0KTtcbiAgICB9XG4gICAgLy8gVE9ETzogdGhpcyBjb3VsZCBiZSBtb3ZlZCB0byBhIHNlcGFyYXRlIHRva2VuIHJlZ2lzdHJ5XG4gICAgZ2V0Q2xhc3NCeU5hbWUobmFtZSkge1xuICAgICAgICByZXR1cm4gdGhpcy50b2tlbkNsYXNzZXMuZmluZCgodG9rZW5DbGFzcykgPT4gdG9rZW5DbGFzcy5OQU1FID09PSBuYW1lKTtcbiAgICB9XG4gICAgcGFyc2VUb2tlblBhY2sodmFsdWUpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHJldHVybiBKU09OLnBhcnNlKHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZSkgeyB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbn07XG5OYkF1dGhUb2tlblBhcmNlbGVyID0gX19kZWNvcmF0ZSQ0KFtcbiAgICBJbmplY3RhYmxlKCksXG4gICAgX19wYXJhbSQxKDAsIEluamVjdChOQl9BVVRIX0ZBTExCQUNLX1RPS0VOKSksXG4gICAgX19wYXJhbSQxKDEsIEluamVjdChOQl9BVVRIX1RPS0VOUykpLFxuICAgIF9fbWV0YWRhdGEkMyhcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtPYmplY3QsIEFycmF5XSlcbl0sIE5iQXV0aFRva2VuUGFyY2VsZXIpO1xuXG52YXIgX19kZWNvcmF0ZSQzID0gKHRoaXMgJiYgdGhpcy5fX2RlY29yYXRlKSB8fCBmdW5jdGlvbiAoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpIHtcbiAgICB2YXIgYyA9IGFyZ3VtZW50cy5sZW5ndGgsIHIgPSBjIDwgMyA/IHRhcmdldCA6IGRlc2MgPT09IG51bGwgPyBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0YXJnZXQsIGtleSkgOiBkZXNjLCBkO1xuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5kZWNvcmF0ZSA9PT0gXCJmdW5jdGlvblwiKSByID0gUmVmbGVjdC5kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYyk7XG4gICAgZWxzZSBmb3IgKHZhciBpID0gZGVjb3JhdG9ycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgaWYgKGQgPSBkZWNvcmF0b3JzW2ldKSByID0gKGMgPCAzID8gZChyKSA6IGMgPiAzID8gZCh0YXJnZXQsIGtleSwgcikgOiBkKHRhcmdldCwga2V5KSkgfHwgcjtcbiAgICByZXR1cm4gYyA+IDMgJiYgciAmJiBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHIpLCByO1xufTtcbnZhciBfX21ldGFkYXRhJDIgPSAodGhpcyAmJiB0aGlzLl9fbWV0YWRhdGEpIHx8IGZ1bmN0aW9uIChrLCB2KSB7XG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0Lm1ldGFkYXRhID09PSBcImZ1bmN0aW9uXCIpIHJldHVybiBSZWZsZWN0Lm1ldGFkYXRhKGssIHYpO1xufTtcbmNsYXNzIE5iVG9rZW5TdG9yYWdlIHtcbn1cbi8qKlxuICogU2VydmljZSB0aGF0IHVzZXMgYnJvd3NlciBsb2NhbFN0b3JhZ2UgYXMgYSBzdG9yYWdlLlxuICpcbiAqIFRoZSB0b2tlbiBzdG9yYWdlIGlzIHByb3ZpZGVkIGludG8gYXV0aCBtb2R1bGUgdGhlIGZvbGxvd2luZyB3YXk6XG4gKiBgYGB0c1xuICogeyBwcm92aWRlOiBOYlRva2VuU3RvcmFnZSwgdXNlQ2xhc3M6IE5iVG9rZW5Mb2NhbFN0b3JhZ2UgfSxcbiAqIGBgYFxuICpcbiAqIElmIHlvdSBuZWVkIHRvIGNoYW5nZSB0aGUgc3RvcmFnZSBiZWhhdmlvdXIgb3IgcHJvdmlkZSB5b3VyIG93biAtIGp1c3QgZXh0ZW5kIHlvdXIgY2xhc3MgZnJvbSBiYXNpYyBgTmJUb2tlblN0b3JhZ2VgXG4gKiBvciBgTmJUb2tlbkxvY2FsU3RvcmFnZWAgYW5kIHByb3ZpZGUgaW4geW91ciBgYXBwLm1vZHVsZWA6XG4gKiBgYGB0c1xuICogeyBwcm92aWRlOiBOYlRva2VuU3RvcmFnZSwgdXNlQ2xhc3M6IE5iVG9rZW5DdXN0b21TdG9yYWdlIH0sXG4gKiBgYGBcbiAqXG4gKi9cbmxldCBOYlRva2VuTG9jYWxTdG9yYWdlID0gY2xhc3MgTmJUb2tlbkxvY2FsU3RvcmFnZSBleHRlbmRzIE5iVG9rZW5TdG9yYWdlIHtcbiAgICBjb25zdHJ1Y3RvcihwYXJjZWxlcikge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLnBhcmNlbGVyID0gcGFyY2VsZXI7XG4gICAgICAgIHRoaXMua2V5ID0gJ2F1dGhfYXBwX3Rva2VuJztcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0b2tlbiBmcm9tIGxvY2FsU3RvcmFnZVxuICAgICAqIEByZXR1cm5zIHtOYkF1dGhUb2tlbn1cbiAgICAgKi9cbiAgICBnZXQoKSB7XG4gICAgICAgIGNvbnN0IHJhdyA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKHRoaXMua2V5KTtcbiAgICAgICAgcmV0dXJuIHRoaXMucGFyY2VsZXIudW53cmFwKHJhdyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNldHMgdG9rZW4gdG8gbG9jYWxTdG9yYWdlXG4gICAgICogQHBhcmFtIHtOYkF1dGhUb2tlbn0gdG9rZW5cbiAgICAgKi9cbiAgICBzZXQodG9rZW4pIHtcbiAgICAgICAgY29uc3QgcmF3ID0gdGhpcy5wYXJjZWxlci53cmFwKHRva2VuKTtcbiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0odGhpcy5rZXksIHJhdyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENsZWFycyB0b2tlbiBmcm9tIGxvY2FsU3RvcmFnZVxuICAgICAqL1xuICAgIGNsZWFyKCkge1xuICAgICAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSh0aGlzLmtleSk7XG4gICAgfVxufTtcbk5iVG9rZW5Mb2NhbFN0b3JhZ2UgPSBfX2RlY29yYXRlJDMoW1xuICAgIEluamVjdGFibGUoKSxcbiAgICBfX21ldGFkYXRhJDIoXCJkZXNpZ246cGFyYW10eXBlc1wiLCBbTmJBdXRoVG9rZW5QYXJjZWxlcl0pXG5dLCBOYlRva2VuTG9jYWxTdG9yYWdlKTtcblxudmFyIF9fZGVjb3JhdGUkMiA9ICh0aGlzICYmIHRoaXMuX19kZWNvcmF0ZSkgfHwgZnVuY3Rpb24gKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKSB7XG4gICAgdmFyIGMgPSBhcmd1bWVudHMubGVuZ3RoLCByID0gYyA8IDMgPyB0YXJnZXQgOiBkZXNjID09PSBudWxsID8gZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBrZXkpIDogZGVzYywgZDtcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QuZGVjb3JhdGUgPT09IFwiZnVuY3Rpb25cIikgciA9IFJlZmxlY3QuZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpO1xuICAgIGVsc2UgZm9yICh2YXIgaSA9IGRlY29yYXRvcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIGlmIChkID0gZGVjb3JhdG9yc1tpXSkgciA9IChjIDwgMyA/IGQocikgOiBjID4gMyA/IGQodGFyZ2V0LCBrZXksIHIpIDogZCh0YXJnZXQsIGtleSkpIHx8IHI7XG4gICAgcmV0dXJuIGMgPiAzICYmIHIgJiYgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCByKSwgcjtcbn07XG52YXIgX19tZXRhZGF0YSQxID0gKHRoaXMgJiYgdGhpcy5fX21ldGFkYXRhKSB8fCBmdW5jdGlvbiAoaywgdikge1xuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5tZXRhZGF0YSA9PT0gXCJmdW5jdGlvblwiKSByZXR1cm4gUmVmbGVjdC5tZXRhZGF0YShrLCB2KTtcbn07XG4vKipcbiAqIFNlcnZpY2UgdGhhdCBhbGxvd3MgeW91IHRvIG1hbmFnZSBhdXRoZW50aWNhdGlvbiB0b2tlbiAtIGdldCwgc2V0LCBjbGVhciBhbmQgYWxzbyBsaXN0ZW4gdG8gdG9rZW4gY2hhbmdlcyBvdmVyIHRpbWUuXG4gKi9cbmxldCBOYlRva2VuU2VydmljZSA9IGNsYXNzIE5iVG9rZW5TZXJ2aWNlIHtcbiAgICBjb25zdHJ1Y3Rvcih0b2tlblN0b3JhZ2UpIHtcbiAgICAgICAgdGhpcy50b2tlblN0b3JhZ2UgPSB0b2tlblN0b3JhZ2U7XG4gICAgICAgIHRoaXMudG9rZW4kID0gbmV3IEJlaGF2aW9yU3ViamVjdChudWxsKTtcbiAgICAgICAgdGhpcy5wdWJsaXNoU3RvcmVkVG9rZW4oKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUHVibGlzaGVzIHRva2VuIHdoZW4gaXQgY2hhbmdlcy5cbiAgICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZTxOYkF1dGhUb2tlbj59XG4gICAgICovXG4gICAgdG9rZW5DaGFuZ2UoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnRva2VuJFxuICAgICAgICAgICAgLnBpcGUoZmlsdGVyKHZhbHVlID0+ICEhdmFsdWUpLCBzaGFyZSgpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2V0cyBhIHRva2VuIGludG8gdGhlIHN0b3JhZ2UuIFRoaXMgbWV0aG9kIGlzIHVzZWQgYnkgdGhlIE5iQXV0aFNlcnZpY2UgYXV0b21hdGljYWxseS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7TmJBdXRoVG9rZW59IHRva2VuXG4gICAgICogQHJldHVybnMge09ic2VydmFibGU8YW55Pn1cbiAgICAgKi9cbiAgICBzZXQodG9rZW4pIHtcbiAgICAgICAgdGhpcy50b2tlblN0b3JhZ2Uuc2V0KHRva2VuKTtcbiAgICAgICAgdGhpcy5wdWJsaXNoU3RvcmVkVG9rZW4oKTtcbiAgICAgICAgcmV0dXJuIG9mKG51bGwpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIG9ic2VydmFibGUgb2YgY3VycmVudCB0b2tlblxuICAgICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlPE5iQXV0aFRva2VuPn1cbiAgICAgKi9cbiAgICBnZXQoKSB7XG4gICAgICAgIGNvbnN0IHRva2VuID0gdGhpcy50b2tlblN0b3JhZ2UuZ2V0KCk7XG4gICAgICAgIHJldHVybiBvZih0b2tlbik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlbW92ZXMgdGhlIHRva2VuIGFuZCBwdWJsaXNoZWQgdG9rZW4gdmFsdWVcbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlPGFueT59XG4gICAgICovXG4gICAgY2xlYXIoKSB7XG4gICAgICAgIHRoaXMudG9rZW5TdG9yYWdlLmNsZWFyKCk7XG4gICAgICAgIHRoaXMucHVibGlzaFN0b3JlZFRva2VuKCk7XG4gICAgICAgIHJldHVybiBvZihudWxsKTtcbiAgICB9XG4gICAgcHVibGlzaFN0b3JlZFRva2VuKCkge1xuICAgICAgICB0aGlzLnRva2VuJC5uZXh0KHRoaXMudG9rZW5TdG9yYWdlLmdldCgpKTtcbiAgICB9XG59O1xuTmJUb2tlblNlcnZpY2UgPSBfX2RlY29yYXRlJDIoW1xuICAgIEluamVjdGFibGUoKSxcbiAgICBfX21ldGFkYXRhJDEoXCJkZXNpZ246cGFyYW10eXBlc1wiLCBbTmJUb2tlblN0b3JhZ2VdKVxuXSwgTmJUb2tlblNlcnZpY2UpO1xuXG52YXIgX19kZWNvcmF0ZSQxID0gKHRoaXMgJiYgdGhpcy5fX2RlY29yYXRlKSB8fCBmdW5jdGlvbiAoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpIHtcbiAgICB2YXIgYyA9IGFyZ3VtZW50cy5sZW5ndGgsIHIgPSBjIDwgMyA/IHRhcmdldCA6IGRlc2MgPT09IG51bGwgPyBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0YXJnZXQsIGtleSkgOiBkZXNjLCBkO1xuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5kZWNvcmF0ZSA9PT0gXCJmdW5jdGlvblwiKSByID0gUmVmbGVjdC5kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYyk7XG4gICAgZWxzZSBmb3IgKHZhciBpID0gZGVjb3JhdG9ycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgaWYgKGQgPSBkZWNvcmF0b3JzW2ldKSByID0gKGMgPCAzID8gZChyKSA6IGMgPiAzID8gZCh0YXJnZXQsIGtleSwgcikgOiBkKHRhcmdldCwga2V5KSkgfHwgcjtcbiAgICByZXR1cm4gYyA+IDMgJiYgciAmJiBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHIpLCByO1xufTtcbnZhciBfX21ldGFkYXRhID0gKHRoaXMgJiYgdGhpcy5fX21ldGFkYXRhKSB8fCBmdW5jdGlvbiAoaywgdikge1xuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5tZXRhZGF0YSA9PT0gXCJmdW5jdGlvblwiKSByZXR1cm4gUmVmbGVjdC5tZXRhZGF0YShrLCB2KTtcbn07XG52YXIgX19wYXJhbSA9ICh0aGlzICYmIHRoaXMuX19wYXJhbSkgfHwgZnVuY3Rpb24gKHBhcmFtSW5kZXgsIGRlY29yYXRvcikge1xuICAgIHJldHVybiBmdW5jdGlvbiAodGFyZ2V0LCBrZXkpIHsgZGVjb3JhdG9yKHRhcmdldCwga2V5LCBwYXJhbUluZGV4KTsgfVxufTtcbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCBBa3Zlby4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS4gU2VlIExpY2Vuc2UudHh0IGluIHRoZSBwcm9qZWN0IHJvb3QgZm9yIGxpY2Vuc2UgaW5mb3JtYXRpb24uXG4gKi9cbi8qKlxuICogQ29tbW9uIGF1dGhlbnRpY2F0aW9uIHNlcnZpY2UuXG4gKiBTaG91bGQgYmUgdXNlZCB0byBhcyBhbiBpbnRlcmxheWVyIGJldHdlZW4gVUkgQ29tcG9uZW50cyBhbmQgQXV0aCBTdHJhdGVneS5cbiAqL1xubGV0IE5iQXV0aFNlcnZpY2UgPSBjbGFzcyBOYkF1dGhTZXJ2aWNlIHtcbiAgICBjb25zdHJ1Y3Rvcih0b2tlblNlcnZpY2UsIHN0cmF0ZWdpZXMpIHtcbiAgICAgICAgdGhpcy50b2tlblNlcnZpY2UgPSB0b2tlblNlcnZpY2U7XG4gICAgICAgIHRoaXMuc3RyYXRlZ2llcyA9IHN0cmF0ZWdpZXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHJpZXZlcyBjdXJyZW50IGF1dGhlbnRpY2F0ZWQgdG9rZW4gc3RvcmVkXG4gICAgICogQHJldHVybnMge09ic2VydmFibGU8YW55Pn1cbiAgICAgKi9cbiAgICBnZXRUb2tlbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudG9rZW5TZXJ2aWNlLmdldCgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRydWUgaWYgYXV0aCB0b2tlbiBpcyBwcmVzZW50IGluIHRoZSB0b2tlbiBzdG9yYWdlXG4gICAgICogQHJldHVybnMge09ic2VydmFibGU8Ym9vbGVhbj59XG4gICAgICovXG4gICAgaXNBdXRoZW50aWNhdGVkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRUb2tlbigpXG4gICAgICAgICAgICAucGlwZShtYXAoKHRva2VuKSA9PiB0b2tlbi5pc1ZhbGlkKCkpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0cnVlIGlmIHZhbGlkIGF1dGggdG9rZW4gaXMgcHJlc2VudCBpbiB0aGUgdG9rZW4gc3RvcmFnZS5cbiAgICAgKiBJZiBub3QsIGNhbGxzIHRoZSBzdHJhdGVneSByZWZyZXNoVG9rZW4sIGFuZCByZXR1cm5zIGlzQXV0aGVudGljYXRlZCgpIGlmIHN1Y2Nlc3MsIGZhbHNlIG90aGVyd2lzZVxuICAgICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlPGJvb2xlYW4+fVxuICAgICAqL1xuICAgIGlzQXV0aGVudGljYXRlZE9yUmVmcmVzaCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0VG9rZW4oKVxuICAgICAgICAgICAgLnBpcGUoc3dpdGNoTWFwKHRva2VuID0+IHtcbiAgICAgICAgICAgIGlmICh0b2tlbi5nZXRWYWx1ZSgpICYmICF0b2tlbi5pc1ZhbGlkKCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5yZWZyZXNoVG9rZW4odG9rZW4uZ2V0T3duZXJTdHJhdGVneU5hbWUoKSwgdG9rZW4pXG4gICAgICAgICAgICAgICAgICAgIC5waXBlKHN3aXRjaE1hcChyZXMgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAocmVzLmlzU3VjY2VzcygpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5pc0F1dGhlbnRpY2F0ZWQoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBvZihmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gb2YodG9rZW4uaXNWYWxpZCgpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRva2VucyBzdHJlYW1cbiAgICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZTxOYkF1dGhTaW1wbGVUb2tlbj59XG4gICAgICovXG4gICAgb25Ub2tlbkNoYW5nZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudG9rZW5TZXJ2aWNlLnRva2VuQ2hhbmdlKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYXV0aGVudGljYXRpb24gc3RhdHVzIHN0cmVhbVxuICAgICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlPGJvb2xlYW4+fVxuICAgICAqL1xuICAgIG9uQXV0aGVudGljYXRpb25DaGFuZ2UoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm9uVG9rZW5DaGFuZ2UoKVxuICAgICAgICAgICAgLnBpcGUobWFwKCh0b2tlbikgPT4gdG9rZW4uaXNWYWxpZCgpKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEF1dGhlbnRpY2F0ZXMgd2l0aCB0aGUgc2VsZWN0ZWQgc3RyYXRlZ3lcbiAgICAgKiBTdG9yZXMgcmVjZWl2ZWQgdG9rZW4gaW4gdGhlIHRva2VuIHN0b3JhZ2VcbiAgICAgKlxuICAgICAqIEV4YW1wbGU6XG4gICAgICogYXV0aGVudGljYXRlKCdlbWFpbCcsIHtlbWFpbDogJ2VtYWlsQGV4YW1wbGUuY29tJywgcGFzc3dvcmQ6ICd0ZXN0J30pXG4gICAgICpcbiAgICAgKiBAcGFyYW0gc3RyYXRlZ3lOYW1lXG4gICAgICogQHBhcmFtIGRhdGFcbiAgICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZTxOYkF1dGhSZXN1bHQ+fVxuICAgICAqL1xuICAgIGF1dGhlbnRpY2F0ZShzdHJhdGVneU5hbWUsIGRhdGEpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0U3RyYXRlZ3koc3RyYXRlZ3lOYW1lKS5hdXRoZW50aWNhdGUoZGF0YSlcbiAgICAgICAgICAgIC5waXBlKHN3aXRjaE1hcCgocmVzdWx0KSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcm9jZXNzUmVzdWx0VG9rZW4ocmVzdWx0KTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZWdpc3RlcnMgd2l0aCB0aGUgc2VsZWN0ZWQgc3RyYXRlZ3lcbiAgICAgKiBTdG9yZXMgcmVjZWl2ZWQgdG9rZW4gaW4gdGhlIHRva2VuIHN0b3JhZ2VcbiAgICAgKlxuICAgICAqIEV4YW1wbGU6XG4gICAgICogcmVnaXN0ZXIoJ2VtYWlsJywge2VtYWlsOiAnZW1haWxAZXhhbXBsZS5jb20nLCBuYW1lOiAnU29tZSBOYW1lJywgcGFzc3dvcmQ6ICd0ZXN0J30pXG4gICAgICpcbiAgICAgKiBAcGFyYW0gc3RyYXRlZ3lOYW1lXG4gICAgICogQHBhcmFtIGRhdGFcbiAgICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZTxOYkF1dGhSZXN1bHQ+fVxuICAgICAqL1xuICAgIHJlZ2lzdGVyKHN0cmF0ZWd5TmFtZSwgZGF0YSkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRTdHJhdGVneShzdHJhdGVneU5hbWUpLnJlZ2lzdGVyKGRhdGEpXG4gICAgICAgICAgICAucGlwZShzd2l0Y2hNYXAoKHJlc3VsdCkgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJvY2Vzc1Jlc3VsdFRva2VuKHJlc3VsdCk7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2lnbiBvdXRzIHdpdGggdGhlIHNlbGVjdGVkIHN0cmF0ZWd5XG4gICAgICogUmVtb3ZlcyB0b2tlbiBmcm9tIHRoZSB0b2tlbiBzdG9yYWdlXG4gICAgICpcbiAgICAgKiBFeGFtcGxlOlxuICAgICAqIGxvZ291dCgnZW1haWwnKVxuICAgICAqXG4gICAgICogQHBhcmFtIHN0cmF0ZWd5TmFtZVxuICAgICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlPE5iQXV0aFJlc3VsdD59XG4gICAgICovXG4gICAgbG9nb3V0KHN0cmF0ZWd5TmFtZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRTdHJhdGVneShzdHJhdGVneU5hbWUpLmxvZ291dCgpXG4gICAgICAgICAgICAucGlwZShzd2l0Y2hNYXAoKHJlc3VsdCkgPT4ge1xuICAgICAgICAgICAgaWYgKHJlc3VsdC5pc1N1Y2Nlc3MoKSkge1xuICAgICAgICAgICAgICAgIHRoaXMudG9rZW5TZXJ2aWNlLmNsZWFyKClcbiAgICAgICAgICAgICAgICAgICAgLnBpcGUobWFwKCgpID0+IHJlc3VsdCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG9mKHJlc3VsdCk7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2VuZHMgZm9yZ290IHBhc3N3b3JkIHJlcXVlc3QgdG8gdGhlIHNlbGVjdGVkIHN0cmF0ZWd5XG4gICAgICpcbiAgICAgKiBFeGFtcGxlOlxuICAgICAqIHJlcXVlc3RQYXNzd29yZCgnZW1haWwnLCB7ZW1haWw6ICdlbWFpbEBleGFtcGxlLmNvbSd9KVxuICAgICAqXG4gICAgICogQHBhcmFtIHN0cmF0ZWd5TmFtZVxuICAgICAqIEBwYXJhbSBkYXRhXG4gICAgICogQHJldHVybnMge09ic2VydmFibGU8TmJBdXRoUmVzdWx0Pn1cbiAgICAgKi9cbiAgICByZXF1ZXN0UGFzc3dvcmQoc3RyYXRlZ3lOYW1lLCBkYXRhKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldFN0cmF0ZWd5KHN0cmF0ZWd5TmFtZSkucmVxdWVzdFBhc3N3b3JkKGRhdGEpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUcmllcyB0byByZXNldCBwYXNzd29yZCB3aXRoIHRoZSBzZWxlY3RlZCBzdHJhdGVneVxuICAgICAqXG4gICAgICogRXhhbXBsZTpcbiAgICAgKiByZXNldFBhc3N3b3JkKCdlbWFpbCcsIHtuZXdQYXNzd29yZDogJ3Rlc3QnfSlcbiAgICAgKlxuICAgICAqIEBwYXJhbSBzdHJhdGVneU5hbWVcbiAgICAgKiBAcGFyYW0gZGF0YVxuICAgICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlPE5iQXV0aFJlc3VsdD59XG4gICAgICovXG4gICAgcmVzZXRQYXNzd29yZChzdHJhdGVneU5hbWUsIGRhdGEpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0U3RyYXRlZ3koc3RyYXRlZ3lOYW1lKS5yZXNldFBhc3N3b3JkKGRhdGEpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZW5kcyBhIHJlZnJlc2ggdG9rZW4gcmVxdWVzdFxuICAgICAqIFN0b3JlcyByZWNlaXZlZCB0b2tlbiBpbiB0aGUgdG9rZW4gc3RvcmFnZVxuICAgICAqXG4gICAgICogRXhhbXBsZTpcbiAgICAgKiByZWZyZXNoVG9rZW4oJ2VtYWlsJywge3Rva2VuOiB0b2tlbn0pXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gc3RyYXRlZ3lOYW1lXG4gICAgICogQHBhcmFtIGRhdGFcbiAgICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZTxOYkF1dGhSZXN1bHQ+fVxuICAgICAqL1xuICAgIHJlZnJlc2hUb2tlbihzdHJhdGVneU5hbWUsIGRhdGEpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0U3RyYXRlZ3koc3RyYXRlZ3lOYW1lKS5yZWZyZXNoVG9rZW4oZGF0YSlcbiAgICAgICAgICAgIC5waXBlKHN3aXRjaE1hcCgocmVzdWx0KSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcm9jZXNzUmVzdWx0VG9rZW4ocmVzdWx0KTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXQgcmVnaXN0ZXJlZCBzdHJhdGVneSBieSBuYW1lXG4gICAgICpcbiAgICAgKiBFeGFtcGxlOlxuICAgICAqIGdldFN0cmF0ZWd5KCdlbWFpbCcpXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gcHJvdmlkZXJcbiAgICAgKiBAcmV0dXJucyB7TmJBYnN0cmFjdEF1dGhQcm92aWRlcn1cbiAgICAgKi9cbiAgICBnZXRTdHJhdGVneShzdHJhdGVneU5hbWUpIHtcbiAgICAgICAgY29uc3QgZm91bmQgPSB0aGlzLnN0cmF0ZWdpZXMuZmluZCgoc3RyYXRlZ3kpID0+IHN0cmF0ZWd5LmdldE5hbWUoKSA9PT0gc3RyYXRlZ3lOYW1lKTtcbiAgICAgICAgaWYgKCFmb3VuZCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihgVGhlcmUgaXMgbm8gQXV0aCBTdHJhdGVneSByZWdpc3RlcmVkIHVuZGVyICcke3N0cmF0ZWd5TmFtZX0nIG5hbWVgKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZm91bmQ7XG4gICAgfVxuICAgIHByb2Nlc3NSZXN1bHRUb2tlbihyZXN1bHQpIHtcbiAgICAgICAgaWYgKHJlc3VsdC5pc1N1Y2Nlc3MoKSAmJiByZXN1bHQuZ2V0VG9rZW4oKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMudG9rZW5TZXJ2aWNlLnNldChyZXN1bHQuZ2V0VG9rZW4oKSlcbiAgICAgICAgICAgICAgICAucGlwZShtYXAoKHRva2VuKSA9PiB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb2YocmVzdWx0KTtcbiAgICB9XG59O1xuTmJBdXRoU2VydmljZSA9IF9fZGVjb3JhdGUkMShbXG4gICAgSW5qZWN0YWJsZSgpLFxuICAgIF9fcGFyYW0oMSwgSW5qZWN0KE5CX0FVVEhfU1RSQVRFR0lFUykpLFxuICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246cGFyYW10eXBlc1wiLCBbTmJUb2tlblNlcnZpY2UsIE9iamVjdF0pXG5dLCBOYkF1dGhTZXJ2aWNlKTtcblxuY2xhc3MgTmJBdXRoU3RyYXRlZ3kge1xuICAgIC8vIHdlIHNob3VsZCBrZWVwIHRoaXMgYW55IGFuZCB2YWxpZGF0aW9uIHNob3VsZCBiZSBkb25lIGluIGByZWdpc3RlcmAgbWV0aG9kIGluc3RlYWRcbiAgICAvLyBvdGhlcndpc2UgaXQgd29uJ3QgYmUgcG9zc2libGUgdG8gcGFzcyBhbiBlbXB0eSBvYmplY3RcbiAgICBzZXRPcHRpb25zKG9wdGlvbnMpIHtcbiAgICAgICAgdGhpcy5vcHRpb25zID0gZGVlcEV4dGVuZCh7fSwgdGhpcy5kZWZhdWx0T3B0aW9ucywgb3B0aW9ucyk7XG4gICAgfVxuICAgIGdldE9wdGlvbihrZXkpIHtcbiAgICAgICAgcmV0dXJuIGdldERlZXBGcm9tT2JqZWN0KHRoaXMub3B0aW9ucywga2V5LCBudWxsKTtcbiAgICB9XG4gICAgY3JlYXRlVG9rZW4odmFsdWUsIGZhaWxXaGVuSW52YWxpZFRva2VuKSB7XG4gICAgICAgIGNvbnN0IHRva2VuID0gbmJBdXRoQ3JlYXRlVG9rZW4odGhpcy5nZXRPcHRpb24oJ3Rva2VuLmNsYXNzJyksIHZhbHVlLCB0aGlzLmdldE5hbWUoKSk7XG4gICAgICAgIC8vIEF0IHRoaXMgcG9pbnQsIG5iQXV0aENyZWF0ZVRva2VuIGZhaWxlZCB3aXRoIE5iQXV0aElsbGVnYWxUb2tlbkVycm9yIHdoaWNoIE1VU1QgYmUgaW50ZXJjZXB0ZWQgYnkgc3RyYXRlZ2llc1xuICAgICAgICAvLyBPciB0b2tlbiBpcyBjcmVhdGVkLiBJdCBNQVkgYmUgY3JlYXRlZCBldmVuIGlmIGJhY2tlbmQgZGlkIG5vdCByZXR1cm4gYW55IHRva2VuLCBpbiB0aGlzIGNhc2UgaXQgaXMgIVZhbGlkXG4gICAgICAgIGlmIChmYWlsV2hlbkludmFsaWRUb2tlbiAmJiAhdG9rZW4uaXNWYWxpZCgpKSB7XG4gICAgICAgICAgICAvLyBJZiB3ZSByZXF1aXJlIGEgdmFsaWQgdG9rZW4gKGkuZS4gaXNWYWxpZCksIHRoZW4gd2UgTVVTVCB0aHJvdyBOYkF1dGhJbGxlZ2FsVG9rZW5FcnJvciBzbyB0aGF0IHRoZSBzdHJhdGVnaWVzXG4gICAgICAgICAgICAvLyBpbnRlcmNlcHQgaXRcbiAgICAgICAgICAgIHRocm93IG5ldyBOYkF1dGhJbGxlZ2FsVG9rZW5FcnJvcignVG9rZW4gaXMgZW1wdHkgb3IgaW52YWxpZC4nKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdG9rZW47XG4gICAgfVxuICAgIGdldE5hbWUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldE9wdGlvbignbmFtZScpO1xuICAgIH1cbiAgICBjcmVhdGVGYWlsUmVzcG9uc2UoZGF0YSkge1xuICAgICAgICByZXR1cm4gbmV3IEh0dHBSZXNwb25zZSh7IGJvZHk6IHt9LCBzdGF0dXM6IDQwMSB9KTtcbiAgICB9XG4gICAgY3JlYXRlU3VjY2Vzc1Jlc3BvbnNlKGRhdGEpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBIdHRwUmVzcG9uc2UoeyBib2R5OiB7fSwgc3RhdHVzOiAyMDAgfSk7XG4gICAgfVxuICAgIGdldEFjdGlvbkVuZHBvaW50KGFjdGlvbikge1xuICAgICAgICBjb25zdCBhY3Rpb25FbmRwb2ludCA9IHRoaXMuZ2V0T3B0aW9uKGAke2FjdGlvbn0uZW5kcG9pbnRgKTtcbiAgICAgICAgY29uc3QgYmFzZUVuZHBvaW50ID0gdGhpcy5nZXRPcHRpb24oJ2Jhc2VFbmRwb2ludCcpO1xuICAgICAgICByZXR1cm4gYWN0aW9uRW5kcG9pbnQgPyBiYXNlRW5kcG9pbnQgKyBhY3Rpb25FbmRwb2ludCA6ICcnO1xuICAgIH1cbn1cblxuY2xhc3MgTmJBdXRoUmVzdWx0IHtcbiAgICAvLyBUT0RPOiBiZXR0ZXIgcGFzcyBvYmplY3RcbiAgICBjb25zdHJ1Y3RvcihzdWNjZXNzLCByZXNwb25zZSwgcmVkaXJlY3QsIGVycm9ycywgbWVzc2FnZXMsIHRva2VuID0gbnVsbCkge1xuICAgICAgICB0aGlzLnN1Y2Nlc3MgPSBzdWNjZXNzO1xuICAgICAgICB0aGlzLnJlc3BvbnNlID0gcmVzcG9uc2U7XG4gICAgICAgIHRoaXMucmVkaXJlY3QgPSByZWRpcmVjdDtcbiAgICAgICAgdGhpcy5lcnJvcnMgPSBbXTtcbiAgICAgICAgdGhpcy5tZXNzYWdlcyA9IFtdO1xuICAgICAgICB0aGlzLmVycm9ycyA9IHRoaXMuZXJyb3JzLmNvbmNhdChbZXJyb3JzXSk7XG4gICAgICAgIGlmIChlcnJvcnMgaW5zdGFuY2VvZiBBcnJheSkge1xuICAgICAgICAgICAgdGhpcy5lcnJvcnMgPSBlcnJvcnM7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tZXNzYWdlcyA9IHRoaXMubWVzc2FnZXMuY29uY2F0KFttZXNzYWdlc10pO1xuICAgICAgICBpZiAobWVzc2FnZXMgaW5zdGFuY2VvZiBBcnJheSkge1xuICAgICAgICAgICAgdGhpcy5tZXNzYWdlcyA9IG1lc3NhZ2VzO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMudG9rZW4gPSB0b2tlbjtcbiAgICB9XG4gICAgZ2V0UmVzcG9uc2UoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJlc3BvbnNlO1xuICAgIH1cbiAgICBnZXRUb2tlbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudG9rZW47XG4gICAgfVxuICAgIGdldFJlZGlyZWN0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5yZWRpcmVjdDtcbiAgICB9XG4gICAgZ2V0RXJyb3JzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5lcnJvcnMuZmlsdGVyKHZhbCA9PiAhIXZhbCk7XG4gICAgfVxuICAgIGdldE1lc3NhZ2VzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tZXNzYWdlcy5maWx0ZXIodmFsID0+ICEhdmFsKTtcbiAgICB9XG4gICAgaXNTdWNjZXNzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zdWNjZXNzO1xuICAgIH1cbiAgICBpc0ZhaWx1cmUoKSB7XG4gICAgICAgIHJldHVybiAhdGhpcy5zdWNjZXNzO1xuICAgIH1cbn1cblxuY2xhc3MgTmJBdXRoU3RyYXRlZ3lPcHRpb25zIHtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IEFrdmVvLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICogTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLiBTZWUgTGljZW5zZS50eHQgaW4gdGhlIHByb2plY3Qgcm9vdCBmb3IgbGljZW5zZSBpbmZvcm1hdGlvbi5cbiAqL1xuY2xhc3MgTmJEdW1teUF1dGhTdHJhdGVneU9wdGlvbnMgZXh0ZW5kcyBOYkF1dGhTdHJhdGVneU9wdGlvbnMge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlciguLi5hcmd1bWVudHMpO1xuICAgICAgICB0aGlzLnRva2VuID0ge1xuICAgICAgICAgICAgY2xhc3M6IE5iQXV0aFNpbXBsZVRva2VuLFxuICAgICAgICB9O1xuICAgICAgICB0aGlzLmRlbGF5ID0gMTAwMDtcbiAgICAgICAgdGhpcy5hbHdheXNGYWlsID0gZmFsc2U7XG4gICAgfVxufVxuY29uc3QgZHVtbXlTdHJhdGVneU9wdGlvbnMgPSBuZXcgTmJEdW1teUF1dGhTdHJhdGVneU9wdGlvbnMoKTtcblxudmFyIF9fZGVjb3JhdGUkNSA9ICh0aGlzICYmIHRoaXMuX19kZWNvcmF0ZSkgfHwgZnVuY3Rpb24gKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKSB7XG4gICAgdmFyIGMgPSBhcmd1bWVudHMubGVuZ3RoLCByID0gYyA8IDMgPyB0YXJnZXQgOiBkZXNjID09PSBudWxsID8gZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBrZXkpIDogZGVzYywgZDtcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QuZGVjb3JhdGUgPT09IFwiZnVuY3Rpb25cIikgciA9IFJlZmxlY3QuZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpO1xuICAgIGVsc2UgZm9yICh2YXIgaSA9IGRlY29yYXRvcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIGlmIChkID0gZGVjb3JhdG9yc1tpXSkgciA9IChjIDwgMyA/IGQocikgOiBjID4gMyA/IGQodGFyZ2V0LCBrZXksIHIpIDogZCh0YXJnZXQsIGtleSkpIHx8IHI7XG4gICAgcmV0dXJuIGMgPiAzICYmIHIgJiYgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCByKSwgcjtcbn07XG52YXIgTmJEdW1teUF1dGhTdHJhdGVneV8xO1xuLyoqXG4gKiBEdW1teSBhdXRoIHN0cmF0ZWd5LiBDb3VsZCBiZSB1c2VmdWwgZm9yIGF1dGggc2V0dXAgd2hlbiBiYWNrZW5kIGlzIG5vdCBhdmFpbGFibGUgeWV0LlxuICpcbiAqXG4gKiBTdHJhdGVneSBzZXR0aW5ncy5cbiAqXG4gKiBgYGB0c1xuICogZXhwb3J0IGNsYXNzIE5iRHVtbXlBdXRoU3RyYXRlZ3lPcHRpb25zIGV4dGVuZHMgTmJBdXRoU3RyYXRlZ3lPcHRpb25zIHtcbiAqICAgbmFtZSA9ICdkdW1teSc7XG4gKiAgIHRva2VuID0ge1xuICogICAgIGNsYXNzOiBOYkF1dGhTaW1wbGVUb2tlbixcbiAqICAgfTtcbiAqICAgZGVsYXk/ID0gMTAwMDtcbiAqICAgYWx3YXlzRmFpbD8gPSBmYWxzZTtcbiAqIH1cbiAqIGBgYFxuICovXG5sZXQgTmJEdW1teUF1dGhTdHJhdGVneSA9IE5iRHVtbXlBdXRoU3RyYXRlZ3lfMSA9IGNsYXNzIE5iRHVtbXlBdXRoU3RyYXRlZ3kgZXh0ZW5kcyBOYkF1dGhTdHJhdGVneSB7XG4gICAgLyoqXG4gICAgICogRHVtbXkgYXV0aCBzdHJhdGVneS4gQ291bGQgYmUgdXNlZnVsIGZvciBhdXRoIHNldHVwIHdoZW4gYmFja2VuZCBpcyBub3QgYXZhaWxhYmxlIHlldC5cbiAgICAgKlxuICAgICAqXG4gICAgICogU3RyYXRlZ3kgc2V0dGluZ3MuXG4gICAgICpcbiAgICAgKiBgYGB0c1xuICAgICAqIGV4cG9ydCBjbGFzcyBOYkR1bW15QXV0aFN0cmF0ZWd5T3B0aW9ucyBleHRlbmRzIE5iQXV0aFN0cmF0ZWd5T3B0aW9ucyB7XG4gICAgICogICBuYW1lID0gJ2R1bW15JztcbiAgICAgKiAgIHRva2VuID0ge1xuICAgICAqICAgICBjbGFzczogTmJBdXRoU2ltcGxlVG9rZW4sXG4gICAgICogICB9O1xuICAgICAqICAgZGVsYXk/ID0gMTAwMDtcbiAgICAgKiAgIGFsd2F5c0ZhaWw/ID0gZmFsc2U7XG4gICAgICogfVxuICAgICAqIGBgYFxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlciguLi5hcmd1bWVudHMpO1xuICAgICAgICB0aGlzLmRlZmF1bHRPcHRpb25zID0gZHVtbXlTdHJhdGVneU9wdGlvbnM7XG4gICAgfVxuICAgIHN0YXRpYyBzZXR1cChvcHRpb25zKSB7XG4gICAgICAgIHJldHVybiBbTmJEdW1teUF1dGhTdHJhdGVneV8xLCBvcHRpb25zXTtcbiAgICB9XG4gICAgYXV0aGVudGljYXRlKGRhdGEpIHtcbiAgICAgICAgcmV0dXJuIG9mKHRoaXMuY3JlYXRlRHVtbXlSZXN1bHQoZGF0YSkpXG4gICAgICAgICAgICAucGlwZShkZWxheSh0aGlzLmdldE9wdGlvbignZGVsYXknKSkpO1xuICAgIH1cbiAgICByZWdpc3RlcihkYXRhKSB7XG4gICAgICAgIHJldHVybiBvZih0aGlzLmNyZWF0ZUR1bW15UmVzdWx0KGRhdGEpKVxuICAgICAgICAgICAgLnBpcGUoZGVsYXkodGhpcy5nZXRPcHRpb24oJ2RlbGF5JykpKTtcbiAgICB9XG4gICAgcmVxdWVzdFBhc3N3b3JkKGRhdGEpIHtcbiAgICAgICAgcmV0dXJuIG9mKHRoaXMuY3JlYXRlRHVtbXlSZXN1bHQoZGF0YSkpXG4gICAgICAgICAgICAucGlwZShkZWxheSh0aGlzLmdldE9wdGlvbignZGVsYXknKSkpO1xuICAgIH1cbiAgICByZXNldFBhc3N3b3JkKGRhdGEpIHtcbiAgICAgICAgcmV0dXJuIG9mKHRoaXMuY3JlYXRlRHVtbXlSZXN1bHQoZGF0YSkpXG4gICAgICAgICAgICAucGlwZShkZWxheSh0aGlzLmdldE9wdGlvbignZGVsYXknKSkpO1xuICAgIH1cbiAgICBsb2dvdXQoZGF0YSkge1xuICAgICAgICByZXR1cm4gb2YodGhpcy5jcmVhdGVEdW1teVJlc3VsdChkYXRhKSlcbiAgICAgICAgICAgIC5waXBlKGRlbGF5KHRoaXMuZ2V0T3B0aW9uKCdkZWxheScpKSk7XG4gICAgfVxuICAgIHJlZnJlc2hUb2tlbihkYXRhKSB7XG4gICAgICAgIHJldHVybiBvZih0aGlzLmNyZWF0ZUR1bW15UmVzdWx0KGRhdGEpKVxuICAgICAgICAgICAgLnBpcGUoZGVsYXkodGhpcy5nZXRPcHRpb24oJ2RlbGF5JykpKTtcbiAgICB9XG4gICAgY3JlYXRlRHVtbXlSZXN1bHQoZGF0YSkge1xuICAgICAgICBpZiAodGhpcy5nZXRPcHRpb24oJ2Fsd2F5c0ZhaWwnKSkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBOYkF1dGhSZXN1bHQoZmFsc2UsIHRoaXMuY3JlYXRlRmFpbFJlc3BvbnNlKGRhdGEpLCBudWxsLCBbJ1NvbWV0aGluZyB3ZW50IHdyb25nLiddKTtcbiAgICAgICAgfVxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgdG9rZW4gPSB0aGlzLmNyZWF0ZVRva2VuKCd0ZXN0IHRva2VuJywgdHJ1ZSk7XG4gICAgICAgICAgICByZXR1cm4gbmV3IE5iQXV0aFJlc3VsdCh0cnVlLCB0aGlzLmNyZWF0ZVN1Y2Nlc3NSZXNwb25zZShkYXRhKSwgJy8nLCBbXSwgWydTdWNjZXNzZnVsbHkgbG9nZ2VkIGluLiddLCB0b2tlbik7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBOYkF1dGhSZXN1bHQoZmFsc2UsIHRoaXMuY3JlYXRlRmFpbFJlc3BvbnNlKGRhdGEpLCBudWxsLCBbZXJyLm1lc3NhZ2VdKTtcbiAgICAgICAgfVxuICAgIH1cbn07XG5OYkR1bW15QXV0aFN0cmF0ZWd5ID0gTmJEdW1teUF1dGhTdHJhdGVneV8xID0gX19kZWNvcmF0ZSQ1KFtcbiAgICBJbmplY3RhYmxlKClcbl0sIE5iRHVtbXlBdXRoU3RyYXRlZ3kpO1xuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgQWt2ZW8uIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIExpY2Vuc2UuIFNlZSBMaWNlbnNlLnR4dCBpbiB0aGUgcHJvamVjdCByb290IGZvciBsaWNlbnNlIGluZm9ybWF0aW9uLlxuICovXG52YXIgTmJPQXV0aDJSZXNwb25zZVR5cGU7XG4oZnVuY3Rpb24gKE5iT0F1dGgyUmVzcG9uc2VUeXBlKSB7XG4gICAgTmJPQXV0aDJSZXNwb25zZVR5cGVbXCJDT0RFXCJdID0gXCJjb2RlXCI7XG4gICAgTmJPQXV0aDJSZXNwb25zZVR5cGVbXCJUT0tFTlwiXSA9IFwidG9rZW5cIjtcbn0pKE5iT0F1dGgyUmVzcG9uc2VUeXBlIHx8IChOYk9BdXRoMlJlc3BvbnNlVHlwZSA9IHt9KSk7XG4vLyBUT0RPOiBjbGllbnRfY3JlZGVudGlhbHNcbnZhciBOYk9BdXRoMkdyYW50VHlwZTtcbihmdW5jdGlvbiAoTmJPQXV0aDJHcmFudFR5cGUpIHtcbiAgICBOYk9BdXRoMkdyYW50VHlwZVtcIkFVVEhPUklaQVRJT05fQ09ERVwiXSA9IFwiYXV0aG9yaXphdGlvbl9jb2RlXCI7XG4gICAgTmJPQXV0aDJHcmFudFR5cGVbXCJQQVNTV09SRFwiXSA9IFwicGFzc3dvcmRcIjtcbiAgICBOYk9BdXRoMkdyYW50VHlwZVtcIlJFRlJFU0hfVE9LRU5cIl0gPSBcInJlZnJlc2hfdG9rZW5cIjtcbn0pKE5iT0F1dGgyR3JhbnRUeXBlIHx8IChOYk9BdXRoMkdyYW50VHlwZSA9IHt9KSk7XG52YXIgTmJPQXV0aDJDbGllbnRBdXRoTWV0aG9kO1xuKGZ1bmN0aW9uIChOYk9BdXRoMkNsaWVudEF1dGhNZXRob2QpIHtcbiAgICBOYk9BdXRoMkNsaWVudEF1dGhNZXRob2RbXCJOT05FXCJdID0gXCJub25lXCI7XG4gICAgTmJPQXV0aDJDbGllbnRBdXRoTWV0aG9kW1wiQkFTSUNcIl0gPSBcImJhc2ljXCI7XG4gICAgTmJPQXV0aDJDbGllbnRBdXRoTWV0aG9kW1wiUkVRVUVTVF9CT0RZXCJdID0gXCJyZXF1ZXN0LWJvZHlcIjtcbn0pKE5iT0F1dGgyQ2xpZW50QXV0aE1ldGhvZCB8fCAoTmJPQXV0aDJDbGllbnRBdXRoTWV0aG9kID0ge30pKTtcbmNsYXNzIE5iT0F1dGgyQXV0aFN0cmF0ZWd5T3B0aW9ucyBleHRlbmRzIE5iQXV0aFN0cmF0ZWd5T3B0aW9ucyB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHN1cGVyKC4uLmFyZ3VtZW50cyk7XG4gICAgICAgIHRoaXMuYmFzZUVuZHBvaW50ID0gJyc7XG4gICAgICAgIHRoaXMuY2xpZW50SWQgPSAnJztcbiAgICAgICAgdGhpcy5jbGllbnRTZWNyZXQgPSAnJztcbiAgICAgICAgdGhpcy5jbGllbnRBdXRoTWV0aG9kID0gTmJPQXV0aDJDbGllbnRBdXRoTWV0aG9kLk5PTkU7XG4gICAgICAgIHRoaXMucmVkaXJlY3QgPSB7XG4gICAgICAgICAgICBzdWNjZXNzOiAnLycsXG4gICAgICAgICAgICBmYWlsdXJlOiBudWxsLFxuICAgICAgICB9O1xuICAgICAgICB0aGlzLmRlZmF1bHRFcnJvcnMgPSBbJ1NvbWV0aGluZyB3ZW50IHdyb25nLCBwbGVhc2UgdHJ5IGFnYWluLiddO1xuICAgICAgICB0aGlzLmRlZmF1bHRNZXNzYWdlcyA9IFsnWW91IGhhdmUgYmVlbiBzdWNjZXNzZnVsbHkgYXV0aGVudGljYXRlZC4nXTtcbiAgICAgICAgdGhpcy5hdXRob3JpemUgPSB7XG4gICAgICAgICAgICBlbmRwb2ludDogJ2F1dGhvcml6ZScsXG4gICAgICAgICAgICByZXNwb25zZVR5cGU6IE5iT0F1dGgyUmVzcG9uc2VUeXBlLkNPREUsXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMudG9rZW4gPSB7XG4gICAgICAgICAgICBlbmRwb2ludDogJ3Rva2VuJyxcbiAgICAgICAgICAgIGdyYW50VHlwZTogTmJPQXV0aDJHcmFudFR5cGUuQVVUSE9SSVpBVElPTl9DT0RFLFxuICAgICAgICAgICAgcmVxdWlyZVZhbGlkVG9rZW46IGZhbHNlLFxuICAgICAgICAgICAgY2xhc3M6IE5iQXV0aE9BdXRoMlRva2VuLFxuICAgICAgICB9O1xuICAgICAgICB0aGlzLnJlZnJlc2ggPSB7XG4gICAgICAgICAgICBlbmRwb2ludDogJ3Rva2VuJyxcbiAgICAgICAgICAgIGdyYW50VHlwZTogTmJPQXV0aDJHcmFudFR5cGUuUkVGUkVTSF9UT0tFTixcbiAgICAgICAgfTtcbiAgICB9XG59XG5jb25zdCBhdXRoMlN0cmF0ZWd5T3B0aW9ucyA9IG5ldyBOYk9BdXRoMkF1dGhTdHJhdGVneU9wdGlvbnMoKTtcblxudmFyIF9fZGVjb3JhdGUkNiA9ICh0aGlzICYmIHRoaXMuX19kZWNvcmF0ZSkgfHwgZnVuY3Rpb24gKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKSB7XG4gICAgdmFyIGMgPSBhcmd1bWVudHMubGVuZ3RoLCByID0gYyA8IDMgPyB0YXJnZXQgOiBkZXNjID09PSBudWxsID8gZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBrZXkpIDogZGVzYywgZDtcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QuZGVjb3JhdGUgPT09IFwiZnVuY3Rpb25cIikgciA9IFJlZmxlY3QuZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpO1xuICAgIGVsc2UgZm9yICh2YXIgaSA9IGRlY29yYXRvcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIGlmIChkID0gZGVjb3JhdG9yc1tpXSkgciA9IChjIDwgMyA/IGQocikgOiBjID4gMyA/IGQodGFyZ2V0LCBrZXksIHIpIDogZCh0YXJnZXQsIGtleSkpIHx8IHI7XG4gICAgcmV0dXJuIGMgPiAzICYmIHIgJiYgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCByKSwgcjtcbn07XG52YXIgX19tZXRhZGF0YSQ0ID0gKHRoaXMgJiYgdGhpcy5fX21ldGFkYXRhKSB8fCBmdW5jdGlvbiAoaywgdikge1xuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5tZXRhZGF0YSA9PT0gXCJmdW5jdGlvblwiKSByZXR1cm4gUmVmbGVjdC5tZXRhZGF0YShrLCB2KTtcbn07XG52YXIgX19wYXJhbSQyID0gKHRoaXMgJiYgdGhpcy5fX3BhcmFtKSB8fCBmdW5jdGlvbiAocGFyYW1JbmRleCwgZGVjb3JhdG9yKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YXJnZXQsIGtleSkgeyBkZWNvcmF0b3IodGFyZ2V0LCBrZXksIHBhcmFtSW5kZXgpOyB9XG59O1xudmFyIE5iT0F1dGgyQXV0aFN0cmF0ZWd5XzE7XG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgQWt2ZW8uIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIExpY2Vuc2UuIFNlZSBMaWNlbnNlLnR4dCBpbiB0aGUgcHJvamVjdCByb290IGZvciBsaWNlbnNlIGluZm9ybWF0aW9uLlxuICovXG4vKipcbiAqIE9BdXRoMiBhdXRoZW50aWNhdGlvbiBzdHJhdGVneS5cbiAqXG4gKiBTdHJhdGVneSBzZXR0aW5nczpcbiAqXG4gKiBgYGB0c1xuICogZXhwb3J0IGVudW0gTmJPQXV0aDJSZXNwb25zZVR5cGUge1xuICogICBDT0RFID0gJ2NvZGUnLFxuICogICBUT0tFTiA9ICd0b2tlbicsXG4gKiB9XG4gKlxuICogZXhwb3J0IGVudW0gTmJPQXV0aDJHcmFudFR5cGUge1xuICogICBBVVRIT1JJWkFUSU9OX0NPREUgPSAnYXV0aG9yaXphdGlvbl9jb2RlJyxcbiAqICAgUEFTU1dPUkQgPSAncGFzc3dvcmQnLFxuICogICBSRUZSRVNIX1RPS0VOID0gJ3JlZnJlc2hfdG9rZW4nLFxuICogfVxuICpcbiAqIGV4cG9ydCBjbGFzcyBOYk9BdXRoMkF1dGhTdHJhdGVneU9wdGlvbnMge1xuICogICBuYW1lOiBzdHJpbmc7XG4gKiAgIGJhc2VFbmRwb2ludD86IHN0cmluZyA9ICcnO1xuICogICBjbGllbnRJZDogc3RyaW5nID0gJyc7XG4gKiAgIGNsaWVudFNlY3JldDogc3RyaW5nID0gJyc7XG4gKiAgIGNsaWVudEF1dGhNZXRob2Q6IHN0cmluZyA9IE5iT0F1dGgyQ2xpZW50QXV0aE1ldGhvZC5OT05FO1xuICogICByZWRpcmVjdD86IHsgc3VjY2Vzcz86IHN0cmluZzsgZmFpbHVyZT86IHN0cmluZyB9ID0ge1xuICogICAgIHN1Y2Nlc3M6ICcvJyxcbiAqICAgICBmYWlsdXJlOiBudWxsLFxuICogICB9O1xuICogICBkZWZhdWx0RXJyb3JzPzogYW55W10gPSBbJ1NvbWV0aGluZyB3ZW50IHdyb25nLCBwbGVhc2UgdHJ5IGFnYWluLiddO1xuICogICBkZWZhdWx0TWVzc2FnZXM/OiBhbnlbXSA9IFsnWW91IGhhdmUgYmVlbiBzdWNjZXNzZnVsbHkgYXV0aGVudGljYXRlZC4nXTtcbiAqICAgYXV0aG9yaXplPzoge1xuICogICAgIGVuZHBvaW50Pzogc3RyaW5nO1xuICogICAgIHJlZGlyZWN0VXJpPzogc3RyaW5nO1xuICogICAgIHJlc3BvbnNlVHlwZT86IHN0cmluZztcbiAqICAgICByZXF1aXJlVmFsaWRUb2tlbjogZmFsc2UsXG4gKiAgICAgc2NvcGU/OiBzdHJpbmc7XG4gKiAgICAgc3RhdGU/OiBzdHJpbmc7XG4gKiAgICAgcGFyYW1zPzogeyBba2V5OiBzdHJpbmddOiBzdHJpbmcgfTtcbiAqICAgfSA9IHtcbiAqICAgICBlbmRwb2ludDogJ2F1dGhvcml6ZScsXG4gKiAgICAgcmVzcG9uc2VUeXBlOiBOYk9BdXRoMlJlc3BvbnNlVHlwZS5DT0RFLFxuICogICB9O1xuICogICB0b2tlbj86IHtcbiAqICAgICBlbmRwb2ludD86IHN0cmluZztcbiAqICAgICBncmFudFR5cGU/OiBzdHJpbmc7XG4gKiAgICAgcmVxdWlyZVZhbGlkVG9rZW46IGZhbHNlLFxuICogICAgIHJlZGlyZWN0VXJpPzogc3RyaW5nO1xuICogICAgIHNjb3BlPzogc3RyaW5nO1xuICogICAgIGNsYXNzOiBOYkF1dGhUb2tlbkNsYXNzLFxuICogICB9ID0ge1xuICogICAgIGVuZHBvaW50OiAndG9rZW4nLFxuICogICAgIGdyYW50VHlwZTogTmJPQXV0aDJHcmFudFR5cGUuQVVUSE9SSVpBVElPTl9DT0RFLFxuICogICAgIGNsYXNzOiBOYkF1dGhPQXV0aDJUb2tlbixcbiAqICAgfTtcbiAqICAgcmVmcmVzaD86IHtcbiAqICAgICBlbmRwb2ludD86IHN0cmluZztcbiAqICAgICBncmFudFR5cGU/OiBzdHJpbmc7XG4gKiAgICAgc2NvcGU/OiBzdHJpbmc7XG4gKiAgICAgcmVxdWlyZVZhbGlkVG9rZW46IGZhbHNlLFxuICogICB9ID0ge1xuICogICAgIGVuZHBvaW50OiAndG9rZW4nLFxuICogICAgIGdyYW50VHlwZTogTmJPQXV0aDJHcmFudFR5cGUuUkVGUkVTSF9UT0tFTixcbiAqICAgfTtcbiAqIH1cbiAqIGBgYFxuICpcbiAqL1xubGV0IE5iT0F1dGgyQXV0aFN0cmF0ZWd5ID0gTmJPQXV0aDJBdXRoU3RyYXRlZ3lfMSA9IGNsYXNzIE5iT0F1dGgyQXV0aFN0cmF0ZWd5IGV4dGVuZHMgTmJBdXRoU3RyYXRlZ3kge1xuICAgIGNvbnN0cnVjdG9yKGh0dHAsIHJvdXRlLCB3aW5kb3cpIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5odHRwID0gaHR0cDtcbiAgICAgICAgdGhpcy5yb3V0ZSA9IHJvdXRlO1xuICAgICAgICB0aGlzLndpbmRvdyA9IHdpbmRvdztcbiAgICAgICAgdGhpcy5yZWRpcmVjdFJlc3VsdEhhbmRsZXJzID0ge1xuICAgICAgICAgICAgW05iT0F1dGgyUmVzcG9uc2VUeXBlLkNPREVdOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG9mKHRoaXMucm91dGUuc25hcHNob3QucXVlcnlQYXJhbXMpLnBpcGUoc3dpdGNoTWFwKChwYXJhbXMpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBhcmFtcy5jb2RlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5yZXF1ZXN0VG9rZW4ocGFyYW1zLmNvZGUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBvZihuZXcgTmJBdXRoUmVzdWx0KGZhbHNlLCBwYXJhbXMsIHRoaXMuZ2V0T3B0aW9uKCdyZWRpcmVjdC5mYWlsdXJlJyksIHRoaXMuZ2V0T3B0aW9uKCdkZWZhdWx0RXJyb3JzJyksIFtdKSk7XG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIFtOYk9BdXRoMlJlc3BvbnNlVHlwZS5UT0tFTl06ICgpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBtb2R1bGUgPSAnYXV0aG9yaXplJztcbiAgICAgICAgICAgICAgICBjb25zdCByZXF1aXJlVmFsaWRUb2tlbiA9IHRoaXMuZ2V0T3B0aW9uKGAke21vZHVsZX0ucmVxdWlyZVZhbGlkVG9rZW5gKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gb2YodGhpcy5yb3V0ZS5zbmFwc2hvdC5mcmFnbWVudCkucGlwZShtYXAoZnJhZ21lbnQgPT4gdGhpcy5wYXJzZUhhc2hBc1F1ZXJ5UGFyYW1zKGZyYWdtZW50KSksIG1hcCgocGFyYW1zKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghcGFyYW1zLmVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IE5iQXV0aFJlc3VsdCh0cnVlLCBwYXJhbXMsIHRoaXMuZ2V0T3B0aW9uKCdyZWRpcmVjdC5zdWNjZXNzJyksIFtdLCB0aGlzLmdldE9wdGlvbignZGVmYXVsdE1lc3NhZ2VzJyksIHRoaXMuY3JlYXRlVG9rZW4ocGFyYW1zLCByZXF1aXJlVmFsaWRUb2tlbikpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgTmJBdXRoUmVzdWx0KGZhbHNlLCBwYXJhbXMsIHRoaXMuZ2V0T3B0aW9uKCdyZWRpcmVjdC5mYWlsdXJlJyksIHRoaXMuZ2V0T3B0aW9uKCdkZWZhdWx0RXJyb3JzJyksIFtdKTtcbiAgICAgICAgICAgICAgICB9KSwgY2F0Y2hFcnJvcihlcnIgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBlcnJvcnMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGVyciBpbnN0YW5jZW9mIE5iQXV0aElsbGVnYWxUb2tlbkVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcnMucHVzaChlcnIubWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcnMucHVzaCgnU29tZXRoaW5nIHdlbnQgd3JvbmcuJyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9mKG5ldyBOYkF1dGhSZXN1bHQoZmFsc2UsIGVyciwgdGhpcy5nZXRPcHRpb24oJ3JlZGlyZWN0LmZhaWx1cmUnKSwgZXJyb3JzKSk7XG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5yZWRpcmVjdFJlc3VsdHMgPSB7XG4gICAgICAgICAgICBbTmJPQXV0aDJSZXNwb25zZVR5cGUuQ09ERV06ICgpID0+IHtcbiAgICAgICAgICAgICAgICByZXR1cm4gb2YodGhpcy5yb3V0ZS5zbmFwc2hvdC5xdWVyeVBhcmFtcykucGlwZShtYXAoKHBhcmFtcykgPT4gISEocGFyYW1zICYmIChwYXJhbXMuY29kZSB8fCBwYXJhbXMuZXJyb3IpKSkpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIFtOYk9BdXRoMlJlc3BvbnNlVHlwZS5UT0tFTl06ICgpID0+IHtcbiAgICAgICAgICAgICAgICByZXR1cm4gb2YodGhpcy5yb3V0ZS5zbmFwc2hvdC5mcmFnbWVudCkucGlwZShtYXAoZnJhZ21lbnQgPT4gdGhpcy5wYXJzZUhhc2hBc1F1ZXJ5UGFyYW1zKGZyYWdtZW50KSksIG1hcCgocGFyYW1zKSA9PiAhIShwYXJhbXMgJiYgKHBhcmFtcy5hY2Nlc3NfdG9rZW4gfHwgcGFyYW1zLmVycm9yKSkpKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuZGVmYXVsdE9wdGlvbnMgPSBhdXRoMlN0cmF0ZWd5T3B0aW9ucztcbiAgICB9XG4gICAgc3RhdGljIHNldHVwKG9wdGlvbnMpIHtcbiAgICAgICAgcmV0dXJuIFtOYk9BdXRoMkF1dGhTdHJhdGVneV8xLCBvcHRpb25zXTtcbiAgICB9XG4gICAgZ2V0IHJlc3BvbnNlVHlwZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0T3B0aW9uKCdhdXRob3JpemUucmVzcG9uc2VUeXBlJyk7XG4gICAgfVxuICAgIGdldCBjbGllbnRBdXRoTWV0aG9kKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRPcHRpb24oJ2NsaWVudEF1dGhNZXRob2QnKTtcbiAgICB9XG4gICAgYXV0aGVudGljYXRlKGRhdGEpIHtcbiAgICAgICAgaWYgKHRoaXMuZ2V0T3B0aW9uKCd0b2tlbi5ncmFudFR5cGUnKSA9PT0gTmJPQXV0aDJHcmFudFR5cGUuUEFTU1dPUkQpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnBhc3N3b3JkVG9rZW4oZGF0YS5lbWFpbCwgZGF0YS5wYXNzd29yZCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5pc1JlZGlyZWN0UmVzdWx0KClcbiAgICAgICAgICAgICAgICAucGlwZShzd2l0Y2hNYXAoKHJlc3VsdCkgPT4ge1xuICAgICAgICAgICAgICAgIGlmICghcmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYXV0aG9yaXplUmVkaXJlY3QoKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9mKG5ldyBOYkF1dGhSZXN1bHQodHJ1ZSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRBdXRob3JpemF0aW9uUmVzdWx0KCk7XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZ2V0QXV0aG9yaXphdGlvblJlc3VsdCgpIHtcbiAgICAgICAgY29uc3QgcmVkaXJlY3RSZXN1bHRIYW5kbGVyID0gdGhpcy5yZWRpcmVjdFJlc3VsdEhhbmRsZXJzW3RoaXMucmVzcG9uc2VUeXBlXTtcbiAgICAgICAgaWYgKHJlZGlyZWN0UmVzdWx0SGFuZGxlcikge1xuICAgICAgICAgICAgcmV0dXJuIHJlZGlyZWN0UmVzdWx0SGFuZGxlci5jYWxsKHRoaXMpO1xuICAgICAgICB9XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgJyR7dGhpcy5yZXNwb25zZVR5cGV9JyByZXNwb25zZVR5cGUgaXMgbm90IHN1cHBvcnRlZCxcbiAgICAgICAgICAgICAgICAgICAgICBvbmx5ICd0b2tlbicgYW5kICdjb2RlJyBhcmUgc3VwcG9ydGVkIG5vd2ApO1xuICAgIH1cbiAgICByZWZyZXNoVG9rZW4odG9rZW4pIHtcbiAgICAgICAgY29uc3QgbW9kdWxlID0gJ3JlZnJlc2gnO1xuICAgICAgICBjb25zdCB1cmwgPSB0aGlzLmdldEFjdGlvbkVuZHBvaW50KG1vZHVsZSk7XG4gICAgICAgIGNvbnN0IHJlcXVpcmVWYWxpZFRva2VuID0gdGhpcy5nZXRPcHRpb24oYCR7bW9kdWxlfS5yZXF1aXJlVmFsaWRUb2tlbmApO1xuICAgICAgICBsZXQgaGVhZGVycyA9IHRoaXMuYnVpbGRBdXRoSGVhZGVyKCkgfHwgbmV3IEh0dHBIZWFkZXJzKCk7XG4gICAgICAgIGhlYWRlcnMgPSBoZWFkZXJzLmFwcGVuZCgnQ29udGVudC1UeXBlJywgJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCcpO1xuICAgICAgICByZXR1cm4gdGhpcy5odHRwLnBvc3QodXJsLCB0aGlzLmJ1aWxkUmVmcmVzaFJlcXVlc3REYXRhKHRva2VuKSwgeyBoZWFkZXJzOiBoZWFkZXJzIH0pXG4gICAgICAgICAgICAucGlwZShtYXAoKHJlcykgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBOYkF1dGhSZXN1bHQodHJ1ZSwgcmVzLCB0aGlzLmdldE9wdGlvbigncmVkaXJlY3Quc3VjY2VzcycpLCBbXSwgdGhpcy5nZXRPcHRpb24oJ2RlZmF1bHRNZXNzYWdlcycpLCB0aGlzLmNyZWF0ZVJlZnJlc2hlZFRva2VuKHJlcywgdG9rZW4sIHJlcXVpcmVWYWxpZFRva2VuKSk7XG4gICAgICAgIH0pLCBjYXRjaEVycm9yKChyZXMpID0+IHRoaXMuaGFuZGxlUmVzcG9uc2VFcnJvcihyZXMpKSk7XG4gICAgfVxuICAgIHBhc3N3b3JkVG9rZW4odXNlcm5hbWUsIHBhc3N3b3JkKSB7XG4gICAgICAgIGNvbnN0IG1vZHVsZSA9ICd0b2tlbic7XG4gICAgICAgIGNvbnN0IHVybCA9IHRoaXMuZ2V0QWN0aW9uRW5kcG9pbnQobW9kdWxlKTtcbiAgICAgICAgY29uc3QgcmVxdWlyZVZhbGlkVG9rZW4gPSB0aGlzLmdldE9wdGlvbihgJHttb2R1bGV9LnJlcXVpcmVWYWxpZFRva2VuYCk7XG4gICAgICAgIGxldCBoZWFkZXJzID0gdGhpcy5idWlsZEF1dGhIZWFkZXIoKSB8fCBuZXcgSHR0cEhlYWRlcnMoKTtcbiAgICAgICAgaGVhZGVycyA9IGhlYWRlcnMuYXBwZW5kKCdDb250ZW50LVR5cGUnLCAnYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkJyk7XG4gICAgICAgIHJldHVybiB0aGlzLmh0dHAucG9zdCh1cmwsIHRoaXMuYnVpbGRQYXNzd29yZFJlcXVlc3REYXRhKHVzZXJuYW1lLCBwYXNzd29yZCksIHsgaGVhZGVyczogaGVhZGVycyB9KVxuICAgICAgICAgICAgLnBpcGUobWFwKChyZXMpID0+IHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgTmJBdXRoUmVzdWx0KHRydWUsIHJlcywgdGhpcy5nZXRPcHRpb24oJ3JlZGlyZWN0LnN1Y2Nlc3MnKSwgW10sIHRoaXMuZ2V0T3B0aW9uKCdkZWZhdWx0TWVzc2FnZXMnKSwgdGhpcy5jcmVhdGVUb2tlbihyZXMsIHJlcXVpcmVWYWxpZFRva2VuKSk7XG4gICAgICAgIH0pLCBjYXRjaEVycm9yKChyZXMpID0+IHRoaXMuaGFuZGxlUmVzcG9uc2VFcnJvcihyZXMpKSk7XG4gICAgfVxuICAgIGF1dGhvcml6ZVJlZGlyZWN0KCkge1xuICAgICAgICB0aGlzLndpbmRvdy5sb2NhdGlvbi5ocmVmID0gdGhpcy5idWlsZFJlZGlyZWN0VXJsKCk7XG4gICAgfVxuICAgIGlzUmVkaXJlY3RSZXN1bHQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJlZGlyZWN0UmVzdWx0c1t0aGlzLnJlc3BvbnNlVHlwZV0uY2FsbCh0aGlzKTtcbiAgICB9XG4gICAgcmVxdWVzdFRva2VuKGNvZGUpIHtcbiAgICAgICAgY29uc3QgbW9kdWxlID0gJ3Rva2VuJztcbiAgICAgICAgY29uc3QgdXJsID0gdGhpcy5nZXRBY3Rpb25FbmRwb2ludChtb2R1bGUpO1xuICAgICAgICBjb25zdCByZXF1aXJlVmFsaWRUb2tlbiA9IHRoaXMuZ2V0T3B0aW9uKGAke21vZHVsZX0ucmVxdWlyZVZhbGlkVG9rZW5gKTtcbiAgICAgICAgbGV0IGhlYWRlcnMgPSB0aGlzLmJ1aWxkQXV0aEhlYWRlcigpIHx8IG5ldyBIdHRwSGVhZGVycygpO1xuICAgICAgICBoZWFkZXJzID0gaGVhZGVycy5hcHBlbmQoJ0NvbnRlbnQtVHlwZScsICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQnKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuaHR0cC5wb3N0KHVybCwgdGhpcy5idWlsZENvZGVSZXF1ZXN0RGF0YShjb2RlKSwgeyBoZWFkZXJzOiBoZWFkZXJzIH0pXG4gICAgICAgICAgICAucGlwZShtYXAoKHJlcykgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBOYkF1dGhSZXN1bHQodHJ1ZSwgcmVzLCB0aGlzLmdldE9wdGlvbigncmVkaXJlY3Quc3VjY2VzcycpLCBbXSwgdGhpcy5nZXRPcHRpb24oJ2RlZmF1bHRNZXNzYWdlcycpLCB0aGlzLmNyZWF0ZVRva2VuKHJlcywgcmVxdWlyZVZhbGlkVG9rZW4pKTtcbiAgICAgICAgfSksIGNhdGNoRXJyb3IoKHJlcykgPT4gdGhpcy5oYW5kbGVSZXNwb25zZUVycm9yKHJlcykpKTtcbiAgICB9XG4gICAgYnVpbGRDb2RlUmVxdWVzdERhdGEoY29kZSkge1xuICAgICAgICBjb25zdCBwYXJhbXMgPSB7XG4gICAgICAgICAgICBncmFudF90eXBlOiB0aGlzLmdldE9wdGlvbigndG9rZW4uZ3JhbnRUeXBlJyksXG4gICAgICAgICAgICBjb2RlOiBjb2RlLFxuICAgICAgICAgICAgcmVkaXJlY3RfdXJpOiB0aGlzLmdldE9wdGlvbigndG9rZW4ucmVkaXJlY3RVcmknKSxcbiAgICAgICAgICAgIGNsaWVudF9pZDogdGhpcy5nZXRPcHRpb24oJ2NsaWVudElkJyksXG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiB0aGlzLnVybEVuY29kZVBhcmFtZXRlcnModGhpcy5jbGVhblBhcmFtcyh0aGlzLmFkZENyZWRlbnRpYWxzVG9QYXJhbXMocGFyYW1zKSkpO1xuICAgIH1cbiAgICBidWlsZFJlZnJlc2hSZXF1ZXN0RGF0YSh0b2tlbikge1xuICAgICAgICBjb25zdCBwYXJhbXMgPSB7XG4gICAgICAgICAgICBncmFudF90eXBlOiB0aGlzLmdldE9wdGlvbigncmVmcmVzaC5ncmFudFR5cGUnKSxcbiAgICAgICAgICAgIHJlZnJlc2hfdG9rZW46IHRva2VuLmdldFJlZnJlc2hUb2tlbigpLFxuICAgICAgICAgICAgc2NvcGU6IHRoaXMuZ2V0T3B0aW9uKCdyZWZyZXNoLnNjb3BlJyksXG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiB0aGlzLnVybEVuY29kZVBhcmFtZXRlcnModGhpcy5jbGVhblBhcmFtcyh0aGlzLmFkZENyZWRlbnRpYWxzVG9QYXJhbXMocGFyYW1zKSkpO1xuICAgIH1cbiAgICBidWlsZFBhc3N3b3JkUmVxdWVzdERhdGEodXNlcm5hbWUsIHBhc3N3b3JkKSB7XG4gICAgICAgIGNvbnN0IHBhcmFtcyA9IHtcbiAgICAgICAgICAgIGdyYW50X3R5cGU6IHRoaXMuZ2V0T3B0aW9uKCd0b2tlbi5ncmFudFR5cGUnKSxcbiAgICAgICAgICAgIHVzZXJuYW1lOiB1c2VybmFtZSxcbiAgICAgICAgICAgIHBhc3N3b3JkOiBwYXNzd29yZCxcbiAgICAgICAgICAgIHNjb3BlOiB0aGlzLmdldE9wdGlvbigndG9rZW4uc2NvcGUnKSxcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIHRoaXMudXJsRW5jb2RlUGFyYW1ldGVycyh0aGlzLmNsZWFuUGFyYW1zKHRoaXMuYWRkQ3JlZGVudGlhbHNUb1BhcmFtcyhwYXJhbXMpKSk7XG4gICAgfVxuICAgIGJ1aWxkQXV0aEhlYWRlcigpIHtcbiAgICAgICAgaWYgKHRoaXMuY2xpZW50QXV0aE1ldGhvZCA9PT0gTmJPQXV0aDJDbGllbnRBdXRoTWV0aG9kLkJBU0lDKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5nZXRPcHRpb24oJ2NsaWVudElkJykgJiYgdGhpcy5nZXRPcHRpb24oJ2NsaWVudFNlY3JldCcpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBIdHRwSGVhZGVycyh7XG4gICAgICAgICAgICAgICAgICAgICdBdXRob3JpemF0aW9uJzogJ0Jhc2ljICcgKyBidG9hKHRoaXMuZ2V0T3B0aW9uKCdjbGllbnRJZCcpICsgJzonICsgdGhpcy5nZXRPcHRpb24oJ2NsaWVudFNlY3JldCcpKSxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRocm93IEVycm9yKCdGb3IgYmFzaWMgY2xpZW50IGF1dGhlbnRpY2F0aW9uIG1ldGhvZCwgcGxlYXNlIHByb3ZpZGUgYm90aCBjbGllbnRJZCAmIGNsaWVudFNlY3JldC4nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBjbGVhblBhcmFtcyhwYXJhbXMpIHtcbiAgICAgICAgT2JqZWN0LmVudHJpZXMocGFyYW1zKVxuICAgICAgICAgICAgLmZvckVhY2goKFtrZXksIHZhbF0pID0+ICF2YWwgJiYgZGVsZXRlIHBhcmFtc1trZXldKTtcbiAgICAgICAgcmV0dXJuIHBhcmFtcztcbiAgICB9XG4gICAgYWRkQ3JlZGVudGlhbHNUb1BhcmFtcyhwYXJhbXMpIHtcbiAgICAgICAgaWYgKHRoaXMuY2xpZW50QXV0aE1ldGhvZCA9PT0gTmJPQXV0aDJDbGllbnRBdXRoTWV0aG9kLlJFUVVFU1RfQk9EWSkge1xuICAgICAgICAgICAgaWYgKHRoaXMuZ2V0T3B0aW9uKCdjbGllbnRJZCcpICYmIHRoaXMuZ2V0T3B0aW9uKCdjbGllbnRTZWNyZXQnKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKHt9LCBwYXJhbXMsIHsgY2xpZW50X2lkOiB0aGlzLmdldE9wdGlvbignY2xpZW50SWQnKSwgY2xpZW50X3NlY3JldDogdGhpcy5nZXRPcHRpb24oJ2NsaWVudFNlY3JldCcpIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgRXJyb3IoJ0ZvciByZXF1ZXN0IGJvZHkgY2xpZW50IGF1dGhlbnRpY2F0aW9uIG1ldGhvZCwgcGxlYXNlIHByb3ZpZGUgYm90aCBjbGllbnRJZCAmIGNsaWVudFNlY3JldC4nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcGFyYW1zO1xuICAgIH1cbiAgICBoYW5kbGVSZXNwb25zZUVycm9yKHJlcykge1xuICAgICAgICBsZXQgZXJyb3JzID0gW107XG4gICAgICAgIGlmIChyZXMgaW5zdGFuY2VvZiBIdHRwRXJyb3JSZXNwb25zZSkge1xuICAgICAgICAgICAgaWYgKHJlcy5lcnJvci5lcnJvcl9kZXNjcmlwdGlvbikge1xuICAgICAgICAgICAgICAgIGVycm9ycy5wdXNoKHJlcy5lcnJvci5lcnJvcl9kZXNjcmlwdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBlcnJvcnMgPSB0aGlzLmdldE9wdGlvbignZGVmYXVsdEVycm9ycycpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHJlcyBpbnN0YW5jZW9mIE5iQXV0aElsbGVnYWxUb2tlbkVycm9yKSB7XG4gICAgICAgICAgICBlcnJvcnMucHVzaChyZXMubWVzc2FnZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBlcnJvcnMucHVzaCgnU29tZXRoaW5nIHdlbnQgd3JvbmcuJyk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiBvZihuZXcgTmJBdXRoUmVzdWx0KGZhbHNlLCByZXMsIHRoaXMuZ2V0T3B0aW9uKCdyZWRpcmVjdC5mYWlsdXJlJyksIGVycm9ycywgW10pKTtcbiAgICB9XG4gICAgYnVpbGRSZWRpcmVjdFVybCgpIHtcbiAgICAgICAgY29uc3QgcGFyYW1zID0gT2JqZWN0LmFzc2lnbih7IHJlc3BvbnNlX3R5cGU6IHRoaXMuZ2V0T3B0aW9uKCdhdXRob3JpemUucmVzcG9uc2VUeXBlJyksIGNsaWVudF9pZDogdGhpcy5nZXRPcHRpb24oJ2NsaWVudElkJyksIHJlZGlyZWN0X3VyaTogdGhpcy5nZXRPcHRpb24oJ2F1dGhvcml6ZS5yZWRpcmVjdFVyaScpLCBzY29wZTogdGhpcy5nZXRPcHRpb24oJ2F1dGhvcml6ZS5zY29wZScpLCBzdGF0ZTogdGhpcy5nZXRPcHRpb24oJ2F1dGhvcml6ZS5zdGF0ZScpIH0sIHRoaXMuZ2V0T3B0aW9uKCdhdXRob3JpemUucGFyYW1zJykpO1xuICAgICAgICBjb25zdCBlbmRwb2ludCA9IHRoaXMuZ2V0QWN0aW9uRW5kcG9pbnQoJ2F1dGhvcml6ZScpO1xuICAgICAgICBjb25zdCBxdWVyeSA9IHRoaXMudXJsRW5jb2RlUGFyYW1ldGVycyh0aGlzLmNsZWFuUGFyYW1zKHBhcmFtcykpO1xuICAgICAgICByZXR1cm4gYCR7ZW5kcG9pbnR9PyR7cXVlcnl9YDtcbiAgICB9XG4gICAgcGFyc2VIYXNoQXNRdWVyeVBhcmFtcyhoYXNoKSB7XG4gICAgICAgIHJldHVybiBoYXNoID8gaGFzaC5zcGxpdCgnJicpLnJlZHVjZSgoYWNjLCBwYXJ0KSA9PiB7XG4gICAgICAgICAgICBjb25zdCBpdGVtID0gcGFydC5zcGxpdCgnPScpO1xuICAgICAgICAgICAgYWNjW2l0ZW1bMF1dID0gZGVjb2RlVVJJQ29tcG9uZW50KGl0ZW1bMV0pO1xuICAgICAgICAgICAgcmV0dXJuIGFjYztcbiAgICAgICAgfSwge30pIDoge307XG4gICAgfVxuICAgIHVybEVuY29kZVBhcmFtZXRlcnMocGFyYW1zKSB7XG4gICAgICAgIHJldHVybiBPYmplY3Qua2V5cyhwYXJhbXMpLm1hcCgoaykgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIGAke2VuY29kZVVSSUNvbXBvbmVudChrKX09JHtlbmNvZGVVUklDb21wb25lbnQocGFyYW1zW2tdKX1gO1xuICAgICAgICB9KS5qb2luKCcmJyk7XG4gICAgfVxuICAgIGNyZWF0ZVJlZnJlc2hlZFRva2VuKHJlcywgZXhpc3RpbmdUb2tlbiwgcmVxdWlyZVZhbGlkVG9rZW4pIHtcbiAgICAgICAgY29uc3QgcmVmcmVzaGVkVG9rZW4gPSB0aGlzLmNyZWF0ZVRva2VuKHJlcywgcmVxdWlyZVZhbGlkVG9rZW4pO1xuICAgICAgICBpZiAoIXJlZnJlc2hlZFRva2VuLmdldFJlZnJlc2hUb2tlbigpICYmIGV4aXN0aW5nVG9rZW4uZ2V0UmVmcmVzaFRva2VuKCkpIHtcbiAgICAgICAgICAgIHJlZnJlc2hlZFRva2VuLnNldFJlZnJlc2hUb2tlbihleGlzdGluZ1Rva2VuLmdldFJlZnJlc2hUb2tlbigpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVmcmVzaGVkVG9rZW47XG4gICAgfVxuICAgIHJlZ2lzdGVyKGRhdGEpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdgcmVnaXN0ZXJgIGlzIG5vdCBzdXBwb3J0ZWQgYnkgYE5iT0F1dGgyQXV0aFN0cmF0ZWd5YCwgdXNlIGBhdXRoZW50aWNhdGVgLicpO1xuICAgIH1cbiAgICByZXF1ZXN0UGFzc3dvcmQoZGF0YSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2ByZXF1ZXN0UGFzc3dvcmRgIGlzIG5vdCBzdXBwb3J0ZWQgYnkgYE5iT0F1dGgyQXV0aFN0cmF0ZWd5YCwgdXNlIGBhdXRoZW50aWNhdGVgLicpO1xuICAgIH1cbiAgICByZXNldFBhc3N3b3JkKGRhdGEgPSB7fSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2ByZXNldFBhc3N3b3JkYCBpcyBub3Qgc3VwcG9ydGVkIGJ5IGBOYk9BdXRoMkF1dGhTdHJhdGVneWAsIHVzZSBgYXV0aGVudGljYXRlYC4nKTtcbiAgICB9XG4gICAgbG9nb3V0KCkge1xuICAgICAgICByZXR1cm4gb2YobmV3IE5iQXV0aFJlc3VsdCh0cnVlKSk7XG4gICAgfVxufTtcbk5iT0F1dGgyQXV0aFN0cmF0ZWd5ID0gTmJPQXV0aDJBdXRoU3RyYXRlZ3lfMSA9IF9fZGVjb3JhdGUkNihbXG4gICAgSW5qZWN0YWJsZSgpLFxuICAgIF9fcGFyYW0kMigyLCBJbmplY3QoTkJfV0lORE9XKSksXG4gICAgX19tZXRhZGF0YSQ0KFwiZGVzaWduOnBhcmFtdHlwZXNcIiwgW0h0dHBDbGllbnQsXG4gICAgICAgIEFjdGl2YXRlZFJvdXRlLCBPYmplY3RdKVxuXSwgTmJPQXV0aDJBdXRoU3RyYXRlZ3kpO1xuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgQWt2ZW8uIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIExpY2Vuc2UuIFNlZSBMaWNlbnNlLnR4dCBpbiB0aGUgcHJvamVjdCByb290IGZvciBsaWNlbnNlIGluZm9ybWF0aW9uLlxuICovXG5jbGFzcyBOYlBhc3N3b3JkQXV0aFN0cmF0ZWd5T3B0aW9ucyBleHRlbmRzIE5iQXV0aFN0cmF0ZWd5T3B0aW9ucyB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHN1cGVyKC4uLmFyZ3VtZW50cyk7XG4gICAgICAgIHRoaXMuYmFzZUVuZHBvaW50ID0gJy9hcGkvYXV0aC8nO1xuICAgICAgICB0aGlzLmxvZ2luID0ge1xuICAgICAgICAgICAgYWx3YXlzRmFpbDogZmFsc2UsXG4gICAgICAgICAgICBlbmRwb2ludDogJ2xvZ2luJyxcbiAgICAgICAgICAgIG1ldGhvZDogJ3Bvc3QnLFxuICAgICAgICAgICAgcmVxdWlyZVZhbGlkVG9rZW46IGZhbHNlLFxuICAgICAgICAgICAgcmVkaXJlY3Q6IHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiAnLycsXG4gICAgICAgICAgICAgICAgZmFpbHVyZTogbnVsbCxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBkZWZhdWx0RXJyb3JzOiBbJ0xvZ2luL0VtYWlsIGNvbWJpbmF0aW9uIGlzIG5vdCBjb3JyZWN0LCBwbGVhc2UgdHJ5IGFnYWluLiddLFxuICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2VzOiBbJ1lvdSBoYXZlIGJlZW4gc3VjY2Vzc2Z1bGx5IGxvZ2dlZCBpbi4nXSxcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5yZWdpc3RlciA9IHtcbiAgICAgICAgICAgIGFsd2F5c0ZhaWw6IGZhbHNlLFxuICAgICAgICAgICAgZW5kcG9pbnQ6ICdyZWdpc3RlcicsXG4gICAgICAgICAgICBtZXRob2Q6ICdwb3N0JyxcbiAgICAgICAgICAgIHJlcXVpcmVWYWxpZFRva2VuOiBmYWxzZSxcbiAgICAgICAgICAgIHJlZGlyZWN0OiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogJy8nLFxuICAgICAgICAgICAgICAgIGZhaWx1cmU6IG51bGwsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZGVmYXVsdEVycm9yczogWydTb21ldGhpbmcgd2VudCB3cm9uZywgcGxlYXNlIHRyeSBhZ2Fpbi4nXSxcbiAgICAgICAgICAgIGRlZmF1bHRNZXNzYWdlczogWydZb3UgaGF2ZSBiZWVuIHN1Y2Nlc3NmdWxseSByZWdpc3RlcmVkLiddLFxuICAgICAgICB9O1xuICAgICAgICB0aGlzLnJlcXVlc3RQYXNzID0ge1xuICAgICAgICAgICAgZW5kcG9pbnQ6ICdyZXF1ZXN0LXBhc3MnLFxuICAgICAgICAgICAgbWV0aG9kOiAncG9zdCcsXG4gICAgICAgICAgICByZWRpcmVjdDoge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6ICcvJyxcbiAgICAgICAgICAgICAgICBmYWlsdXJlOiBudWxsLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGRlZmF1bHRFcnJvcnM6IFsnU29tZXRoaW5nIHdlbnQgd3JvbmcsIHBsZWFzZSB0cnkgYWdhaW4uJ10sXG4gICAgICAgICAgICBkZWZhdWx0TWVzc2FnZXM6IFsnUmVzZXQgcGFzc3dvcmQgaW5zdHJ1Y3Rpb25zIGhhdmUgYmVlbiBzZW50IHRvIHlvdXIgZW1haWwuJ10sXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMucmVzZXRQYXNzID0ge1xuICAgICAgICAgICAgZW5kcG9pbnQ6ICdyZXNldC1wYXNzJyxcbiAgICAgICAgICAgIG1ldGhvZDogJ3B1dCcsXG4gICAgICAgICAgICByZWRpcmVjdDoge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6ICcvJyxcbiAgICAgICAgICAgICAgICBmYWlsdXJlOiBudWxsLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJlc2V0UGFzc3dvcmRUb2tlbktleTogJ3Jlc2V0X3Bhc3N3b3JkX3Rva2VuJyxcbiAgICAgICAgICAgIGRlZmF1bHRFcnJvcnM6IFsnU29tZXRoaW5nIHdlbnQgd3JvbmcsIHBsZWFzZSB0cnkgYWdhaW4uJ10sXG4gICAgICAgICAgICBkZWZhdWx0TWVzc2FnZXM6IFsnWW91ciBwYXNzd29yZCBoYXMgYmVlbiBzdWNjZXNzZnVsbHkgY2hhbmdlZC4nXSxcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5sb2dvdXQgPSB7XG4gICAgICAgICAgICBhbHdheXNGYWlsOiBmYWxzZSxcbiAgICAgICAgICAgIGVuZHBvaW50OiAnbG9nb3V0JyxcbiAgICAgICAgICAgIG1ldGhvZDogJ2RlbGV0ZScsXG4gICAgICAgICAgICByZWRpcmVjdDoge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6ICcvJyxcbiAgICAgICAgICAgICAgICBmYWlsdXJlOiBudWxsLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGRlZmF1bHRFcnJvcnM6IFsnU29tZXRoaW5nIHdlbnQgd3JvbmcsIHBsZWFzZSB0cnkgYWdhaW4uJ10sXG4gICAgICAgICAgICBkZWZhdWx0TWVzc2FnZXM6IFsnWW91IGhhdmUgYmVlbiBzdWNjZXNzZnVsbHkgbG9nZ2VkIG91dC4nXSxcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5yZWZyZXNoVG9rZW4gPSB7XG4gICAgICAgICAgICBlbmRwb2ludDogJ3JlZnJlc2gtdG9rZW4nLFxuICAgICAgICAgICAgbWV0aG9kOiAncG9zdCcsXG4gICAgICAgICAgICByZXF1aXJlVmFsaWRUb2tlbjogZmFsc2UsXG4gICAgICAgICAgICByZWRpcmVjdDoge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IG51bGwsXG4gICAgICAgICAgICAgICAgZmFpbHVyZTogbnVsbCxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBkZWZhdWx0RXJyb3JzOiBbJ1NvbWV0aGluZyB3ZW50IHdyb25nLCBwbGVhc2UgdHJ5IGFnYWluLiddLFxuICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2VzOiBbJ1lvdXIgdG9rZW4gaGFzIGJlZW4gc3VjY2Vzc2Z1bGx5IHJlZnJlc2hlZC4nXSxcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy50b2tlbiA9IHtcbiAgICAgICAgICAgIGNsYXNzOiBOYkF1dGhTaW1wbGVUb2tlbixcbiAgICAgICAgICAgIGtleTogJ2RhdGEudG9rZW4nLFxuICAgICAgICAgICAgZ2V0dGVyOiAobW9kdWxlLCByZXMsIG9wdGlvbnMpID0+IGdldERlZXBGcm9tT2JqZWN0KHJlcy5ib2R5LCBvcHRpb25zLnRva2VuLmtleSksXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuZXJyb3JzID0ge1xuICAgICAgICAgICAga2V5OiAnZGF0YS5lcnJvcnMnLFxuICAgICAgICAgICAgZ2V0dGVyOiAobW9kdWxlLCByZXMsIG9wdGlvbnMpID0+IGdldERlZXBGcm9tT2JqZWN0KHJlcy5lcnJvciwgb3B0aW9ucy5lcnJvcnMua2V5LCBvcHRpb25zW21vZHVsZV0uZGVmYXVsdEVycm9ycyksXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMubWVzc2FnZXMgPSB7XG4gICAgICAgICAgICBrZXk6ICdkYXRhLm1lc3NhZ2VzJyxcbiAgICAgICAgICAgIGdldHRlcjogKG1vZHVsZSwgcmVzLCBvcHRpb25zKSA9PiBnZXREZWVwRnJvbU9iamVjdChyZXMuYm9keSwgb3B0aW9ucy5tZXNzYWdlcy5rZXksIG9wdGlvbnNbbW9kdWxlXS5kZWZhdWx0TWVzc2FnZXMpLFxuICAgICAgICB9O1xuICAgIH1cbn1cbmNvbnN0IHBhc3N3b3JkU3RyYXRlZ3lPcHRpb25zID0gbmV3IE5iUGFzc3dvcmRBdXRoU3RyYXRlZ3lPcHRpb25zKCk7XG5cbnZhciBfX2RlY29yYXRlJDcgPSAodGhpcyAmJiB0aGlzLl9fZGVjb3JhdGUpIHx8IGZ1bmN0aW9uIChkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYykge1xuICAgIHZhciBjID0gYXJndW1lbnRzLmxlbmd0aCwgciA9IGMgPCAzID8gdGFyZ2V0IDogZGVzYyA9PT0gbnVsbCA/IGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHRhcmdldCwga2V5KSA6IGRlc2MsIGQ7XG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0LmRlY29yYXRlID09PSBcImZ1bmN0aW9uXCIpIHIgPSBSZWZsZWN0LmRlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKTtcbiAgICBlbHNlIGZvciAodmFyIGkgPSBkZWNvcmF0b3JzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSBpZiAoZCA9IGRlY29yYXRvcnNbaV0pIHIgPSAoYyA8IDMgPyBkKHIpIDogYyA+IDMgPyBkKHRhcmdldCwga2V5LCByKSA6IGQodGFyZ2V0LCBrZXkpKSB8fCByO1xuICAgIHJldHVybiBjID4gMyAmJiByICYmIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgciksIHI7XG59O1xudmFyIF9fbWV0YWRhdGEkNSA9ICh0aGlzICYmIHRoaXMuX19tZXRhZGF0YSkgfHwgZnVuY3Rpb24gKGssIHYpIHtcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QubWV0YWRhdGEgPT09IFwiZnVuY3Rpb25cIikgcmV0dXJuIFJlZmxlY3QubWV0YWRhdGEoaywgdik7XG59O1xudmFyIE5iUGFzc3dvcmRBdXRoU3RyYXRlZ3lfMTtcbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCBBa3Zlby4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS4gU2VlIExpY2Vuc2UudHh0IGluIHRoZSBwcm9qZWN0IHJvb3QgZm9yIGxpY2Vuc2UgaW5mb3JtYXRpb24uXG4gKi9cbi8qKlxuICogVGhlIG1vc3QgY29tbW9uIGF1dGhlbnRpY2F0aW9uIHByb3ZpZGVyIGZvciBlbWFpbC9wYXNzd29yZCBzdHJhdGVneS5cbiAqXG4gKiBTdHJhdGVneSBzZXR0aW5ncy4gTm90ZSwgdGhlcmUgaXMgbm8gbmVlZCB0byBjb3B5IG92ZXIgdGhlIHdob2xlIG9iamVjdCB0byBjaGFuZ2UgdGhlIHNldHRpbmdzIHlvdSBuZWVkLlxuICogQWxzbywgdGhpcy5nZXRPcHRpb24gY2FsbCB3b24ndCB3b3JrIG91dHNpZGUgb2YgdGhlIGRlZmF1bHQgb3B0aW9ucyBkZWNsYXJhdGlvblxuICogKHdoaWNoIGlzIGluc2lkZSBvZiB0aGUgYE5iUGFzc3dvcmRBdXRoU3RyYXRlZ3lgIGNsYXNzKSwgc28geW91IGhhdmUgdG8gcmVwbGFjZSBpdCB3aXRoIGEgY3VzdG9tIGhlbHBlciBmdW5jdGlvblxuICogaWYgeW91IG5lZWQgaXQuXG4gKlxuICogYGBgdHNcbiAqZXhwb3J0IGNsYXNzIE5iUGFzc3dvcmRBdXRoU3RyYXRlZ3lPcHRpb25zIGV4dGVuZHMgTmJBdXRoU3RyYXRlZ3lPcHRpb25zIHtcbiAqICBuYW1lOiBzdHJpbmc7XG4gKiAgYmFzZUVuZHBvaW50PyA9ICcvYXBpL2F1dGgvJztcbiAqICBsb2dpbj86IGJvb2xlYW4gfCBOYlBhc3N3b3JkU3RyYXRlZ3lNb2R1bGUgPSB7XG4gKiAgICBhbHdheXNGYWlsOiBmYWxzZSxcbiAqICAgIGVuZHBvaW50OiAnbG9naW4nLFxuICogICAgbWV0aG9kOiAncG9zdCcsXG4gKiAgICByZXF1aXJlVmFsaWRUb2tlbjogZmFsc2UsXG4gKiAgICByZWRpcmVjdDoge1xuICogICAgICBzdWNjZXNzOiAnLycsXG4gKiAgICAgIGZhaWx1cmU6IG51bGwsXG4gKiAgICB9LFxuICogICAgZGVmYXVsdEVycm9yczogWydMb2dpbi9FbWFpbCBjb21iaW5hdGlvbiBpcyBub3QgY29ycmVjdCwgcGxlYXNlIHRyeSBhZ2Fpbi4nXSxcbiAqICAgIGRlZmF1bHRNZXNzYWdlczogWydZb3UgaGF2ZSBiZWVuIHN1Y2Nlc3NmdWxseSBsb2dnZWQgaW4uJ10sXG4gKiAgfTtcbiAqICByZWdpc3Rlcj86IGJvb2xlYW4gfCBOYlBhc3N3b3JkU3RyYXRlZ3lNb2R1bGUgPSB7XG4gKiAgICBhbHdheXNGYWlsOiBmYWxzZSxcbiAqICAgIGVuZHBvaW50OiAncmVnaXN0ZXInLFxuICogICAgbWV0aG9kOiAncG9zdCcsXG4gKiAgICByZXF1aXJlVmFsaWRUb2tlbjogZmFsc2UsXG4gKiAgICByZWRpcmVjdDoge1xuICogICAgICBzdWNjZXNzOiAnLycsXG4gKiAgICAgIGZhaWx1cmU6IG51bGwsXG4gKiAgICB9LFxuICogICAgZGVmYXVsdEVycm9yczogWydTb21ldGhpbmcgd2VudCB3cm9uZywgcGxlYXNlIHRyeSBhZ2Fpbi4nXSxcbiAqICAgIGRlZmF1bHRNZXNzYWdlczogWydZb3UgaGF2ZSBiZWVuIHN1Y2Nlc3NmdWxseSByZWdpc3RlcmVkLiddLFxuICogIH07XG4gKiAgcmVxdWVzdFBhc3M/OiBib29sZWFuIHwgTmJQYXNzd29yZFN0cmF0ZWd5TW9kdWxlID0ge1xuICogICAgZW5kcG9pbnQ6ICdyZXF1ZXN0LXBhc3MnLFxuICogICAgbWV0aG9kOiAncG9zdCcsXG4gKiAgICByZWRpcmVjdDoge1xuICogICAgICBzdWNjZXNzOiAnLycsXG4gKiAgICAgIGZhaWx1cmU6IG51bGwsXG4gKiAgICB9LFxuICogICAgZGVmYXVsdEVycm9yczogWydTb21ldGhpbmcgd2VudCB3cm9uZywgcGxlYXNlIHRyeSBhZ2Fpbi4nXSxcbiAqICAgIGRlZmF1bHRNZXNzYWdlczogWydSZXNldCBwYXNzd29yZCBpbnN0cnVjdGlvbnMgaGF2ZSBiZWVuIHNlbnQgdG8geW91ciBlbWFpbC4nXSxcbiAqICB9O1xuICogIHJlc2V0UGFzcz86IGJvb2xlYW4gfCBOYlBhc3N3b3JkU3RyYXRlZ3lSZXNldCA9IHtcbiAqICAgIGVuZHBvaW50OiAncmVzZXQtcGFzcycsXG4gKiAgICBtZXRob2Q6ICdwdXQnLFxuICogICAgcmVkaXJlY3Q6IHtcbiAqICAgICAgc3VjY2VzczogJy8nLFxuICogICAgICBmYWlsdXJlOiBudWxsLFxuICogICAgfSxcbiAqICAgIHJlc2V0UGFzc3dvcmRUb2tlbktleTogJ3Jlc2V0X3Bhc3N3b3JkX3Rva2VuJyxcbiAqICAgIGRlZmF1bHRFcnJvcnM6IFsnU29tZXRoaW5nIHdlbnQgd3JvbmcsIHBsZWFzZSB0cnkgYWdhaW4uJ10sXG4gKiAgICBkZWZhdWx0TWVzc2FnZXM6IFsnWW91ciBwYXNzd29yZCBoYXMgYmVlbiBzdWNjZXNzZnVsbHkgY2hhbmdlZC4nXSxcbiAqICB9O1xuICogIGxvZ291dD86IGJvb2xlYW4gfCBOYlBhc3N3b3JkU3RyYXRlZ3lSZXNldCA9IHtcbiAqICAgIGFsd2F5c0ZhaWw6IGZhbHNlLFxuICogICAgZW5kcG9pbnQ6ICdsb2dvdXQnLFxuICogICAgbWV0aG9kOiAnZGVsZXRlJyxcbiAqICAgIHJlZGlyZWN0OiB7XG4gKiAgICAgIHN1Y2Nlc3M6ICcvJyxcbiAqICAgICAgZmFpbHVyZTogbnVsbCxcbiAqICAgIH0sXG4gKiAgICBkZWZhdWx0RXJyb3JzOiBbJ1NvbWV0aGluZyB3ZW50IHdyb25nLCBwbGVhc2UgdHJ5IGFnYWluLiddLFxuICogICAgZGVmYXVsdE1lc3NhZ2VzOiBbJ1lvdSBoYXZlIGJlZW4gc3VjY2Vzc2Z1bGx5IGxvZ2dlZCBvdXQuJ10sXG4gKiAgfTtcbiAqICByZWZyZXNoVG9rZW4/OiBib29sZWFuIHwgTmJQYXNzd29yZFN0cmF0ZWd5TW9kdWxlID0ge1xuICogICAgZW5kcG9pbnQ6ICdyZWZyZXNoLXRva2VuJyxcbiAqICAgIG1ldGhvZDogJ3Bvc3QnLFxuICogICAgcmVxdWlyZVZhbGlkVG9rZW46IGZhbHNlLFxuICogICAgcmVkaXJlY3Q6IHtcbiAqICAgICAgc3VjY2VzczogbnVsbCxcbiAqICAgICAgZmFpbHVyZTogbnVsbCxcbiAqICAgIH0sXG4gKiAgICBkZWZhdWx0RXJyb3JzOiBbJ1NvbWV0aGluZyB3ZW50IHdyb25nLCBwbGVhc2UgdHJ5IGFnYWluLiddLFxuICogICAgZGVmYXVsdE1lc3NhZ2VzOiBbJ1lvdXIgdG9rZW4gaGFzIGJlZW4gc3VjY2Vzc2Z1bGx5IHJlZnJlc2hlZC4nXSxcbiAqICB9O1xuICogIHRva2VuPzogTmJQYXNzd29yZFN0cmF0ZWd5VG9rZW4gPSB7XG4gKiAgICBjbGFzczogTmJBdXRoU2ltcGxlVG9rZW4sXG4gKiAgICBrZXk6ICdkYXRhLnRva2VuJyxcbiAqICAgIGdldHRlcjogKG1vZHVsZTogc3RyaW5nLCByZXM6IEh0dHBSZXNwb25zZTxPYmplY3Q+LCBvcHRpb25zOiBOYlBhc3N3b3JkQXV0aFN0cmF0ZWd5T3B0aW9ucykgPT4gZ2V0RGVlcEZyb21PYmplY3QoXG4gKiAgICAgIHJlcy5ib2R5LFxuICogICAgICBvcHRpb25zLnRva2VuLmtleSxcbiAqICAgICksXG4gKiAgfTtcbiAqICBlcnJvcnM/OiBOYlBhc3N3b3JkU3RyYXRlZ3lNZXNzYWdlID0ge1xuICogICAga2V5OiAnZGF0YS5lcnJvcnMnLFxuICogICAgZ2V0dGVyOiAobW9kdWxlOiBzdHJpbmcsIHJlczogSHR0cEVycm9yUmVzcG9uc2UsIG9wdGlvbnM6IE5iUGFzc3dvcmRBdXRoU3RyYXRlZ3lPcHRpb25zKSA9PiBnZXREZWVwRnJvbU9iamVjdChcbiAqICAgICAgcmVzLmVycm9yLFxuICogICAgICBvcHRpb25zLmVycm9ycy5rZXksXG4gKiAgICAgIG9wdGlvbnNbbW9kdWxlXS5kZWZhdWx0RXJyb3JzLFxuICogICAgKSxcbiAqICB9O1xuICogIG1lc3NhZ2VzPzogTmJQYXNzd29yZFN0cmF0ZWd5TWVzc2FnZSA9IHtcbiAqICAgIGtleTogJ2RhdGEubWVzc2FnZXMnLFxuICogICAgZ2V0dGVyOiAobW9kdWxlOiBzdHJpbmcsIHJlczogSHR0cFJlc3BvbnNlPE9iamVjdD4sIG9wdGlvbnM6IE5iUGFzc3dvcmRBdXRoU3RyYXRlZ3lPcHRpb25zKSA9PiBnZXREZWVwRnJvbU9iamVjdChcbiAqICAgICAgcmVzLmJvZHksXG4gKiAgICAgIG9wdGlvbnMubWVzc2FnZXMua2V5LFxuICogICAgICBvcHRpb25zW21vZHVsZV0uZGVmYXVsdE1lc3NhZ2VzLFxuICogICAgKSxcbiAqICB9O1xuICogIHZhbGlkYXRpb24/OiB7XG4gKiAgICBwYXNzd29yZD86IHtcbiAqICAgICAgcmVxdWlyZWQ/OiBib29sZWFuO1xuICogICAgICBtaW5MZW5ndGg/OiBudW1iZXIgfCBudWxsO1xuICogICAgICBtYXhMZW5ndGg/OiBudW1iZXIgfCBudWxsO1xuICogICAgICByZWdleHA/OiBzdHJpbmcgfCBudWxsO1xuICogICAgfTtcbiAqICAgIGVtYWlsPzoge1xuICogICAgICByZXF1aXJlZD86IGJvb2xlYW47XG4gKiAgICAgIHJlZ2V4cD86IHN0cmluZyB8IG51bGw7XG4gKiAgICB9O1xuICogICAgZnVsbE5hbWU/OiB7XG4gKiAgICAgIHJlcXVpcmVkPzogYm9vbGVhbjtcbiAqICAgICAgbWluTGVuZ3RoPzogbnVtYmVyIHwgbnVsbDtcbiAqICAgICAgbWF4TGVuZ3RoPzogbnVtYmVyIHwgbnVsbDtcbiAqICAgICAgcmVnZXhwPzogc3RyaW5nIHwgbnVsbDtcbiAqICAgIH07XG4gKiAgfTtcbiAqfVxuICogYGBgXG4gKi9cbmxldCBOYlBhc3N3b3JkQXV0aFN0cmF0ZWd5ID0gTmJQYXNzd29yZEF1dGhTdHJhdGVneV8xID0gY2xhc3MgTmJQYXNzd29yZEF1dGhTdHJhdGVneSBleHRlbmRzIE5iQXV0aFN0cmF0ZWd5IHtcbiAgICBjb25zdHJ1Y3RvcihodHRwLCByb3V0ZSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLmh0dHAgPSBodHRwO1xuICAgICAgICB0aGlzLnJvdXRlID0gcm91dGU7XG4gICAgICAgIHRoaXMuZGVmYXVsdE9wdGlvbnMgPSBwYXNzd29yZFN0cmF0ZWd5T3B0aW9ucztcbiAgICB9XG4gICAgc3RhdGljIHNldHVwKG9wdGlvbnMpIHtcbiAgICAgICAgcmV0dXJuIFtOYlBhc3N3b3JkQXV0aFN0cmF0ZWd5XzEsIG9wdGlvbnNdO1xuICAgIH1cbiAgICBhdXRoZW50aWNhdGUoZGF0YSkge1xuICAgICAgICBjb25zdCBtb2R1bGUgPSAnbG9naW4nO1xuICAgICAgICBjb25zdCBtZXRob2QgPSB0aGlzLmdldE9wdGlvbihgJHttb2R1bGV9Lm1ldGhvZGApO1xuICAgICAgICBjb25zdCB1cmwgPSB0aGlzLmdldEFjdGlvbkVuZHBvaW50KG1vZHVsZSk7XG4gICAgICAgIGNvbnN0IHJlcXVpcmVWYWxpZFRva2VuID0gdGhpcy5nZXRPcHRpb24oYCR7bW9kdWxlfS5yZXF1aXJlVmFsaWRUb2tlbmApO1xuICAgICAgICByZXR1cm4gdGhpcy5odHRwLnJlcXVlc3QobWV0aG9kLCB1cmwsIHsgYm9keTogZGF0YSwgb2JzZXJ2ZTogJ3Jlc3BvbnNlJyB9KVxuICAgICAgICAgICAgLnBpcGUobWFwKChyZXMpID0+IHtcbiAgICAgICAgICAgIGlmICh0aGlzLmdldE9wdGlvbihgJHttb2R1bGV9LmFsd2F5c0ZhaWxgKSkge1xuICAgICAgICAgICAgICAgIHRocm93IHRoaXMuY3JlYXRlRmFpbFJlc3BvbnNlKGRhdGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgICAgfSksIG1hcCgocmVzKSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IE5iQXV0aFJlc3VsdCh0cnVlLCByZXMsIHRoaXMuZ2V0T3B0aW9uKGAke21vZHVsZX0ucmVkaXJlY3Quc3VjY2Vzc2ApLCBbXSwgdGhpcy5nZXRPcHRpb24oJ21lc3NhZ2VzLmdldHRlcicpKG1vZHVsZSwgcmVzLCB0aGlzLm9wdGlvbnMpLCB0aGlzLmNyZWF0ZVRva2VuKHRoaXMuZ2V0T3B0aW9uKCd0b2tlbi5nZXR0ZXInKShtb2R1bGUsIHJlcywgdGhpcy5vcHRpb25zKSwgcmVxdWlyZVZhbGlkVG9rZW4pKTtcbiAgICAgICAgfSksIGNhdGNoRXJyb3IoKHJlcykgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuaGFuZGxlUmVzcG9uc2VFcnJvcihyZXMsIG1vZHVsZSk7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgcmVnaXN0ZXIoZGF0YSkge1xuICAgICAgICBjb25zdCBtb2R1bGUgPSAncmVnaXN0ZXInO1xuICAgICAgICBjb25zdCBtZXRob2QgPSB0aGlzLmdldE9wdGlvbihgJHttb2R1bGV9Lm1ldGhvZGApO1xuICAgICAgICBjb25zdCB1cmwgPSB0aGlzLmdldEFjdGlvbkVuZHBvaW50KG1vZHVsZSk7XG4gICAgICAgIGNvbnN0IHJlcXVpcmVWYWxpZFRva2VuID0gdGhpcy5nZXRPcHRpb24oYCR7bW9kdWxlfS5yZXF1aXJlVmFsaWRUb2tlbmApO1xuICAgICAgICByZXR1cm4gdGhpcy5odHRwLnJlcXVlc3QobWV0aG9kLCB1cmwsIHsgYm9keTogZGF0YSwgb2JzZXJ2ZTogJ3Jlc3BvbnNlJyB9KVxuICAgICAgICAgICAgLnBpcGUobWFwKChyZXMpID0+IHtcbiAgICAgICAgICAgIGlmICh0aGlzLmdldE9wdGlvbihgJHttb2R1bGV9LmFsd2F5c0ZhaWxgKSkge1xuICAgICAgICAgICAgICAgIHRocm93IHRoaXMuY3JlYXRlRmFpbFJlc3BvbnNlKGRhdGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgICAgfSksIG1hcCgocmVzKSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IE5iQXV0aFJlc3VsdCh0cnVlLCByZXMsIHRoaXMuZ2V0T3B0aW9uKGAke21vZHVsZX0ucmVkaXJlY3Quc3VjY2Vzc2ApLCBbXSwgdGhpcy5nZXRPcHRpb24oJ21lc3NhZ2VzLmdldHRlcicpKG1vZHVsZSwgcmVzLCB0aGlzLm9wdGlvbnMpLCB0aGlzLmNyZWF0ZVRva2VuKHRoaXMuZ2V0T3B0aW9uKCd0b2tlbi5nZXR0ZXInKSgnbG9naW4nLCByZXMsIHRoaXMub3B0aW9ucyksIHJlcXVpcmVWYWxpZFRva2VuKSk7XG4gICAgICAgIH0pLCBjYXRjaEVycm9yKChyZXMpID0+IHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmhhbmRsZVJlc3BvbnNlRXJyb3IocmVzLCBtb2R1bGUpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHJlcXVlc3RQYXNzd29yZChkYXRhKSB7XG4gICAgICAgIGNvbnN0IG1vZHVsZSA9ICdyZXF1ZXN0UGFzcyc7XG4gICAgICAgIGNvbnN0IG1ldGhvZCA9IHRoaXMuZ2V0T3B0aW9uKGAke21vZHVsZX0ubWV0aG9kYCk7XG4gICAgICAgIGNvbnN0IHVybCA9IHRoaXMuZ2V0QWN0aW9uRW5kcG9pbnQobW9kdWxlKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuaHR0cC5yZXF1ZXN0KG1ldGhvZCwgdXJsLCB7IGJvZHk6IGRhdGEsIG9ic2VydmU6ICdyZXNwb25zZScgfSlcbiAgICAgICAgICAgIC5waXBlKG1hcCgocmVzKSA9PiB7XG4gICAgICAgICAgICBpZiAodGhpcy5nZXRPcHRpb24oYCR7bW9kdWxlfS5hbHdheXNGYWlsYCkpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyB0aGlzLmNyZWF0ZUZhaWxSZXNwb25zZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgICAgfSksIG1hcCgocmVzKSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IE5iQXV0aFJlc3VsdCh0cnVlLCByZXMsIHRoaXMuZ2V0T3B0aW9uKGAke21vZHVsZX0ucmVkaXJlY3Quc3VjY2Vzc2ApLCBbXSwgdGhpcy5nZXRPcHRpb24oJ21lc3NhZ2VzLmdldHRlcicpKG1vZHVsZSwgcmVzLCB0aGlzLm9wdGlvbnMpKTtcbiAgICAgICAgfSksIGNhdGNoRXJyb3IoKHJlcykgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuaGFuZGxlUmVzcG9uc2VFcnJvcihyZXMsIG1vZHVsZSk7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgcmVzZXRQYXNzd29yZChkYXRhID0ge30pIHtcbiAgICAgICAgY29uc3QgbW9kdWxlID0gJ3Jlc2V0UGFzcyc7XG4gICAgICAgIGNvbnN0IG1ldGhvZCA9IHRoaXMuZ2V0T3B0aW9uKGAke21vZHVsZX0ubWV0aG9kYCk7XG4gICAgICAgIGNvbnN0IHVybCA9IHRoaXMuZ2V0QWN0aW9uRW5kcG9pbnQobW9kdWxlKTtcbiAgICAgICAgY29uc3QgdG9rZW5LZXkgPSB0aGlzLmdldE9wdGlvbihgJHttb2R1bGV9LnJlc2V0UGFzc3dvcmRUb2tlbktleWApO1xuICAgICAgICBkYXRhW3Rva2VuS2V5XSA9IHRoaXMucm91dGUuc25hcHNob3QucXVlcnlQYXJhbXNbdG9rZW5LZXldO1xuICAgICAgICByZXR1cm4gdGhpcy5odHRwLnJlcXVlc3QobWV0aG9kLCB1cmwsIHsgYm9keTogZGF0YSwgb2JzZXJ2ZTogJ3Jlc3BvbnNlJyB9KVxuICAgICAgICAgICAgLnBpcGUobWFwKChyZXMpID0+IHtcbiAgICAgICAgICAgIGlmICh0aGlzLmdldE9wdGlvbihgJHttb2R1bGV9LmFsd2F5c0ZhaWxgKSkge1xuICAgICAgICAgICAgICAgIHRocm93IHRoaXMuY3JlYXRlRmFpbFJlc3BvbnNlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmVzO1xuICAgICAgICB9KSwgbWFwKChyZXMpID0+IHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgTmJBdXRoUmVzdWx0KHRydWUsIHJlcywgdGhpcy5nZXRPcHRpb24oYCR7bW9kdWxlfS5yZWRpcmVjdC5zdWNjZXNzYCksIFtdLCB0aGlzLmdldE9wdGlvbignbWVzc2FnZXMuZ2V0dGVyJykobW9kdWxlLCByZXMsIHRoaXMub3B0aW9ucykpO1xuICAgICAgICB9KSwgY2F0Y2hFcnJvcigocmVzKSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5oYW5kbGVSZXNwb25zZUVycm9yKHJlcywgbW9kdWxlKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBsb2dvdXQoKSB7XG4gICAgICAgIGNvbnN0IG1vZHVsZSA9ICdsb2dvdXQnO1xuICAgICAgICBjb25zdCBtZXRob2QgPSB0aGlzLmdldE9wdGlvbihgJHttb2R1bGV9Lm1ldGhvZGApO1xuICAgICAgICBjb25zdCB1cmwgPSB0aGlzLmdldEFjdGlvbkVuZHBvaW50KG1vZHVsZSk7XG4gICAgICAgIHJldHVybiBvZih7fSlcbiAgICAgICAgICAgIC5waXBlKHN3aXRjaE1hcCgocmVzKSA9PiB7XG4gICAgICAgICAgICBpZiAoIXVybCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBvZihyZXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuaHR0cC5yZXF1ZXN0KG1ldGhvZCwgdXJsLCB7IG9ic2VydmU6ICdyZXNwb25zZScgfSk7XG4gICAgICAgIH0pLCBtYXAoKHJlcykgPT4ge1xuICAgICAgICAgICAgaWYgKHRoaXMuZ2V0T3B0aW9uKGAke21vZHVsZX0uYWx3YXlzRmFpbGApKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgdGhpcy5jcmVhdGVGYWlsUmVzcG9uc2UoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiByZXM7XG4gICAgICAgIH0pLCBtYXAoKHJlcykgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBOYkF1dGhSZXN1bHQodHJ1ZSwgcmVzLCB0aGlzLmdldE9wdGlvbihgJHttb2R1bGV9LnJlZGlyZWN0LnN1Y2Nlc3NgKSwgW10sIHRoaXMuZ2V0T3B0aW9uKCdtZXNzYWdlcy5nZXR0ZXInKShtb2R1bGUsIHJlcywgdGhpcy5vcHRpb25zKSk7XG4gICAgICAgIH0pLCBjYXRjaEVycm9yKChyZXMpID0+IHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmhhbmRsZVJlc3BvbnNlRXJyb3IocmVzLCBtb2R1bGUpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHJlZnJlc2hUb2tlbihkYXRhKSB7XG4gICAgICAgIGNvbnN0IG1vZHVsZSA9ICdyZWZyZXNoVG9rZW4nO1xuICAgICAgICBjb25zdCBtZXRob2QgPSB0aGlzLmdldE9wdGlvbihgJHttb2R1bGV9Lm1ldGhvZGApO1xuICAgICAgICBjb25zdCB1cmwgPSB0aGlzLmdldEFjdGlvbkVuZHBvaW50KG1vZHVsZSk7XG4gICAgICAgIGNvbnN0IHJlcXVpcmVWYWxpZFRva2VuID0gdGhpcy5nZXRPcHRpb24oYCR7bW9kdWxlfS5yZXF1aXJlVmFsaWRUb2tlbmApO1xuICAgICAgICByZXR1cm4gdGhpcy5odHRwLnJlcXVlc3QobWV0aG9kLCB1cmwsIHsgYm9keTogZGF0YSwgb2JzZXJ2ZTogJ3Jlc3BvbnNlJyB9KVxuICAgICAgICAgICAgLnBpcGUobWFwKChyZXMpID0+IHtcbiAgICAgICAgICAgIGlmICh0aGlzLmdldE9wdGlvbihgJHttb2R1bGV9LmFsd2F5c0ZhaWxgKSkge1xuICAgICAgICAgICAgICAgIHRocm93IHRoaXMuY3JlYXRlRmFpbFJlc3BvbnNlKGRhdGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgICAgfSksIG1hcCgocmVzKSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IE5iQXV0aFJlc3VsdCh0cnVlLCByZXMsIHRoaXMuZ2V0T3B0aW9uKGAke21vZHVsZX0ucmVkaXJlY3Quc3VjY2Vzc2ApLCBbXSwgdGhpcy5nZXRPcHRpb24oJ21lc3NhZ2VzLmdldHRlcicpKG1vZHVsZSwgcmVzLCB0aGlzLm9wdGlvbnMpLCB0aGlzLmNyZWF0ZVRva2VuKHRoaXMuZ2V0T3B0aW9uKCd0b2tlbi5nZXR0ZXInKShtb2R1bGUsIHJlcywgdGhpcy5vcHRpb25zKSwgcmVxdWlyZVZhbGlkVG9rZW4pKTtcbiAgICAgICAgfSksIGNhdGNoRXJyb3IoKHJlcykgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuaGFuZGxlUmVzcG9uc2VFcnJvcihyZXMsIG1vZHVsZSk7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgaGFuZGxlUmVzcG9uc2VFcnJvcihyZXMsIG1vZHVsZSkge1xuICAgICAgICBsZXQgZXJyb3JzID0gW107XG4gICAgICAgIGlmIChyZXMgaW5zdGFuY2VvZiBIdHRwRXJyb3JSZXNwb25zZSkge1xuICAgICAgICAgICAgZXJyb3JzID0gdGhpcy5nZXRPcHRpb24oJ2Vycm9ycy5nZXR0ZXInKShtb2R1bGUsIHJlcywgdGhpcy5vcHRpb25zKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChyZXMgaW5zdGFuY2VvZiBOYkF1dGhJbGxlZ2FsVG9rZW5FcnJvcikge1xuICAgICAgICAgICAgZXJyb3JzLnB1c2gocmVzLm1lc3NhZ2UpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgZXJyb3JzLnB1c2goJ1NvbWV0aGluZyB3ZW50IHdyb25nLicpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvZihuZXcgTmJBdXRoUmVzdWx0KGZhbHNlLCByZXMsIHRoaXMuZ2V0T3B0aW9uKGAke21vZHVsZX0ucmVkaXJlY3QuZmFpbHVyZWApLCBlcnJvcnMpKTtcbiAgICB9XG59O1xuTmJQYXNzd29yZEF1dGhTdHJhdGVneSA9IE5iUGFzc3dvcmRBdXRoU3RyYXRlZ3lfMSA9IF9fZGVjb3JhdGUkNyhbXG4gICAgSW5qZWN0YWJsZSgpLFxuICAgIF9fbWV0YWRhdGEkNShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtIdHRwQ2xpZW50LCBBY3RpdmF0ZWRSb3V0ZV0pXG5dLCBOYlBhc3N3b3JkQXV0aFN0cmF0ZWd5KTtcblxudmFyIF9fZGVjb3JhdGUkOCA9ICh0aGlzICYmIHRoaXMuX19kZWNvcmF0ZSkgfHwgZnVuY3Rpb24gKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKSB7XG4gICAgdmFyIGMgPSBhcmd1bWVudHMubGVuZ3RoLCByID0gYyA8IDMgPyB0YXJnZXQgOiBkZXNjID09PSBudWxsID8gZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBrZXkpIDogZGVzYywgZDtcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QuZGVjb3JhdGUgPT09IFwiZnVuY3Rpb25cIikgciA9IFJlZmxlY3QuZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpO1xuICAgIGVsc2UgZm9yICh2YXIgaSA9IGRlY29yYXRvcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIGlmIChkID0gZGVjb3JhdG9yc1tpXSkgciA9IChjIDwgMyA/IGQocikgOiBjID4gMyA/IGQodGFyZ2V0LCBrZXksIHIpIDogZCh0YXJnZXQsIGtleSkpIHx8IHI7XG4gICAgcmV0dXJuIGMgPiAzICYmIHIgJiYgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCByKSwgcjtcbn07XG52YXIgX19tZXRhZGF0YSQ2ID0gKHRoaXMgJiYgdGhpcy5fX21ldGFkYXRhKSB8fCBmdW5jdGlvbiAoaywgdikge1xuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5tZXRhZGF0YSA9PT0gXCJmdW5jdGlvblwiKSByZXR1cm4gUmVmbGVjdC5tZXRhZGF0YShrLCB2KTtcbn07XG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgQWt2ZW8uIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIExpY2Vuc2UuIFNlZSBMaWNlbnNlLnR4dCBpbiB0aGUgcHJvamVjdCByb290IGZvciBsaWNlbnNlIGluZm9ybWF0aW9uLlxuICovXG5sZXQgTmJBdXRoQ29tcG9uZW50ID0gY2xhc3MgTmJBdXRoQ29tcG9uZW50IHtcbiAgICAvLyBzaG93Y2FzZSBvZiBob3cgdG8gdXNlIHRoZSBvbkF1dGhlbnRpY2F0aW9uQ2hhbmdlIG1ldGhvZFxuICAgIGNvbnN0cnVjdG9yKGF1dGgsIGxvY2F0aW9uKSB7XG4gICAgICAgIHRoaXMuYXV0aCA9IGF1dGg7XG4gICAgICAgIHRoaXMubG9jYXRpb24gPSBsb2NhdGlvbjtcbiAgICAgICAgdGhpcy5hbGl2ZSA9IHRydWU7XG4gICAgICAgIHRoaXMuYXV0aGVudGljYXRlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLnRva2VuID0gJyc7XG4gICAgICAgIHRoaXMuc3Vic2NyaXB0aW9uID0gYXV0aC5vbkF1dGhlbnRpY2F0aW9uQ2hhbmdlKClcbiAgICAgICAgICAgIC5waXBlKHRha2VXaGlsZSgoKSA9PiB0aGlzLmFsaXZlKSlcbiAgICAgICAgICAgIC5zdWJzY3JpYmUoKGF1dGhlbnRpY2F0ZWQpID0+IHtcbiAgICAgICAgICAgIHRoaXMuYXV0aGVudGljYXRlZCA9IGF1dGhlbnRpY2F0ZWQ7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBiYWNrKCkge1xuICAgICAgICB0aGlzLmxvY2F0aW9uLmJhY2soKTtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBuZ09uRGVzdHJveSgpIHtcbiAgICAgICAgdGhpcy5hbGl2ZSA9IGZhbHNlO1xuICAgIH1cbn07XG5OYkF1dGhDb21wb25lbnQgPSBfX2RlY29yYXRlJDgoW1xuICAgIENvbXBvbmVudCh7XG4gICAgICAgIHNlbGVjdG9yOiAnbmItYXV0aCcsXG4gICAgICAgIHRlbXBsYXRlOiBgXG4gICAgPG5iLWxheW91dD5cbiAgICAgIDxuYi1sYXlvdXQtY29sdW1uPlxuICAgICAgICA8bmItY2FyZD5cbiAgICAgICAgICA8bmItY2FyZC1oZWFkZXI+XG4gICAgICAgICAgICA8bmF2IGNsYXNzPVwibmF2aWdhdGlvblwiPlxuICAgICAgICAgICAgICA8YSBocmVmPVwiI1wiIChjbGljayk9XCJiYWNrKClcIiBjbGFzcz1cImxpbmsgYmFjay1saW5rXCIgYXJpYS1sYWJlbD1cIkJhY2tcIj5cbiAgICAgICAgICAgICAgICA8bmItaWNvbiBpY29uPVwiYXJyb3ctYmFja1wiPjwvbmItaWNvbj5cbiAgICAgICAgICAgICAgPC9hPlxuICAgICAgICAgICAgPC9uYXY+XG4gICAgICAgICAgPC9uYi1jYXJkLWhlYWRlcj5cbiAgICAgICAgICA8bmItY2FyZC1ib2R5PlxuICAgICAgICAgICAgPG5iLWF1dGgtYmxvY2s+XG4gICAgICAgICAgICAgIDxyb3V0ZXItb3V0bGV0Pjwvcm91dGVyLW91dGxldD5cbiAgICAgICAgICAgIDwvbmItYXV0aC1ibG9jaz5cbiAgICAgICAgICA8L25iLWNhcmQtYm9keT5cbiAgICAgICAgPC9uYi1jYXJkPlxuICAgICAgPC9uYi1sYXlvdXQtY29sdW1uPlxuICAgIDwvbmItbGF5b3V0PlxuICBgLFxuICAgICAgICBzdHlsZXM6IFtcIi8qIVxcbiAqIEBsaWNlbnNlXFxuICogQ29weXJpZ2h0IEFrdmVvLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS4gU2VlIExpY2Vuc2UudHh0IGluIHRoZSBwcm9qZWN0IHJvb3QgZm9yIGxpY2Vuc2UgaW5mb3JtYXRpb24uXFxuICovOmhvc3QgbmItY2FyZHttYXJnaW46MDtoZWlnaHQ6Y2FsYygxMDB2aCAtIDIgKiAyLjVyZW0pfTpob3N0IC5uYXZpZ2F0aW9uIC5saW5re2Rpc3BsYXk6aW5saW5lLWJsb2NrO3RleHQtZGVjb3JhdGlvbjpub25lfTpob3N0IC5uYXZpZ2F0aW9uIC5saW5rIG5iLWljb257Zm9udC1zaXplOjJyZW07dmVydGljYWwtYWxpZ246bWlkZGxlfTpob3N0IC5saW5rcyBuYi1pY29ue2ZvbnQtc2l6ZToyLjVyZW19Omhvc3QgbmItY2FyZC1ib2R5e2Rpc3BsYXk6ZmxleDt3aWR0aDoxMDAlfTpob3N0IG5iLWF1dGgtYmxvY2t7bWFyZ2luOmF1dG99QG1lZGlhIChtYXgtd2lkdGg6IDc2Ny45OHB4KXs6aG9zdCBuYi1jYXJke2JvcmRlci1yYWRpdXM6MDtoZWlnaHQ6MTAwdmh9fTpob3N0IDo6bmctZGVlcCBuYi1sYXlvdXQgLmxheW91dCAubGF5b3V0LWNvbnRhaW5lciAuY29udGVudCAuY29sdW1ucyBuYi1sYXlvdXQtY29sdW1ue3BhZGRpbmc6Mi41cmVtfUBtZWRpYSAobWF4LXdpZHRoOiA3NjcuOThweCl7Omhvc3QgOjpuZy1kZWVwIG5iLWxheW91dCAubGF5b3V0IC5sYXlvdXQtY29udGFpbmVyIC5jb250ZW50IC5jb2x1bW5zIG5iLWxheW91dC1jb2x1bW57cGFkZGluZzowfX1cXG5cIl1cbiAgICB9KSxcbiAgICBfX21ldGFkYXRhJDYoXCJkZXNpZ246cGFyYW10eXBlc1wiLCBbTmJBdXRoU2VydmljZSwgTG9jYXRpb25dKVxuXSwgTmJBdXRoQ29tcG9uZW50KTtcblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IEFrdmVvLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICogTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLiBTZWUgTGljZW5zZS50eHQgaW4gdGhlIHByb2plY3Qgcm9vdCBmb3IgbGljZW5zZSBpbmZvcm1hdGlvbi5cbiAqL1xudmFyIF9fZGVjb3JhdGUkOSA9ICh0aGlzICYmIHRoaXMuX19kZWNvcmF0ZSkgfHwgZnVuY3Rpb24gKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKSB7XG4gICAgdmFyIGMgPSBhcmd1bWVudHMubGVuZ3RoLCByID0gYyA8IDMgPyB0YXJnZXQgOiBkZXNjID09PSBudWxsID8gZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBrZXkpIDogZGVzYywgZDtcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QuZGVjb3JhdGUgPT09IFwiZnVuY3Rpb25cIikgciA9IFJlZmxlY3QuZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpO1xuICAgIGVsc2UgZm9yICh2YXIgaSA9IGRlY29yYXRvcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIGlmIChkID0gZGVjb3JhdG9yc1tpXSkgciA9IChjIDwgMyA/IGQocikgOiBjID4gMyA/IGQodGFyZ2V0LCBrZXksIHIpIDogZCh0YXJnZXQsIGtleSkpIHx8IHI7XG4gICAgcmV0dXJuIGMgPiAzICYmIHIgJiYgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCByKSwgcjtcbn07XG5sZXQgTmJBdXRoQmxvY2tDb21wb25lbnQgPSBjbGFzcyBOYkF1dGhCbG9ja0NvbXBvbmVudCB7XG59O1xuTmJBdXRoQmxvY2tDb21wb25lbnQgPSBfX2RlY29yYXRlJDkoW1xuICAgIENvbXBvbmVudCh7XG4gICAgICAgIHNlbGVjdG9yOiAnbmItYXV0aC1ibG9jaycsXG4gICAgICAgIHRlbXBsYXRlOiBgXG4gICAgPG5nLWNvbnRlbnQ+PC9uZy1jb250ZW50PlxuICBgLFxuICAgICAgICBzdHlsZXM6IFtcIjpob3N0e2Rpc3BsYXk6YmxvY2s7d2lkdGg6MTAwJTttYXgtd2lkdGg6MzVyZW19Omhvc3QgOjpuZy1kZWVwIGZvcm17d2lkdGg6MTAwJX06aG9zdCA6Om5nLWRlZXAgLmxhYmVse2Rpc3BsYXk6YmxvY2s7bWFyZ2luLWJvdHRvbTowLjVyZW19Omhvc3QgOjpuZy1kZWVwIC5mb3Jnb3QtcGFzc3dvcmR7dGV4dC1kZWNvcmF0aW9uOm5vbmU7bWFyZ2luLWJvdHRvbTowLjVyZW19Omhvc3QgOjpuZy1kZWVwIC5jYXB0aW9ue21hcmdpbi10b3A6MC41cmVtfTpob3N0IDo6bmctZGVlcCAuYWxlcnR7dGV4dC1hbGlnbjpjZW50ZXJ9Omhvc3QgOjpuZy1kZWVwIC50aXRsZXttYXJnaW4tdG9wOjA7bWFyZ2luLWJvdHRvbTowLjc1cmVtO3RleHQtYWxpZ246Y2VudGVyfTpob3N0IDo6bmctZGVlcCAuc3ViLXRpdGxle21hcmdpbi1ib3R0b206MnJlbTt0ZXh0LWFsaWduOmNlbnRlcn06aG9zdCA6Om5nLWRlZXAgLmZvcm0tY29udHJvbC1ncm91cHttYXJnaW4tYm90dG9tOjJyZW19Omhvc3QgOjpuZy1kZWVwIC5mb3JtLWNvbnRyb2wtZ3JvdXAuYWNjZXB0LWdyb3Vwe2Rpc3BsYXk6ZmxleDtqdXN0aWZ5LWNvbnRlbnQ6c3BhY2UtYmV0d2VlbjttYXJnaW46MnJlbSAwfTpob3N0IDo6bmctZGVlcCAubGFiZWwtd2l0aC1saW5re2Rpc3BsYXk6ZmxleDtqdXN0aWZ5LWNvbnRlbnQ6c3BhY2UtYmV0d2Vlbn06aG9zdCA6Om5nLWRlZXAgLmxpbmtze3RleHQtYWxpZ246Y2VudGVyO21hcmdpbi10b3A6MS43NXJlbX06aG9zdCA6Om5nLWRlZXAgLmxpbmtzIC5zb2NpYWxze21hcmdpbi10b3A6MS41cmVtfTpob3N0IDo6bmctZGVlcCAubGlua3MgLnNvY2lhbHMgYXttYXJnaW46MCAxcmVtO3RleHQtZGVjb3JhdGlvbjpub25lO3ZlcnRpY2FsLWFsaWduOm1pZGRsZX06aG9zdCA6Om5nLWRlZXAgLmxpbmtzIC5zb2NpYWxzIGEud2l0aC1pY29ue2ZvbnQtc2l6ZToycmVtfTpob3N0IDo6bmctZGVlcCAuYW5vdGhlci1hY3Rpb257bWFyZ2luLXRvcDoycmVtO3RleHQtYWxpZ246Y2VudGVyfTpob3N0IDo6bmctZGVlcCAuc2lnbi1pbi1vci11cHttYXJnaW4tdG9wOjJyZW07ZGlzcGxheTpmbGV4O2p1c3RpZnktY29udGVudDpzcGFjZS1iZXR3ZWVufTpob3N0IDo6bmctZGVlcCBuYi1hbGVydCAuYWxlcnQtdGl0bGUsOmhvc3QgOjpuZy1kZWVwIG5iLWFsZXJ0IC5hbGVydC1tZXNzYWdle21hcmdpbjowIDAgMC41cmVtfTpob3N0IDo6bmctZGVlcCBuYi1hbGVydCAuYWxlcnQtbWVzc2FnZS1saXN0e2xpc3Qtc3R5bGUtdHlwZTpub25lO3BhZGRpbmc6MDttYXJnaW46MH1cXG5cIl1cbiAgICB9KVxuXSwgTmJBdXRoQmxvY2tDb21wb25lbnQpO1xuXG52YXIgX19kZWNvcmF0ZSQxMCA9ICh0aGlzICYmIHRoaXMuX19kZWNvcmF0ZSkgfHwgZnVuY3Rpb24gKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKSB7XG4gICAgdmFyIGMgPSBhcmd1bWVudHMubGVuZ3RoLCByID0gYyA8IDMgPyB0YXJnZXQgOiBkZXNjID09PSBudWxsID8gZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBrZXkpIDogZGVzYywgZDtcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QuZGVjb3JhdGUgPT09IFwiZnVuY3Rpb25cIikgciA9IFJlZmxlY3QuZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpO1xuICAgIGVsc2UgZm9yICh2YXIgaSA9IGRlY29yYXRvcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIGlmIChkID0gZGVjb3JhdG9yc1tpXSkgciA9IChjIDwgMyA/IGQocikgOiBjID4gMyA/IGQodGFyZ2V0LCBrZXksIHIpIDogZCh0YXJnZXQsIGtleSkpIHx8IHI7XG4gICAgcmV0dXJuIGMgPiAzICYmIHIgJiYgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCByKSwgcjtcbn07XG52YXIgX19tZXRhZGF0YSQ3ID0gKHRoaXMgJiYgdGhpcy5fX21ldGFkYXRhKSB8fCBmdW5jdGlvbiAoaywgdikge1xuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5tZXRhZGF0YSA9PT0gXCJmdW5jdGlvblwiKSByZXR1cm4gUmVmbGVjdC5tZXRhZGF0YShrLCB2KTtcbn07XG52YXIgX19wYXJhbSQzID0gKHRoaXMgJiYgdGhpcy5fX3BhcmFtKSB8fCBmdW5jdGlvbiAocGFyYW1JbmRleCwgZGVjb3JhdG9yKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YXJnZXQsIGtleSkgeyBkZWNvcmF0b3IodGFyZ2V0LCBrZXksIHBhcmFtSW5kZXgpOyB9XG59O1xuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IEFrdmVvLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICogTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLiBTZWUgTGljZW5zZS50eHQgaW4gdGhlIHByb2plY3Qgcm9vdCBmb3IgbGljZW5zZSBpbmZvcm1hdGlvbi5cbiAqL1xubGV0IE5iTG9naW5Db21wb25lbnQgPSBjbGFzcyBOYkxvZ2luQ29tcG9uZW50IHtcbiAgICBjb25zdHJ1Y3RvcihzZXJ2aWNlLCBvcHRpb25zID0ge30sIGNkLCByb3V0ZXIpIHtcbiAgICAgICAgdGhpcy5zZXJ2aWNlID0gc2VydmljZTtcbiAgICAgICAgdGhpcy5vcHRpb25zID0gb3B0aW9ucztcbiAgICAgICAgdGhpcy5jZCA9IGNkO1xuICAgICAgICB0aGlzLnJvdXRlciA9IHJvdXRlcjtcbiAgICAgICAgdGhpcy5yZWRpcmVjdERlbGF5ID0gMDtcbiAgICAgICAgdGhpcy5zaG93TWVzc2FnZXMgPSB7fTtcbiAgICAgICAgdGhpcy5zdHJhdGVneSA9ICcnO1xuICAgICAgICB0aGlzLmVycm9ycyA9IFtdO1xuICAgICAgICB0aGlzLm1lc3NhZ2VzID0gW107XG4gICAgICAgIHRoaXMudXNlciA9IHt9O1xuICAgICAgICB0aGlzLnN1Ym1pdHRlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLnNvY2lhbExpbmtzID0gW107XG4gICAgICAgIHRoaXMucmVtZW1iZXJNZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLnJlZGlyZWN0RGVsYXkgPSB0aGlzLmdldENvbmZpZ1ZhbHVlKCdmb3Jtcy5sb2dpbi5yZWRpcmVjdERlbGF5Jyk7XG4gICAgICAgIHRoaXMuc2hvd01lc3NhZ2VzID0gdGhpcy5nZXRDb25maWdWYWx1ZSgnZm9ybXMubG9naW4uc2hvd01lc3NhZ2VzJyk7XG4gICAgICAgIHRoaXMuc3RyYXRlZ3kgPSB0aGlzLmdldENvbmZpZ1ZhbHVlKCdmb3Jtcy5sb2dpbi5zdHJhdGVneScpO1xuICAgICAgICB0aGlzLnNvY2lhbExpbmtzID0gdGhpcy5nZXRDb25maWdWYWx1ZSgnZm9ybXMubG9naW4uc29jaWFsTGlua3MnKTtcbiAgICAgICAgdGhpcy5yZW1lbWJlck1lID0gdGhpcy5nZXRDb25maWdWYWx1ZSgnZm9ybXMubG9naW4ucmVtZW1iZXJNZScpO1xuICAgIH1cbiAgICBsb2dpbigpIHtcbiAgICAgICAgdGhpcy5lcnJvcnMgPSBbXTtcbiAgICAgICAgdGhpcy5tZXNzYWdlcyA9IFtdO1xuICAgICAgICB0aGlzLnN1Ym1pdHRlZCA9IHRydWU7XG4gICAgICAgIHRoaXMuc2VydmljZS5hdXRoZW50aWNhdGUodGhpcy5zdHJhdGVneSwgdGhpcy51c2VyKS5zdWJzY3JpYmUoKHJlc3VsdCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5zdWJtaXR0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIGlmIChyZXN1bHQuaXNTdWNjZXNzKCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm1lc3NhZ2VzID0gcmVzdWx0LmdldE1lc3NhZ2VzKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLmVycm9ycyA9IHJlc3VsdC5nZXRFcnJvcnMoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IHJlZGlyZWN0ID0gcmVzdWx0LmdldFJlZGlyZWN0KCk7XG4gICAgICAgICAgICBpZiAocmVkaXJlY3QpIHtcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucm91dGVyLm5hdmlnYXRlQnlVcmwocmVkaXJlY3QpO1xuICAgICAgICAgICAgICAgIH0sIHRoaXMucmVkaXJlY3REZWxheSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmNkLmRldGVjdENoYW5nZXMoKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGdldENvbmZpZ1ZhbHVlKGtleSkge1xuICAgICAgICByZXR1cm4gZ2V0RGVlcEZyb21PYmplY3QodGhpcy5vcHRpb25zLCBrZXksIG51bGwpO1xuICAgIH1cbn07XG5OYkxvZ2luQ29tcG9uZW50ID0gX19kZWNvcmF0ZSQxMChbXG4gICAgQ29tcG9uZW50KHtcbiAgICAgICAgc2VsZWN0b3I6ICduYi1sb2dpbicsXG4gICAgICAgIHRlbXBsYXRlOiBcIjxoMSBpZD1cXFwidGl0bGVcXFwiIGNsYXNzPVxcXCJ0aXRsZVxcXCI+TG9naW48L2gxPlxcbjxwIGNsYXNzPVxcXCJzdWItdGl0bGVcXFwiPkhlbGxvISBMb2cgaW4gd2l0aCB5b3VyIGVtYWlsLjwvcD5cXG5cXG48bmItYWxlcnQgKm5nSWY9XFxcInNob3dNZXNzYWdlcy5lcnJvciAmJiBlcnJvcnM/Lmxlbmd0aCAmJiAhc3VibWl0dGVkXFxcIiBvdXRsaW5lPVxcXCJkYW5nZXJcXFwiIHJvbGU9XFxcImFsZXJ0XFxcIj5cXG4gIDxwIGNsYXNzPVxcXCJhbGVydC10aXRsZVxcXCI+PGI+T2ggc25hcCE8L2I+PC9wPlxcbiAgPHVsIGNsYXNzPVxcXCJhbGVydC1tZXNzYWdlLWxpc3RcXFwiPlxcbiAgICA8bGkgKm5nRm9yPVxcXCJsZXQgZXJyb3Igb2YgZXJyb3JzXFxcIiBjbGFzcz1cXFwiYWxlcnQtbWVzc2FnZVxcXCI+e3sgZXJyb3IgfX08L2xpPlxcbiAgPC91bD5cXG48L25iLWFsZXJ0PlxcblxcbjxuYi1hbGVydCAqbmdJZj1cXFwic2hvd01lc3NhZ2VzLnN1Y2Nlc3MgJiYgbWVzc2FnZXM/Lmxlbmd0aCAmJiAhc3VibWl0dGVkXFxcIiBvdXRsaW5lPVxcXCJzdWNjZXNzXFxcIiByb2xlPVxcXCJhbGVydFxcXCI+XFxuICA8cCBjbGFzcz1cXFwiYWxlcnQtdGl0bGVcXFwiPjxiPkhvb3JheSE8L2I+PC9wPlxcbiAgPHVsIGNsYXNzPVxcXCJhbGVydC1tZXNzYWdlLWxpc3RcXFwiPlxcbiAgICA8bGkgKm5nRm9yPVxcXCJsZXQgbWVzc2FnZSBvZiBtZXNzYWdlc1xcXCIgY2xhc3M9XFxcImFsZXJ0LW1lc3NhZ2VcXFwiPnt7IG1lc3NhZ2UgfX08L2xpPlxcbiAgPC91bD5cXG48L25iLWFsZXJ0Plxcblxcbjxmb3JtIChuZ1N1Ym1pdCk9XFxcImxvZ2luKClcXFwiICNmb3JtPVxcXCJuZ0Zvcm1cXFwiIGFyaWEtbGFiZWxsZWRieT1cXFwidGl0bGVcXFwiPlxcblxcbiAgPGRpdiBjbGFzcz1cXFwiZm9ybS1jb250cm9sLWdyb3VwXFxcIj5cXG4gICAgPGxhYmVsIGNsYXNzPVxcXCJsYWJlbFxcXCIgZm9yPVxcXCJpbnB1dC1lbWFpbFxcXCI+RW1haWwgYWRkcmVzczo8L2xhYmVsPlxcbiAgICA8aW5wdXQgbmJJbnB1dFxcbiAgICAgICAgICAgZnVsbFdpZHRoXFxuICAgICAgICAgICBbKG5nTW9kZWwpXT1cXFwidXNlci5lbWFpbFxcXCJcXG4gICAgICAgICAgICNlbWFpbD1cXFwibmdNb2RlbFxcXCJcXG4gICAgICAgICAgIG5hbWU9XFxcImVtYWlsXFxcIlxcbiAgICAgICAgICAgaWQ9XFxcImlucHV0LWVtYWlsXFxcIlxcbiAgICAgICAgICAgcGF0dGVybj1cXFwiLitALitcXFxcLi4rXFxcIlxcbiAgICAgICAgICAgcGxhY2Vob2xkZXI9XFxcIkVtYWlsIGFkZHJlc3NcXFwiXFxuICAgICAgICAgICBmaWVsZFNpemU9XFxcImxhcmdlXFxcIlxcbiAgICAgICAgICAgYXV0b2ZvY3VzXFxuICAgICAgICAgICBbc3RhdHVzXT1cXFwiZW1haWwuZGlydHkgPyAoZW1haWwuaW52YWxpZCAgPyAnZGFuZ2VyJyA6ICdzdWNjZXNzJykgOiAnJ1xcXCJcXG4gICAgICAgICAgIFtyZXF1aXJlZF09XFxcImdldENvbmZpZ1ZhbHVlKCdmb3Jtcy52YWxpZGF0aW9uLmVtYWlsLnJlcXVpcmVkJylcXFwiXFxuICAgICAgICAgICBbYXR0ci5hcmlhLWludmFsaWRdPVxcXCJlbWFpbC5pbnZhbGlkICYmIGVtYWlsLnRvdWNoZWQgPyB0cnVlIDogbnVsbFxcXCI+XFxuICAgIDxuZy1jb250YWluZXIgKm5nSWY9XFxcImVtYWlsLmludmFsaWQgJiYgZW1haWwudG91Y2hlZFxcXCI+XFxuICAgICAgPHAgY2xhc3M9XFxcImNhcHRpb24gc3RhdHVzLWRhbmdlclxcXCIgKm5nSWY9XFxcImVtYWlsLmVycm9ycz8ucmVxdWlyZWRcXFwiPlxcbiAgICAgICAgRW1haWwgaXMgcmVxdWlyZWQhXFxuICAgICAgPC9wPlxcbiAgICAgIDxwIGNsYXNzPVxcXCJjYXB0aW9uIHN0YXR1cy1kYW5nZXJcXFwiICpuZ0lmPVxcXCJlbWFpbC5lcnJvcnM/LnBhdHRlcm5cXFwiPlxcbiAgICAgICAgRW1haWwgc2hvdWxkIGJlIHRoZSByZWFsIG9uZSFcXG4gICAgICA8L3A+XFxuICAgIDwvbmctY29udGFpbmVyPlxcbiAgPC9kaXY+XFxuXFxuICA8ZGl2IGNsYXNzPVxcXCJmb3JtLWNvbnRyb2wtZ3JvdXBcXFwiPlxcbiAgICA8c3BhbiBjbGFzcz1cXFwibGFiZWwtd2l0aC1saW5rXFxcIj5cXG4gICAgICA8bGFiZWwgY2xhc3M9XFxcImxhYmVsXFxcIiBmb3I9XFxcImlucHV0LXBhc3N3b3JkXFxcIj5QYXNzd29yZDo8L2xhYmVsPlxcbiAgICAgIDxhIGNsYXNzPVxcXCJmb3Jnb3QtcGFzc3dvcmQgY2FwdGlvbi0yXFxcIiByb3V0ZXJMaW5rPVxcXCIuLi9yZXF1ZXN0LXBhc3N3b3JkXFxcIj5Gb3Jnb3QgUGFzc3dvcmQ/PC9hPlxcbiAgICA8L3NwYW4+XFxuICAgIDxpbnB1dCBuYklucHV0XFxuICAgICAgICAgICBmdWxsV2lkdGhcXG4gICAgICAgICAgIFsobmdNb2RlbCldPVxcXCJ1c2VyLnBhc3N3b3JkXFxcIlxcbiAgICAgICAgICAgI3Bhc3N3b3JkPVxcXCJuZ01vZGVsXFxcIlxcbiAgICAgICAgICAgbmFtZT1cXFwicGFzc3dvcmRcXFwiXFxuICAgICAgICAgICB0eXBlPVxcXCJwYXNzd29yZFxcXCJcXG4gICAgICAgICAgIGlkPVxcXCJpbnB1dC1wYXNzd29yZFxcXCJcXG4gICAgICAgICAgIHBsYWNlaG9sZGVyPVxcXCJQYXNzd29yZFxcXCJcXG4gICAgICAgICAgIGZpZWxkU2l6ZT1cXFwibGFyZ2VcXFwiXFxuICAgICAgICAgICBbc3RhdHVzXT1cXFwicGFzc3dvcmQuZGlydHkgPyAocGFzc3dvcmQuaW52YWxpZCAgPyAnZGFuZ2VyJyA6ICdzdWNjZXNzJykgOiAnJ1xcXCJcXG4gICAgICAgICAgIFtyZXF1aXJlZF09XFxcImdldENvbmZpZ1ZhbHVlKCdmb3Jtcy52YWxpZGF0aW9uLnBhc3N3b3JkLnJlcXVpcmVkJylcXFwiXFxuICAgICAgICAgICBbbWlubGVuZ3RoXT1cXFwiZ2V0Q29uZmlnVmFsdWUoJ2Zvcm1zLnZhbGlkYXRpb24ucGFzc3dvcmQubWluTGVuZ3RoJylcXFwiXFxuICAgICAgICAgICBbbWF4bGVuZ3RoXT1cXFwiZ2V0Q29uZmlnVmFsdWUoJ2Zvcm1zLnZhbGlkYXRpb24ucGFzc3dvcmQubWF4TGVuZ3RoJylcXFwiXFxuICAgICAgICAgICBbYXR0ci5hcmlhLWludmFsaWRdPVxcXCJwYXNzd29yZC5pbnZhbGlkICYmIHBhc3N3b3JkLnRvdWNoZWQgPyB0cnVlIDogbnVsbFxcXCI+XFxuICAgIDxuZy1jb250YWluZXIgKm5nSWY9XFxcInBhc3N3b3JkLmludmFsaWQgJiYgcGFzc3dvcmQudG91Y2hlZCBcXFwiPlxcbiAgICAgIDxwIGNsYXNzPVxcXCJjYXB0aW9uIHN0YXR1cy1kYW5nZXJcXFwiICpuZ0lmPVxcXCJwYXNzd29yZC5lcnJvcnM/LnJlcXVpcmVkXFxcIj5cXG4gICAgICAgIFBhc3N3b3JkIGlzIHJlcXVpcmVkIVxcbiAgICAgIDwvcD5cXG4gICAgICA8cCBjbGFzcz1cXFwiY2FwdGlvbiBzdGF0dXMtZGFuZ2VyXFxcIiAqbmdJZj1cXFwicGFzc3dvcmQuZXJyb3JzPy5taW5sZW5ndGggfHwgcGFzc3dvcmQuZXJyb3JzPy5tYXhsZW5ndGhcXFwiPlxcbiAgICAgICAgUGFzc3dvcmQgc2hvdWxkIGNvbnRhaW5cXG4gICAgICAgIGZyb20ge3sgZ2V0Q29uZmlnVmFsdWUoJ2Zvcm1zLnZhbGlkYXRpb24ucGFzc3dvcmQubWluTGVuZ3RoJykgfX1cXG4gICAgICAgIHRvIHt7IGdldENvbmZpZ1ZhbHVlKCdmb3Jtcy52YWxpZGF0aW9uLnBhc3N3b3JkLm1heExlbmd0aCcpIH19XFxuICAgICAgICBjaGFyYWN0ZXJzXFxuICAgICAgPC9wPlxcbiAgICA8L25nLWNvbnRhaW5lcj5cXG4gIDwvZGl2PlxcblxcbiAgPGRpdiBjbGFzcz1cXFwiZm9ybS1jb250cm9sLWdyb3VwIGFjY2VwdC1ncm91cFxcXCI+XFxuICAgIDxuYi1jaGVja2JveCBuYW1lPVxcXCJyZW1lbWJlck1lXFxcIiBbKG5nTW9kZWwpXT1cXFwidXNlci5yZW1lbWJlck1lXFxcIiAqbmdJZj1cXFwicmVtZW1iZXJNZVxcXCI+UmVtZW1iZXIgbWU8L25iLWNoZWNrYm94PlxcbiAgPC9kaXY+XFxuXFxuICA8YnV0dG9uIG5iQnV0dG9uXFxuICAgICAgICAgIGZ1bGxXaWR0aFxcbiAgICAgICAgICBzdGF0dXM9XFxcInByaW1hcnlcXFwiXFxuICAgICAgICAgIHNpemU9XFxcImxhcmdlXFxcIlxcbiAgICAgICAgICBbZGlzYWJsZWRdPVxcXCJzdWJtaXR0ZWQgfHwgIWZvcm0udmFsaWRcXFwiXFxuICAgICAgICAgIFtjbGFzcy5idG4tcHVsc2VdPVxcXCJzdWJtaXR0ZWRcXFwiPlxcbiAgICBMb2cgSW5cXG4gIDwvYnV0dG9uPlxcbjwvZm9ybT5cXG5cXG48c2VjdGlvbiAqbmdJZj1cXFwic29jaWFsTGlua3MgJiYgc29jaWFsTGlua3MubGVuZ3RoID4gMFxcXCIgY2xhc3M9XFxcImxpbmtzXFxcIiBhcmlhLWxhYmVsPVxcXCJTb2NpYWwgc2lnbiBpblxcXCI+XFxuICBvciBlbnRlciB3aXRoOlxcbiAgPGRpdiBjbGFzcz1cXFwic29jaWFsc1xcXCI+XFxuICAgIDxuZy1jb250YWluZXIgKm5nRm9yPVxcXCJsZXQgc29jaWFsTGluayBvZiBzb2NpYWxMaW5rc1xcXCI+XFxuICAgICAgPGEgKm5nSWY9XFxcInNvY2lhbExpbmsubGlua1xcXCJcXG4gICAgICAgICBbcm91dGVyTGlua109XFxcInNvY2lhbExpbmsubGlua1xcXCJcXG4gICAgICAgICBbYXR0ci50YXJnZXRdPVxcXCJzb2NpYWxMaW5rLnRhcmdldFxcXCJcXG4gICAgICAgICBbYXR0ci5jbGFzc109XFxcInNvY2lhbExpbmsuaWNvblxcXCJcXG4gICAgICAgICBbY2xhc3Mud2l0aC1pY29uXT1cXFwic29jaWFsTGluay5pY29uXFxcIj5cXG4gICAgICAgIDxuYi1pY29uICpuZ0lmPVxcXCJzb2NpYWxMaW5rLmljb247IGVsc2UgdGl0bGVcXFwiIFtpY29uXT1cXFwic29jaWFsTGluay5pY29uXFxcIj48L25iLWljb24+XFxuICAgICAgICA8bmctdGVtcGxhdGUgI3RpdGxlPnt7IHNvY2lhbExpbmsudGl0bGUgfX08L25nLXRlbXBsYXRlPlxcbiAgICAgIDwvYT5cXG4gICAgICA8YSAqbmdJZj1cXFwic29jaWFsTGluay51cmxcXFwiXFxuICAgICAgICAgW2F0dHIuaHJlZl09XFxcInNvY2lhbExpbmsudXJsXFxcIlxcbiAgICAgICAgIFthdHRyLnRhcmdldF09XFxcInNvY2lhbExpbmsudGFyZ2V0XFxcIlxcbiAgICAgICAgIFthdHRyLmNsYXNzXT1cXFwic29jaWFsTGluay5pY29uXFxcIlxcbiAgICAgICAgIFtjbGFzcy53aXRoLWljb25dPVxcXCJzb2NpYWxMaW5rLmljb25cXFwiPlxcbiAgICAgICAgPG5iLWljb24gKm5nSWY9XFxcInNvY2lhbExpbmsuaWNvbjsgZWxzZSB0aXRsZVxcXCIgW2ljb25dPVxcXCJzb2NpYWxMaW5rLmljb25cXFwiPjwvbmItaWNvbj5cXG4gICAgICAgIDxuZy10ZW1wbGF0ZSAjdGl0bGU+e3sgc29jaWFsTGluay50aXRsZSB9fTwvbmctdGVtcGxhdGU+XFxuICAgICAgPC9hPlxcbiAgICA8L25nLWNvbnRhaW5lcj5cXG4gIDwvZGl2Plxcbjwvc2VjdGlvbj5cXG5cXG48c2VjdGlvbiBjbGFzcz1cXFwiYW5vdGhlci1hY3Rpb25cXFwiIGFyaWEtbGFiZWw9XFxcIlJlZ2lzdGVyXFxcIj5cXG4gIERvbid0IGhhdmUgYW4gYWNjb3VudD8gPGEgY2xhc3M9XFxcInRleHQtbGlua1xcXCIgcm91dGVyTGluaz1cXFwiLi4vcmVnaXN0ZXJcXFwiPlJlZ2lzdGVyPC9hPlxcbjwvc2VjdGlvbj5cXG5cIixcbiAgICAgICAgY2hhbmdlRGV0ZWN0aW9uOiBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneS5PblB1c2hcbiAgICB9KSxcbiAgICBfX3BhcmFtJDMoMSwgSW5qZWN0KE5CX0FVVEhfT1BUSU9OUykpLFxuICAgIF9fbWV0YWRhdGEkNyhcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtOYkF1dGhTZXJ2aWNlLCBPYmplY3QsIENoYW5nZURldGVjdG9yUmVmLFxuICAgICAgICBSb3V0ZXJdKVxuXSwgTmJMb2dpbkNvbXBvbmVudCk7XG5cbnZhciBfX2RlY29yYXRlJDExID0gKHRoaXMgJiYgdGhpcy5fX2RlY29yYXRlKSB8fCBmdW5jdGlvbiAoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpIHtcbiAgICB2YXIgYyA9IGFyZ3VtZW50cy5sZW5ndGgsIHIgPSBjIDwgMyA/IHRhcmdldCA6IGRlc2MgPT09IG51bGwgPyBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0YXJnZXQsIGtleSkgOiBkZXNjLCBkO1xuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5kZWNvcmF0ZSA9PT0gXCJmdW5jdGlvblwiKSByID0gUmVmbGVjdC5kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYyk7XG4gICAgZWxzZSBmb3IgKHZhciBpID0gZGVjb3JhdG9ycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgaWYgKGQgPSBkZWNvcmF0b3JzW2ldKSByID0gKGMgPCAzID8gZChyKSA6IGMgPiAzID8gZCh0YXJnZXQsIGtleSwgcikgOiBkKHRhcmdldCwga2V5KSkgfHwgcjtcbiAgICByZXR1cm4gYyA+IDMgJiYgciAmJiBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHIpLCByO1xufTtcbnZhciBfX21ldGFkYXRhJDggPSAodGhpcyAmJiB0aGlzLl9fbWV0YWRhdGEpIHx8IGZ1bmN0aW9uIChrLCB2KSB7XG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0Lm1ldGFkYXRhID09PSBcImZ1bmN0aW9uXCIpIHJldHVybiBSZWZsZWN0Lm1ldGFkYXRhKGssIHYpO1xufTtcbnZhciBfX3BhcmFtJDQgPSAodGhpcyAmJiB0aGlzLl9fcGFyYW0pIHx8IGZ1bmN0aW9uIChwYXJhbUluZGV4LCBkZWNvcmF0b3IpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhcmdldCwga2V5KSB7IGRlY29yYXRvcih0YXJnZXQsIGtleSwgcGFyYW1JbmRleCk7IH1cbn07XG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgQWt2ZW8uIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIExpY2Vuc2UuIFNlZSBMaWNlbnNlLnR4dCBpbiB0aGUgcHJvamVjdCByb290IGZvciBsaWNlbnNlIGluZm9ybWF0aW9uLlxuICovXG5sZXQgTmJSZWdpc3RlckNvbXBvbmVudCA9IGNsYXNzIE5iUmVnaXN0ZXJDb21wb25lbnQge1xuICAgIGNvbnN0cnVjdG9yKHNlcnZpY2UsIG9wdGlvbnMgPSB7fSwgY2QsIHJvdXRlcikge1xuICAgICAgICB0aGlzLnNlcnZpY2UgPSBzZXJ2aWNlO1xuICAgICAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zO1xuICAgICAgICB0aGlzLmNkID0gY2Q7XG4gICAgICAgIHRoaXMucm91dGVyID0gcm91dGVyO1xuICAgICAgICB0aGlzLnJlZGlyZWN0RGVsYXkgPSAwO1xuICAgICAgICB0aGlzLnNob3dNZXNzYWdlcyA9IHt9O1xuICAgICAgICB0aGlzLnN0cmF0ZWd5ID0gJyc7XG4gICAgICAgIHRoaXMuc3VibWl0dGVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMuZXJyb3JzID0gW107XG4gICAgICAgIHRoaXMubWVzc2FnZXMgPSBbXTtcbiAgICAgICAgdGhpcy51c2VyID0ge307XG4gICAgICAgIHRoaXMuc29jaWFsTGlua3MgPSBbXTtcbiAgICAgICAgdGhpcy5yZWRpcmVjdERlbGF5ID0gdGhpcy5nZXRDb25maWdWYWx1ZSgnZm9ybXMucmVnaXN0ZXIucmVkaXJlY3REZWxheScpO1xuICAgICAgICB0aGlzLnNob3dNZXNzYWdlcyA9IHRoaXMuZ2V0Q29uZmlnVmFsdWUoJ2Zvcm1zLnJlZ2lzdGVyLnNob3dNZXNzYWdlcycpO1xuICAgICAgICB0aGlzLnN0cmF0ZWd5ID0gdGhpcy5nZXRDb25maWdWYWx1ZSgnZm9ybXMucmVnaXN0ZXIuc3RyYXRlZ3knKTtcbiAgICAgICAgdGhpcy5zb2NpYWxMaW5rcyA9IHRoaXMuZ2V0Q29uZmlnVmFsdWUoJ2Zvcm1zLmxvZ2luLnNvY2lhbExpbmtzJyk7XG4gICAgfVxuICAgIHJlZ2lzdGVyKCkge1xuICAgICAgICB0aGlzLmVycm9ycyA9IHRoaXMubWVzc2FnZXMgPSBbXTtcbiAgICAgICAgdGhpcy5zdWJtaXR0ZWQgPSB0cnVlO1xuICAgICAgICB0aGlzLnNlcnZpY2UucmVnaXN0ZXIodGhpcy5zdHJhdGVneSwgdGhpcy51c2VyKS5zdWJzY3JpYmUoKHJlc3VsdCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5zdWJtaXR0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIGlmIChyZXN1bHQuaXNTdWNjZXNzKCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm1lc3NhZ2VzID0gcmVzdWx0LmdldE1lc3NhZ2VzKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLmVycm9ycyA9IHJlc3VsdC5nZXRFcnJvcnMoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IHJlZGlyZWN0ID0gcmVzdWx0LmdldFJlZGlyZWN0KCk7XG4gICAgICAgICAgICBpZiAocmVkaXJlY3QpIHtcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucm91dGVyLm5hdmlnYXRlQnlVcmwocmVkaXJlY3QpO1xuICAgICAgICAgICAgICAgIH0sIHRoaXMucmVkaXJlY3REZWxheSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmNkLmRldGVjdENoYW5nZXMoKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGdldENvbmZpZ1ZhbHVlKGtleSkge1xuICAgICAgICByZXR1cm4gZ2V0RGVlcEZyb21PYmplY3QodGhpcy5vcHRpb25zLCBrZXksIG51bGwpO1xuICAgIH1cbn07XG5OYlJlZ2lzdGVyQ29tcG9uZW50ID0gX19kZWNvcmF0ZSQxMShbXG4gICAgQ29tcG9uZW50KHtcbiAgICAgICAgc2VsZWN0b3I6ICduYi1yZWdpc3RlcicsXG4gICAgICAgIHRlbXBsYXRlOiBcIjxoMSBpZD1cXFwidGl0bGVcXFwiIGNsYXNzPVxcXCJ0aXRsZVxcXCI+UmVnaXN0ZXI8L2gxPlxcblxcbjxuYi1hbGVydCAqbmdJZj1cXFwic2hvd01lc3NhZ2VzLmVycm9yICYmIGVycm9ycz8ubGVuZ3RoICYmICFzdWJtaXR0ZWRcXFwiIG91dGxpbmU9XFxcImRhbmdlclxcXCIgcm9sZT1cXFwiYWxlcnRcXFwiPlxcbiAgPHAgY2xhc3M9XFxcImFsZXJ0LXRpdGxlXFxcIj48Yj5PaCBzbmFwITwvYj48L3A+XFxuICA8dWwgY2xhc3M9XFxcImFsZXJ0LW1lc3NhZ2UtbGlzdFxcXCI+XFxuICAgIDxsaSAqbmdGb3I9XFxcImxldCBlcnJvciBvZiBlcnJvcnNcXFwiIGNsYXNzPVxcXCJhbGVydC1tZXNzYWdlXFxcIj57eyBlcnJvciB9fTwvbGk+XFxuICA8L3VsPlxcbjwvbmItYWxlcnQ+XFxuXFxuPG5iLWFsZXJ0ICpuZ0lmPVxcXCJzaG93TWVzc2FnZXMuc3VjY2VzcyAmJiBtZXNzYWdlcz8ubGVuZ3RoICYmICFzdWJtaXR0ZWRcXFwiIG91dGxpbmU9XFxcInN1Y2Nlc3NcXFwiIHJvbGU9XFxcImFsZXJ0XFxcIj5cXG4gIDxwIGNsYXNzPVxcXCJhbGVydC10aXRsZVxcXCI+PGI+SG9vcmF5ITwvYj48L3A+XFxuICA8dWwgY2xhc3M9XFxcImFsZXJ0LW1lc3NhZ2UtbGlzdFxcXCI+XFxuICAgIDxsaSAqbmdGb3I9XFxcImxldCBtZXNzYWdlIG9mIG1lc3NhZ2VzXFxcIiBjbGFzcz1cXFwiYWxlcnQtbWVzc2FnZVxcXCI+e3sgbWVzc2FnZSB9fTwvbGk+XFxuICA8L3VsPlxcbjwvbmItYWxlcnQ+XFxuXFxuPGZvcm0gKG5nU3VibWl0KT1cXFwicmVnaXN0ZXIoKVxcXCIgI2Zvcm09XFxcIm5nRm9ybVxcXCIgYXJpYS1sYWJlbGxlZGJ5PVxcXCJ0aXRsZVxcXCI+XFxuXFxuICA8ZGl2IGNsYXNzPVxcXCJmb3JtLWNvbnRyb2wtZ3JvdXBcXFwiPlxcbiAgICA8bGFiZWwgY2xhc3M9XFxcImxhYmVsXFxcIiBmb3I9XFxcImlucHV0LW5hbWVcXFwiPkZ1bGwgbmFtZTo8L2xhYmVsPlxcbiAgICA8aW5wdXQgbmJJbnB1dFxcbiAgICAgICAgICAgWyhuZ01vZGVsKV09XFxcInVzZXIuZnVsbE5hbWVcXFwiXFxuICAgICAgICAgICAjZnVsbE5hbWU9XFxcIm5nTW9kZWxcXFwiXFxuICAgICAgICAgICBpZD1cXFwiaW5wdXQtbmFtZVxcXCJcXG4gICAgICAgICAgIG5hbWU9XFxcImZ1bGxOYW1lXFxcIlxcbiAgICAgICAgICAgcGxhY2Vob2xkZXI9XFxcIkZ1bGwgbmFtZVxcXCJcXG4gICAgICAgICAgIGF1dG9mb2N1c1xcbiAgICAgICAgICAgZnVsbFdpZHRoXFxuICAgICAgICAgICBmaWVsZFNpemU9XFxcImxhcmdlXFxcIlxcbiAgICAgICAgICAgW3N0YXR1c109XFxcImZ1bGxOYW1lLmRpcnR5ID8gKGZ1bGxOYW1lLmludmFsaWQgID8gJ2RhbmdlcicgOiAnc3VjY2VzcycpIDogJydcXFwiXFxuICAgICAgICAgICBbcmVxdWlyZWRdPVxcXCJnZXRDb25maWdWYWx1ZSgnZm9ybXMudmFsaWRhdGlvbi5mdWxsTmFtZS5yZXF1aXJlZCcpXFxcIlxcbiAgICAgICAgICAgW21pbmxlbmd0aF09XFxcImdldENvbmZpZ1ZhbHVlKCdmb3Jtcy52YWxpZGF0aW9uLmZ1bGxOYW1lLm1pbkxlbmd0aCcpXFxcIlxcbiAgICAgICAgICAgW21heGxlbmd0aF09XFxcImdldENvbmZpZ1ZhbHVlKCdmb3Jtcy52YWxpZGF0aW9uLmZ1bGxOYW1lLm1heExlbmd0aCcpXFxcIlxcbiAgICAgICAgICAgW2F0dHIuYXJpYS1pbnZhbGlkXT1cXFwiZnVsbE5hbWUuaW52YWxpZCAmJiBmdWxsTmFtZS50b3VjaGVkID8gdHJ1ZSA6IG51bGxcXFwiPlxcbiAgICA8bmctY29udGFpbmVyICpuZ0lmPVxcXCJmdWxsTmFtZS5pbnZhbGlkICYmIGZ1bGxOYW1lLnRvdWNoZWRcXFwiPlxcbiAgICAgIDxwIGNsYXNzPVxcXCJjYXB0aW9uIHN0YXR1cy1kYW5nZXJcXFwiICpuZ0lmPVxcXCJmdWxsTmFtZS5lcnJvcnM/LnJlcXVpcmVkXFxcIj5cXG4gICAgICAgIEZ1bGwgbmFtZSBpcyByZXF1aXJlZCFcXG4gICAgICA8L3A+XFxuICAgICAgPHAgY2xhc3M9XFxcImNhcHRpb24gc3RhdHVzLWRhbmdlclxcXCIgKm5nSWY9XFxcImZ1bGxOYW1lLmVycm9ycz8ubWlubGVuZ3RoIHx8IGZ1bGxOYW1lLmVycm9ycz8ubWF4bGVuZ3RoXFxcIj5cXG4gICAgICAgIEZ1bGwgbmFtZSBzaG91bGQgY29udGFpbnNcXG4gICAgICAgIGZyb20ge3tnZXRDb25maWdWYWx1ZSgnZm9ybXMudmFsaWRhdGlvbi5mdWxsTmFtZS5taW5MZW5ndGgnKX19XFxuICAgICAgICB0byB7e2dldENvbmZpZ1ZhbHVlKCdmb3Jtcy52YWxpZGF0aW9uLmZ1bGxOYW1lLm1heExlbmd0aCcpfX1cXG4gICAgICAgIGNoYXJhY3RlcnNcXG4gICAgICA8L3A+XFxuICAgIDwvbmctY29udGFpbmVyPlxcbiAgPC9kaXY+XFxuXFxuICA8ZGl2IGNsYXNzPVxcXCJmb3JtLWNvbnRyb2wtZ3JvdXBcXFwiPlxcbiAgICA8bGFiZWwgY2xhc3M9XFxcImxhYmVsXFxcIiBmb3I9XFxcImlucHV0LWVtYWlsXFxcIj5FbWFpbCBhZGRyZXNzOjwvbGFiZWw+XFxuICAgIDxpbnB1dCBuYklucHV0XFxuICAgICAgICAgICBbKG5nTW9kZWwpXT1cXFwidXNlci5lbWFpbFxcXCJcXG4gICAgICAgICAgICNlbWFpbD1cXFwibmdNb2RlbFxcXCJcXG4gICAgICAgICAgIGlkPVxcXCJpbnB1dC1lbWFpbFxcXCJcXG4gICAgICAgICAgIG5hbWU9XFxcImVtYWlsXFxcIlxcbiAgICAgICAgICAgcGF0dGVybj1cXFwiLitALisuLitcXFwiXFxuICAgICAgICAgICBwbGFjZWhvbGRlcj1cXFwiRW1haWwgYWRkcmVzc1xcXCJcXG4gICAgICAgICAgIGZ1bGxXaWR0aFxcbiAgICAgICAgICAgZmllbGRTaXplPVxcXCJsYXJnZVxcXCJcXG4gICAgICAgICAgIFtzdGF0dXNdPVxcXCJlbWFpbC5kaXJ0eSA/IChlbWFpbC5pbnZhbGlkICA/ICdkYW5nZXInIDogJ3N1Y2Nlc3MnKSA6ICcnXFxcIlxcbiAgICAgICAgICAgW3JlcXVpcmVkXT1cXFwiZ2V0Q29uZmlnVmFsdWUoJ2Zvcm1zLnZhbGlkYXRpb24uZW1haWwucmVxdWlyZWQnKVxcXCJcXG4gICAgICAgICAgIFthdHRyLmFyaWEtaW52YWxpZF09XFxcImVtYWlsLmludmFsaWQgJiYgZW1haWwudG91Y2hlZCA/IHRydWUgOiBudWxsXFxcIj5cXG4gICAgPG5nLWNvbnRhaW5lciAqbmdJZj1cXFwiZW1haWwuaW52YWxpZCAmJiBlbWFpbC50b3VjaGVkXFxcIj5cXG4gICAgICA8cCBjbGFzcz1cXFwiY2FwdGlvbiBzdGF0dXMtZGFuZ2VyXFxcIiAqbmdJZj1cXFwiZW1haWwuZXJyb3JzPy5yZXF1aXJlZFxcXCI+XFxuICAgICAgICBFbWFpbCBpcyByZXF1aXJlZCFcXG4gICAgICA8L3A+XFxuICAgICAgPHAgY2xhc3M9XFxcImNhcHRpb24gc3RhdHVzLWRhbmdlclxcXCIgKm5nSWY9XFxcImVtYWlsLmVycm9ycz8ucGF0dGVyblxcXCI+XFxuICAgICAgICBFbWFpbCBzaG91bGQgYmUgdGhlIHJlYWwgb25lIVxcbiAgICAgIDwvcD5cXG4gICAgPC9uZy1jb250YWluZXI+XFxuICA8L2Rpdj5cXG5cXG4gIDxkaXYgY2xhc3M9XFxcImZvcm0tY29udHJvbC1ncm91cFxcXCI+XFxuICAgIDxsYWJlbCBjbGFzcz1cXFwibGFiZWxcXFwiIGZvcj1cXFwiaW5wdXQtcGFzc3dvcmRcXFwiPlBhc3N3b3JkOjwvbGFiZWw+XFxuICAgIDxpbnB1dCBuYklucHV0XFxuICAgICAgICAgICBbKG5nTW9kZWwpXT1cXFwidXNlci5wYXNzd29yZFxcXCJcXG4gICAgICAgICAgICNwYXNzd29yZD1cXFwibmdNb2RlbFxcXCJcXG4gICAgICAgICAgIHR5cGU9XFxcInBhc3N3b3JkXFxcIlxcbiAgICAgICAgICAgaWQ9XFxcImlucHV0LXBhc3N3b3JkXFxcIlxcbiAgICAgICAgICAgbmFtZT1cXFwicGFzc3dvcmRcXFwiXFxuICAgICAgICAgICBwbGFjZWhvbGRlcj1cXFwiUGFzc3dvcmRcXFwiXFxuICAgICAgICAgICBmdWxsV2lkdGhcXG4gICAgICAgICAgIGZpZWxkU2l6ZT1cXFwibGFyZ2VcXFwiXFxuICAgICAgICAgICBbc3RhdHVzXT1cXFwicGFzc3dvcmQuZGlydHkgPyAocGFzc3dvcmQuaW52YWxpZCAgPyAnZGFuZ2VyJyA6ICdzdWNjZXNzJykgOiAnJ1xcXCJcXG4gICAgICAgICAgIFtyZXF1aXJlZF09XFxcImdldENvbmZpZ1ZhbHVlKCdmb3Jtcy52YWxpZGF0aW9uLnBhc3N3b3JkLnJlcXVpcmVkJylcXFwiXFxuICAgICAgICAgICBbbWlubGVuZ3RoXT1cXFwiZ2V0Q29uZmlnVmFsdWUoJ2Zvcm1zLnZhbGlkYXRpb24ucGFzc3dvcmQubWluTGVuZ3RoJylcXFwiXFxuICAgICAgICAgICBbbWF4bGVuZ3RoXT1cXFwiZ2V0Q29uZmlnVmFsdWUoJ2Zvcm1zLnZhbGlkYXRpb24ucGFzc3dvcmQubWF4TGVuZ3RoJylcXFwiXFxuICAgICAgICAgICBbYXR0ci5hcmlhLWludmFsaWRdPVxcXCJwYXNzd29yZC5pbnZhbGlkICYmIHBhc3N3b3JkLnRvdWNoZWQgPyB0cnVlIDogbnVsbFxcXCI+XFxuICAgIDxuZy1jb250YWluZXIgKm5nSWY9XFxcInBhc3N3b3JkLmludmFsaWQgJiYgcGFzc3dvcmQudG91Y2hlZFxcXCI+XFxuICAgICAgPHAgY2xhc3M9XFxcImNhcHRpb24gc3RhdHVzLWRhbmdlclxcXCIgKm5nSWY9XFxcInBhc3N3b3JkLmVycm9ycz8ucmVxdWlyZWRcXFwiPlxcbiAgICAgICAgUGFzc3dvcmQgaXMgcmVxdWlyZWQhXFxuICAgICAgPC9wPlxcbiAgICAgIDxwIGNsYXNzPVxcXCJjYXB0aW9uIHN0YXR1cy1kYW5nZXJcXFwiICpuZ0lmPVxcXCJwYXNzd29yZC5lcnJvcnM/Lm1pbmxlbmd0aCB8fCBwYXNzd29yZC5lcnJvcnM/Lm1heGxlbmd0aFxcXCI+XFxuICAgICAgICBQYXNzd29yZCBzaG91bGQgY29udGFpblxcbiAgICAgICAgZnJvbSB7eyBnZXRDb25maWdWYWx1ZSgnZm9ybXMudmFsaWRhdGlvbi5wYXNzd29yZC5taW5MZW5ndGgnKSB9fVxcbiAgICAgICAgdG8ge3sgZ2V0Q29uZmlnVmFsdWUoJ2Zvcm1zLnZhbGlkYXRpb24ucGFzc3dvcmQubWF4TGVuZ3RoJykgfX1cXG4gICAgICAgIGNoYXJhY3RlcnNcXG4gICAgICA8L3A+XFxuICAgIDwvbmctY29udGFpbmVyPlxcbiAgPC9kaXY+XFxuXFxuICA8ZGl2IGNsYXNzPVxcXCJmb3JtLWNvbnRyb2wtZ3JvdXBcXFwiPlxcbiAgICA8bGFiZWwgY2xhc3M9XFxcImxhYmVsXFxcIiBmb3I9XFxcImlucHV0LXJlLXBhc3N3b3JkXFxcIj5SZXBlYXQgcGFzc3dvcmQ6PC9sYWJlbD5cXG4gICAgPGlucHV0IG5iSW5wdXRcXG4gICAgICAgICAgIFsobmdNb2RlbCldPVxcXCJ1c2VyLmNvbmZpcm1QYXNzd29yZFxcXCJcXG4gICAgICAgICAgICNyZVBhc3M9XFxcIm5nTW9kZWxcXFwiXFxuICAgICAgICAgICB0eXBlPVxcXCJwYXNzd29yZFxcXCJcXG4gICAgICAgICAgIGlkPVxcXCJpbnB1dC1yZS1wYXNzd29yZFxcXCJcXG4gICAgICAgICAgIG5hbWU9XFxcInJlUGFzc1xcXCJcXG4gICAgICAgICAgIHBsYWNlaG9sZGVyPVxcXCJDb25maXJtIFBhc3N3b3JkXFxcIlxcbiAgICAgICAgICAgZnVsbFdpZHRoXFxuICAgICAgICAgICBmaWVsZFNpemU9XFxcImxhcmdlXFxcIlxcbiAgICAgICAgICAgW3N0YXR1c109XFxcInJlUGFzcy5kaXJ0eSA/IChyZVBhc3MuaW52YWxpZCB8fCBwYXNzd29yZC52YWx1ZSAhPSByZVBhc3MudmFsdWUgID8gJ2RhbmdlcicgOiAnc3VjY2VzcycpIDogJydcXFwiXFxuICAgICAgICAgICBbcmVxdWlyZWRdPVxcXCJnZXRDb25maWdWYWx1ZSgnZm9ybXMudmFsaWRhdGlvbi5wYXNzd29yZC5yZXF1aXJlZCcpXFxcIlxcbiAgICAgICAgICAgW2F0dHIuYXJpYS1pbnZhbGlkXT1cXFwicmVQYXNzLmludmFsaWQgJiYgcmVQYXNzLnRvdWNoZWQgPyB0cnVlIDogbnVsbFxcXCI+XFxuICAgIDxuZy1jb250YWluZXIgKm5nSWY9XFxcInJlUGFzcy5pbnZhbGlkICYmIHJlUGFzcy50b3VjaGVkXFxcIj5cXG4gICAgICA8cCBjbGFzcz1cXFwiY2FwdGlvbiBzdGF0dXMtZGFuZ2VyXFxcIiAqbmdJZj1cXFwicmVQYXNzLmVycm9ycz8ucmVxdWlyZWRcXFwiPlxcbiAgICAgICAgUGFzc3dvcmQgY29uZmlybWF0aW9uIGlzIHJlcXVpcmVkIVxcbiAgICAgIDwvcD5cXG4gICAgICA8cCBjbGFzcz1cXFwiY2FwdGlvbiBzdGF0dXMtZGFuZ2VyXFxcIiAqbmdJZj1cXFwicGFzc3dvcmQudmFsdWUgIT0gcmVQYXNzLnZhbHVlICYmICFyZVBhc3MuZXJyb3JzPy5yZXF1aXJlZFxcXCI+XFxuICAgICAgICBQYXNzd29yZCBkb2VzIG5vdCBtYXRjaCB0aGUgY29uZmlybSBwYXNzd29yZC5cXG4gICAgICA8L3A+XFxuICAgIDwvbmctY29udGFpbmVyPlxcbiAgPC9kaXY+XFxuXFxuICA8ZGl2IGNsYXNzPVxcXCJmb3JtLWNvbnRyb2wtZ3JvdXAgYWNjZXB0LWdyb3VwXFxcIiAqbmdJZj1cXFwiZ2V0Q29uZmlnVmFsdWUoJ2Zvcm1zLnJlZ2lzdGVyLnRlcm1zJylcXFwiPlxcbiAgICA8bmItY2hlY2tib3ggbmFtZT1cXFwidGVybXNcXFwiIFsobmdNb2RlbCldPVxcXCJ1c2VyLnRlcm1zXFxcIiBbcmVxdWlyZWRdPVxcXCJnZXRDb25maWdWYWx1ZSgnZm9ybXMucmVnaXN0ZXIudGVybXMnKVxcXCI+XFxuICAgICAgQWdyZWUgdG8gPGEgaHJlZj1cXFwiI1xcXCIgdGFyZ2V0PVxcXCJfYmxhbmtcXFwiPjxzdHJvbmc+VGVybXMgJiBDb25kaXRpb25zPC9zdHJvbmc+PC9hPlxcbiAgICA8L25iLWNoZWNrYm94PlxcbiAgPC9kaXY+XFxuXFxuICA8YnV0dG9uIG5iQnV0dG9uXFxuICAgICAgICAgIGZ1bGxXaWR0aFxcbiAgICAgICAgICBzdGF0dXM9XFxcInByaW1hcnlcXFwiXFxuICAgICAgICAgIHNpemU9XFxcImxhcmdlXFxcIlxcbiAgICAgICAgICBbZGlzYWJsZWRdPVxcXCJzdWJtaXR0ZWQgfHwgIWZvcm0udmFsaWRcXFwiXFxuICAgICAgICAgIFtjbGFzcy5idG4tcHVsc2VdPVxcXCJzdWJtaXR0ZWRcXFwiPlxcbiAgICBSZWdpc3RlclxcbiAgPC9idXR0b24+XFxuPC9mb3JtPlxcblxcbjxzZWN0aW9uICpuZ0lmPVxcXCJzb2NpYWxMaW5rcyAmJiBzb2NpYWxMaW5rcy5sZW5ndGggPiAwXFxcIiBjbGFzcz1cXFwibGlua3NcXFwiIGFyaWEtbGFiZWw9XFxcIlNvY2lhbCBzaWduIGluXFxcIj5cXG4gIG9yIGVudGVyIHdpdGg6XFxuICA8ZGl2IGNsYXNzPVxcXCJzb2NpYWxzXFxcIj5cXG4gICAgPG5nLWNvbnRhaW5lciAqbmdGb3I9XFxcImxldCBzb2NpYWxMaW5rIG9mIHNvY2lhbExpbmtzXFxcIj5cXG4gICAgICA8YSAqbmdJZj1cXFwic29jaWFsTGluay5saW5rXFxcIlxcbiAgICAgICAgIFtyb3V0ZXJMaW5rXT1cXFwic29jaWFsTGluay5saW5rXFxcIlxcbiAgICAgICAgIFthdHRyLnRhcmdldF09XFxcInNvY2lhbExpbmsudGFyZ2V0XFxcIlxcbiAgICAgICAgIFthdHRyLmNsYXNzXT1cXFwic29jaWFsTGluay5pY29uXFxcIlxcbiAgICAgICAgIFtjbGFzcy53aXRoLWljb25dPVxcXCJzb2NpYWxMaW5rLmljb25cXFwiPlxcbiAgICAgICAgPG5iLWljb24gKm5nSWY9XFxcInNvY2lhbExpbmsuaWNvbjsgZWxzZSB0aXRsZVxcXCIgW2ljb25dPVxcXCJzb2NpYWxMaW5rLmljb25cXFwiPjwvbmItaWNvbj5cXG4gICAgICAgIDxuZy10ZW1wbGF0ZSAjdGl0bGU+e3sgc29jaWFsTGluay50aXRsZSB9fTwvbmctdGVtcGxhdGU+XFxuICAgICAgPC9hPlxcbiAgICAgIDxhICpuZ0lmPVxcXCJzb2NpYWxMaW5rLnVybFxcXCJcXG4gICAgICAgICBbYXR0ci5ocmVmXT1cXFwic29jaWFsTGluay51cmxcXFwiXFxuICAgICAgICAgW2F0dHIudGFyZ2V0XT1cXFwic29jaWFsTGluay50YXJnZXRcXFwiXFxuICAgICAgICAgW2F0dHIuY2xhc3NdPVxcXCJzb2NpYWxMaW5rLmljb25cXFwiXFxuICAgICAgICAgW2NsYXNzLndpdGgtaWNvbl09XFxcInNvY2lhbExpbmsuaWNvblxcXCI+XFxuICAgICAgICA8bmItaWNvbiAqbmdJZj1cXFwic29jaWFsTGluay5pY29uOyBlbHNlIHRpdGxlXFxcIiBbaWNvbl09XFxcInNvY2lhbExpbmsuaWNvblxcXCI+PC9uYi1pY29uPlxcbiAgICAgICAgPG5nLXRlbXBsYXRlICN0aXRsZT57eyBzb2NpYWxMaW5rLnRpdGxlIH19PC9uZy10ZW1wbGF0ZT5cXG4gICAgICA8L2E+XFxuICAgIDwvbmctY29udGFpbmVyPlxcbiAgPC9kaXY+XFxuPC9zZWN0aW9uPlxcblxcbjxzZWN0aW9uIGNsYXNzPVxcXCJhbm90aGVyLWFjdGlvblxcXCIgYXJpYS1sYWJlbD1cXFwiU2lnbiBpblxcXCI+XFxuICBBbHJlYWR5IGhhdmUgYW4gYWNjb3VudD8gPGEgY2xhc3M9XFxcInRleHQtbGlua1xcXCIgcm91dGVyTGluaz1cXFwiLi4vbG9naW5cXFwiPkxvZyBpbjwvYT5cXG48L3NlY3Rpb24+XFxuXCIsXG4gICAgICAgIGNoYW5nZURldGVjdGlvbjogQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3kuT25QdXNoLFxuICAgICAgICBzdHlsZXM6IFtcIjpob3N0IC50aXRsZXttYXJnaW4tYm90dG9tOjJyZW19XFxuXCJdXG4gICAgfSksXG4gICAgX19wYXJhbSQ0KDEsIEluamVjdChOQl9BVVRIX09QVElPTlMpKSxcbiAgICBfX21ldGFkYXRhJDgoXCJkZXNpZ246cGFyYW10eXBlc1wiLCBbTmJBdXRoU2VydmljZSwgT2JqZWN0LCBDaGFuZ2VEZXRlY3RvclJlZixcbiAgICAgICAgUm91dGVyXSlcbl0sIE5iUmVnaXN0ZXJDb21wb25lbnQpO1xuXG52YXIgX19kZWNvcmF0ZSQxMiA9ICh0aGlzICYmIHRoaXMuX19kZWNvcmF0ZSkgfHwgZnVuY3Rpb24gKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKSB7XG4gICAgdmFyIGMgPSBhcmd1bWVudHMubGVuZ3RoLCByID0gYyA8IDMgPyB0YXJnZXQgOiBkZXNjID09PSBudWxsID8gZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBrZXkpIDogZGVzYywgZDtcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QuZGVjb3JhdGUgPT09IFwiZnVuY3Rpb25cIikgciA9IFJlZmxlY3QuZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpO1xuICAgIGVsc2UgZm9yICh2YXIgaSA9IGRlY29yYXRvcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIGlmIChkID0gZGVjb3JhdG9yc1tpXSkgciA9IChjIDwgMyA/IGQocikgOiBjID4gMyA/IGQodGFyZ2V0LCBrZXksIHIpIDogZCh0YXJnZXQsIGtleSkpIHx8IHI7XG4gICAgcmV0dXJuIGMgPiAzICYmIHIgJiYgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCByKSwgcjtcbn07XG52YXIgX19tZXRhZGF0YSQ5ID0gKHRoaXMgJiYgdGhpcy5fX21ldGFkYXRhKSB8fCBmdW5jdGlvbiAoaywgdikge1xuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5tZXRhZGF0YSA9PT0gXCJmdW5jdGlvblwiKSByZXR1cm4gUmVmbGVjdC5tZXRhZGF0YShrLCB2KTtcbn07XG52YXIgX19wYXJhbSQ1ID0gKHRoaXMgJiYgdGhpcy5fX3BhcmFtKSB8fCBmdW5jdGlvbiAocGFyYW1JbmRleCwgZGVjb3JhdG9yKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YXJnZXQsIGtleSkgeyBkZWNvcmF0b3IodGFyZ2V0LCBrZXksIHBhcmFtSW5kZXgpOyB9XG59O1xuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IEFrdmVvLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICogTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLiBTZWUgTGljZW5zZS50eHQgaW4gdGhlIHByb2plY3Qgcm9vdCBmb3IgbGljZW5zZSBpbmZvcm1hdGlvbi5cbiAqL1xubGV0IE5iTG9nb3V0Q29tcG9uZW50ID0gY2xhc3MgTmJMb2dvdXRDb21wb25lbnQge1xuICAgIGNvbnN0cnVjdG9yKHNlcnZpY2UsIG9wdGlvbnMgPSB7fSwgcm91dGVyKSB7XG4gICAgICAgIHRoaXMuc2VydmljZSA9IHNlcnZpY2U7XG4gICAgICAgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnM7XG4gICAgICAgIHRoaXMucm91dGVyID0gcm91dGVyO1xuICAgICAgICB0aGlzLnJlZGlyZWN0RGVsYXkgPSAwO1xuICAgICAgICB0aGlzLnN0cmF0ZWd5ID0gJyc7XG4gICAgICAgIHRoaXMucmVkaXJlY3REZWxheSA9IHRoaXMuZ2V0Q29uZmlnVmFsdWUoJ2Zvcm1zLmxvZ291dC5yZWRpcmVjdERlbGF5Jyk7XG4gICAgICAgIHRoaXMuc3RyYXRlZ3kgPSB0aGlzLmdldENvbmZpZ1ZhbHVlKCdmb3Jtcy5sb2dvdXQuc3RyYXRlZ3knKTtcbiAgICB9XG4gICAgbmdPbkluaXQoKSB7XG4gICAgICAgIHRoaXMubG9nb3V0KHRoaXMuc3RyYXRlZ3kpO1xuICAgIH1cbiAgICBsb2dvdXQoc3RyYXRlZ3kpIHtcbiAgICAgICAgdGhpcy5zZXJ2aWNlLmxvZ291dChzdHJhdGVneSkuc3Vic2NyaWJlKChyZXN1bHQpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHJlZGlyZWN0ID0gcmVzdWx0LmdldFJlZGlyZWN0KCk7XG4gICAgICAgICAgICBpZiAocmVkaXJlY3QpIHtcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucm91dGVyLm5hdmlnYXRlQnlVcmwocmVkaXJlY3QpO1xuICAgICAgICAgICAgICAgIH0sIHRoaXMucmVkaXJlY3REZWxheSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBnZXRDb25maWdWYWx1ZShrZXkpIHtcbiAgICAgICAgcmV0dXJuIGdldERlZXBGcm9tT2JqZWN0KHRoaXMub3B0aW9ucywga2V5LCBudWxsKTtcbiAgICB9XG59O1xuTmJMb2dvdXRDb21wb25lbnQgPSBfX2RlY29yYXRlJDEyKFtcbiAgICBDb21wb25lbnQoe1xuICAgICAgICBzZWxlY3RvcjogJ25iLWxvZ291dCcsXG4gICAgICAgIHRlbXBsYXRlOiBcIjxkaXY+TG9nZ2luZyBvdXQsIHBsZWFzZSB3YWl0Li4uPC9kaXY+XFxuXCJcbiAgICB9KSxcbiAgICBfX3BhcmFtJDUoMSwgSW5qZWN0KE5CX0FVVEhfT1BUSU9OUykpLFxuICAgIF9fbWV0YWRhdGEkOShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtOYkF1dGhTZXJ2aWNlLCBPYmplY3QsIFJvdXRlcl0pXG5dLCBOYkxvZ291dENvbXBvbmVudCk7XG5cbnZhciBfX2RlY29yYXRlJDEzID0gKHRoaXMgJiYgdGhpcy5fX2RlY29yYXRlKSB8fCBmdW5jdGlvbiAoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpIHtcbiAgICB2YXIgYyA9IGFyZ3VtZW50cy5sZW5ndGgsIHIgPSBjIDwgMyA/IHRhcmdldCA6IGRlc2MgPT09IG51bGwgPyBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0YXJnZXQsIGtleSkgOiBkZXNjLCBkO1xuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5kZWNvcmF0ZSA9PT0gXCJmdW5jdGlvblwiKSByID0gUmVmbGVjdC5kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYyk7XG4gICAgZWxzZSBmb3IgKHZhciBpID0gZGVjb3JhdG9ycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgaWYgKGQgPSBkZWNvcmF0b3JzW2ldKSByID0gKGMgPCAzID8gZChyKSA6IGMgPiAzID8gZCh0YXJnZXQsIGtleSwgcikgOiBkKHRhcmdldCwga2V5KSkgfHwgcjtcbiAgICByZXR1cm4gYyA+IDMgJiYgciAmJiBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHIpLCByO1xufTtcbnZhciBfX21ldGFkYXRhJDEwID0gKHRoaXMgJiYgdGhpcy5fX21ldGFkYXRhKSB8fCBmdW5jdGlvbiAoaywgdikge1xuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5tZXRhZGF0YSA9PT0gXCJmdW5jdGlvblwiKSByZXR1cm4gUmVmbGVjdC5tZXRhZGF0YShrLCB2KTtcbn07XG52YXIgX19wYXJhbSQ2ID0gKHRoaXMgJiYgdGhpcy5fX3BhcmFtKSB8fCBmdW5jdGlvbiAocGFyYW1JbmRleCwgZGVjb3JhdG9yKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YXJnZXQsIGtleSkgeyBkZWNvcmF0b3IodGFyZ2V0LCBrZXksIHBhcmFtSW5kZXgpOyB9XG59O1xuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IEFrdmVvLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICogTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLiBTZWUgTGljZW5zZS50eHQgaW4gdGhlIHByb2plY3Qgcm9vdCBmb3IgbGljZW5zZSBpbmZvcm1hdGlvbi5cbiAqL1xubGV0IE5iUmVxdWVzdFBhc3N3b3JkQ29tcG9uZW50ID0gY2xhc3MgTmJSZXF1ZXN0UGFzc3dvcmRDb21wb25lbnQge1xuICAgIGNvbnN0cnVjdG9yKHNlcnZpY2UsIG9wdGlvbnMgPSB7fSwgY2QsIHJvdXRlcikge1xuICAgICAgICB0aGlzLnNlcnZpY2UgPSBzZXJ2aWNlO1xuICAgICAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zO1xuICAgICAgICB0aGlzLmNkID0gY2Q7XG4gICAgICAgIHRoaXMucm91dGVyID0gcm91dGVyO1xuICAgICAgICB0aGlzLnJlZGlyZWN0RGVsYXkgPSAwO1xuICAgICAgICB0aGlzLnNob3dNZXNzYWdlcyA9IHt9O1xuICAgICAgICB0aGlzLnN0cmF0ZWd5ID0gJyc7XG4gICAgICAgIHRoaXMuc3VibWl0dGVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMuZXJyb3JzID0gW107XG4gICAgICAgIHRoaXMubWVzc2FnZXMgPSBbXTtcbiAgICAgICAgdGhpcy51c2VyID0ge307XG4gICAgICAgIHRoaXMucmVkaXJlY3REZWxheSA9IHRoaXMuZ2V0Q29uZmlnVmFsdWUoJ2Zvcm1zLnJlcXVlc3RQYXNzd29yZC5yZWRpcmVjdERlbGF5Jyk7XG4gICAgICAgIHRoaXMuc2hvd01lc3NhZ2VzID0gdGhpcy5nZXRDb25maWdWYWx1ZSgnZm9ybXMucmVxdWVzdFBhc3N3b3JkLnNob3dNZXNzYWdlcycpO1xuICAgICAgICB0aGlzLnN0cmF0ZWd5ID0gdGhpcy5nZXRDb25maWdWYWx1ZSgnZm9ybXMucmVxdWVzdFBhc3N3b3JkLnN0cmF0ZWd5Jyk7XG4gICAgfVxuICAgIHJlcXVlc3RQYXNzKCkge1xuICAgICAgICB0aGlzLmVycm9ycyA9IHRoaXMubWVzc2FnZXMgPSBbXTtcbiAgICAgICAgdGhpcy5zdWJtaXR0ZWQgPSB0cnVlO1xuICAgICAgICB0aGlzLnNlcnZpY2UucmVxdWVzdFBhc3N3b3JkKHRoaXMuc3RyYXRlZ3ksIHRoaXMudXNlcikuc3Vic2NyaWJlKChyZXN1bHQpID0+IHtcbiAgICAgICAgICAgIHRoaXMuc3VibWl0dGVkID0gZmFsc2U7XG4gICAgICAgICAgICBpZiAocmVzdWx0LmlzU3VjY2VzcygpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5tZXNzYWdlcyA9IHJlc3VsdC5nZXRNZXNzYWdlcygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5lcnJvcnMgPSByZXN1bHQuZ2V0RXJyb3JzKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCByZWRpcmVjdCA9IHJlc3VsdC5nZXRSZWRpcmVjdCgpO1xuICAgICAgICAgICAgaWYgKHJlZGlyZWN0KSB7XG4gICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnJvdXRlci5uYXZpZ2F0ZUJ5VXJsKHJlZGlyZWN0KTtcbiAgICAgICAgICAgICAgICB9LCB0aGlzLnJlZGlyZWN0RGVsYXkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5jZC5kZXRlY3RDaGFuZ2VzKCk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBnZXRDb25maWdWYWx1ZShrZXkpIHtcbiAgICAgICAgcmV0dXJuIGdldERlZXBGcm9tT2JqZWN0KHRoaXMub3B0aW9ucywga2V5LCBudWxsKTtcbiAgICB9XG59O1xuTmJSZXF1ZXN0UGFzc3dvcmRDb21wb25lbnQgPSBfX2RlY29yYXRlJDEzKFtcbiAgICBDb21wb25lbnQoe1xuICAgICAgICBzZWxlY3RvcjogJ25iLXJlcXVlc3QtcGFzc3dvcmQtcGFnZScsXG4gICAgICAgIHRlbXBsYXRlOiBcIjxoMSBpZD1cXFwidGl0bGVcXFwiIGNsYXNzPVxcXCJ0aXRsZVxcXCI+Rm9yZ290IFBhc3N3b3JkPC9oMT5cXG48cCBjbGFzcz1cXFwic3ViLXRpdGxlXFxcIj5FbnRlciB5b3VyIGVtYWlsIGFkZHJlc3MgYW5kIHdlXFx1MjAxOWxsIHNlbmQgYSBsaW5rIHRvIHJlc2V0IHlvdXIgcGFzc3dvcmQ8L3A+XFxuXFxuPG5iLWFsZXJ0ICpuZ0lmPVxcXCJzaG93TWVzc2FnZXMuZXJyb3IgJiYgZXJyb3JzPy5sZW5ndGggJiYgIXN1Ym1pdHRlZFxcXCIgb3V0bGluZT1cXFwiZGFuZ2VyXFxcIiByb2xlPVxcXCJhbGVydFxcXCI+XFxuICA8cCBjbGFzcz1cXFwiYWxlcnQtdGl0bGVcXFwiPjxiPk9oIHNuYXAhPC9iPjwvcD5cXG4gIDx1bCBjbGFzcz1cXFwiYWxlcnQtbWVzc2FnZS1saXN0XFxcIj5cXG4gICAgPGxpICpuZ0Zvcj1cXFwibGV0IGVycm9yIG9mIGVycm9yc1xcXCIgY2xhc3M9XFxcImFsZXJ0LW1lc3NhZ2VcXFwiPnt7IGVycm9yIH19PC9saT5cXG4gIDwvdWw+XFxuPC9uYi1hbGVydD5cXG5cXG48bmItYWxlcnQgKm5nSWY9XFxcInNob3dNZXNzYWdlcy5zdWNjZXNzICYmIG1lc3NhZ2VzPy5sZW5ndGggJiYgIXN1Ym1pdHRlZFxcXCIgb3V0bGluZT1cXFwic3VjY2Vzc1xcXCIgcm9sZT1cXFwiYWxlcnRcXFwiPlxcbiAgPHAgY2xhc3M9XFxcImFsZXJ0LXRpdGxlXFxcIj48Yj5Ib29yYXkhPC9iPjwvcD5cXG4gIDx1bCBjbGFzcz1cXFwiYWxlcnQtbWVzc2FnZS1saXN0XFxcIj5cXG4gICAgPGxpICpuZ0Zvcj1cXFwibGV0IG1lc3NhZ2Ugb2YgbWVzc2FnZXNcXFwiIGNsYXNzPVxcXCJhbGVydC1tZXNzYWdlXFxcIj57eyBtZXNzYWdlIH19PC9saT5cXG4gIDwvdWw+XFxuPC9uYi1hbGVydD5cXG5cXG48Zm9ybSAobmdTdWJtaXQpPVxcXCJyZXF1ZXN0UGFzcygpXFxcIiAjcmVxdWVzdFBhc3NGb3JtPVxcXCJuZ0Zvcm1cXFwiIGFyaWEtbGFiZWxsZWRieT1cXFwidGl0bGVcXFwiPlxcblxcbiAgPGRpdiBjbGFzcz1cXFwiZm9ybS1jb250cm9sLWdyb3VwXFxcIj5cXG4gICAgPGxhYmVsIGNsYXNzPVxcXCJsYWJlbFxcXCIgZm9yPVxcXCJpbnB1dC1lbWFpbFxcXCI+RW50ZXIgeW91ciBlbWFpbCBhZGRyZXNzOjwvbGFiZWw+XFxuICAgIDxpbnB1dCBuYklucHV0XFxuICAgICAgICAgICBbKG5nTW9kZWwpXT1cXFwidXNlci5lbWFpbFxcXCJcXG4gICAgICAgICAgICNlbWFpbD1cXFwibmdNb2RlbFxcXCJcXG4gICAgICAgICAgIGlkPVxcXCJpbnB1dC1lbWFpbFxcXCJcXG4gICAgICAgICAgIG5hbWU9XFxcImVtYWlsXFxcIlxcbiAgICAgICAgICAgcGF0dGVybj1cXFwiLitALitcXFxcLi4rXFxcIlxcbiAgICAgICAgICAgcGxhY2Vob2xkZXI9XFxcIkVtYWlsIGFkZHJlc3NcXFwiXFxuICAgICAgICAgICBhdXRvZm9jdXNcXG4gICAgICAgICAgIGZ1bGxXaWR0aFxcbiAgICAgICAgICAgZmllbGRTaXplPVxcXCJsYXJnZVxcXCJcXG4gICAgICAgICAgIFtzdGF0dXNdPVxcXCJlbWFpbC5kaXJ0eSA/IChlbWFpbC5pbnZhbGlkICA/ICdkYW5nZXInIDogJ3N1Y2Nlc3MnKSA6ICcnXFxcIlxcbiAgICAgICAgICAgW3JlcXVpcmVkXT1cXFwiZ2V0Q29uZmlnVmFsdWUoJ2Zvcm1zLnZhbGlkYXRpb24uZW1haWwucmVxdWlyZWQnKVxcXCJcXG4gICAgICAgICAgIFthdHRyLmFyaWEtaW52YWxpZF09XFxcImVtYWlsLmludmFsaWQgJiYgZW1haWwudG91Y2hlZCA/IHRydWUgOiBudWxsXFxcIj5cXG4gICAgPG5nLWNvbnRhaW5lciAqbmdJZj1cXFwiZW1haWwuaW52YWxpZCAmJiBlbWFpbC50b3VjaGVkXFxcIj5cXG4gICAgICA8cCBjbGFzcz1cXFwiY2FwdGlvbiBzdGF0dXMtZGFuZ2VyXFxcIiAqbmdJZj1cXFwiZW1haWwuZXJyb3JzPy5yZXF1aXJlZFxcXCI+XFxuICAgICAgICBFbWFpbCBpcyByZXF1aXJlZCFcXG4gICAgICA8L3A+XFxuICAgICAgPHAgY2xhc3M9XFxcImNhcHRpb24gc3RhdHVzLWRhbmdlclxcXCIgKm5nSWY9XFxcImVtYWlsLmVycm9ycz8ucGF0dGVyblxcXCI+XFxuICAgICAgICBFbWFpbCBzaG91bGQgYmUgdGhlIHJlYWwgb25lIVxcbiAgICAgIDwvcD5cXG4gICAgPC9uZy1jb250YWluZXI+XFxuICA8L2Rpdj5cXG5cXG4gIDxidXR0b24gbmJCdXR0b25cXG4gICAgICAgICAgZnVsbFdpZHRoXFxuICAgICAgICAgIHN0YXR1cz1cXFwicHJpbWFyeVxcXCJcXG4gICAgICAgICAgc2l6ZT1cXFwibGFyZ2VcXFwiXFxuICAgICAgICAgIFtkaXNhYmxlZF09XFxcInN1Ym1pdHRlZCB8fCAhcmVxdWVzdFBhc3NGb3JtLnZhbGlkXFxcIlxcbiAgICAgICAgICBbY2xhc3MuYnRuLXB1bHNlXT1cXFwic3VibWl0dGVkXFxcIj5cXG4gICAgUmVxdWVzdCBwYXNzd29yZFxcbiAgPC9idXR0b24+XFxuPC9mb3JtPlxcblxcbjxzZWN0aW9uIGNsYXNzPVxcXCJzaWduLWluLW9yLXVwXFxcIiBhcmlhLWxhYmVsPVxcXCJTaWduIGluIG9yIHNpZ24gdXBcXFwiPlxcbiAgPHA+PGEgY2xhc3M9XFxcInRleHQtbGlua1xcXCIgcm91dGVyTGluaz1cXFwiLi4vbG9naW5cXFwiPkJhY2sgdG8gTG9nIEluPC9hPjwvcD5cXG4gIDxwPjxhIHJvdXRlckxpbms9XFxcIi4uL3JlZ2lzdGVyXFxcIiBjbGFzcz1cXFwidGV4dC1saW5rXFxcIj5SZWdpc3RlcjwvYT48L3A+XFxuPC9zZWN0aW9uPlxcblwiLFxuICAgICAgICBjaGFuZ2VEZXRlY3Rpb246IENoYW5nZURldGVjdGlvblN0cmF0ZWd5Lk9uUHVzaCxcbiAgICAgICAgc3R5bGVzOiBbXCI6aG9zdCAuZm9ybS1ncm91cDpsYXN0LW9mLXR5cGV7bWFyZ2luLWJvdHRvbTozcmVtfVxcblwiXVxuICAgIH0pLFxuICAgIF9fcGFyYW0kNigxLCBJbmplY3QoTkJfQVVUSF9PUFRJT05TKSksXG4gICAgX19tZXRhZGF0YSQxMChcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtOYkF1dGhTZXJ2aWNlLCBPYmplY3QsIENoYW5nZURldGVjdG9yUmVmLFxuICAgICAgICBSb3V0ZXJdKVxuXSwgTmJSZXF1ZXN0UGFzc3dvcmRDb21wb25lbnQpO1xuXG52YXIgX19kZWNvcmF0ZSQxNCA9ICh0aGlzICYmIHRoaXMuX19kZWNvcmF0ZSkgfHwgZnVuY3Rpb24gKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKSB7XG4gICAgdmFyIGMgPSBhcmd1bWVudHMubGVuZ3RoLCByID0gYyA8IDMgPyB0YXJnZXQgOiBkZXNjID09PSBudWxsID8gZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBrZXkpIDogZGVzYywgZDtcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QuZGVjb3JhdGUgPT09IFwiZnVuY3Rpb25cIikgciA9IFJlZmxlY3QuZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpO1xuICAgIGVsc2UgZm9yICh2YXIgaSA9IGRlY29yYXRvcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIGlmIChkID0gZGVjb3JhdG9yc1tpXSkgciA9IChjIDwgMyA/IGQocikgOiBjID4gMyA/IGQodGFyZ2V0LCBrZXksIHIpIDogZCh0YXJnZXQsIGtleSkpIHx8IHI7XG4gICAgcmV0dXJuIGMgPiAzICYmIHIgJiYgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCByKSwgcjtcbn07XG52YXIgX19tZXRhZGF0YSQxMSA9ICh0aGlzICYmIHRoaXMuX19tZXRhZGF0YSkgfHwgZnVuY3Rpb24gKGssIHYpIHtcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QubWV0YWRhdGEgPT09IFwiZnVuY3Rpb25cIikgcmV0dXJuIFJlZmxlY3QubWV0YWRhdGEoaywgdik7XG59O1xudmFyIF9fcGFyYW0kNyA9ICh0aGlzICYmIHRoaXMuX19wYXJhbSkgfHwgZnVuY3Rpb24gKHBhcmFtSW5kZXgsIGRlY29yYXRvcikge1xuICAgIHJldHVybiBmdW5jdGlvbiAodGFyZ2V0LCBrZXkpIHsgZGVjb3JhdG9yKHRhcmdldCwga2V5LCBwYXJhbUluZGV4KTsgfVxufTtcbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCBBa3Zlby4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS4gU2VlIExpY2Vuc2UudHh0IGluIHRoZSBwcm9qZWN0IHJvb3QgZm9yIGxpY2Vuc2UgaW5mb3JtYXRpb24uXG4gKi9cbmxldCBOYlJlc2V0UGFzc3dvcmRDb21wb25lbnQgPSBjbGFzcyBOYlJlc2V0UGFzc3dvcmRDb21wb25lbnQge1xuICAgIGNvbnN0cnVjdG9yKHNlcnZpY2UsIG9wdGlvbnMgPSB7fSwgY2QsIHJvdXRlcikge1xuICAgICAgICB0aGlzLnNlcnZpY2UgPSBzZXJ2aWNlO1xuICAgICAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zO1xuICAgICAgICB0aGlzLmNkID0gY2Q7XG4gICAgICAgIHRoaXMucm91dGVyID0gcm91dGVyO1xuICAgICAgICB0aGlzLnJlZGlyZWN0RGVsYXkgPSAwO1xuICAgICAgICB0aGlzLnNob3dNZXNzYWdlcyA9IHt9O1xuICAgICAgICB0aGlzLnN0cmF0ZWd5ID0gJyc7XG4gICAgICAgIHRoaXMuc3VibWl0dGVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMuZXJyb3JzID0gW107XG4gICAgICAgIHRoaXMubWVzc2FnZXMgPSBbXTtcbiAgICAgICAgdGhpcy51c2VyID0ge307XG4gICAgICAgIHRoaXMucmVkaXJlY3REZWxheSA9IHRoaXMuZ2V0Q29uZmlnVmFsdWUoJ2Zvcm1zLnJlc2V0UGFzc3dvcmQucmVkaXJlY3REZWxheScpO1xuICAgICAgICB0aGlzLnNob3dNZXNzYWdlcyA9IHRoaXMuZ2V0Q29uZmlnVmFsdWUoJ2Zvcm1zLnJlc2V0UGFzc3dvcmQuc2hvd01lc3NhZ2VzJyk7XG4gICAgICAgIHRoaXMuc3RyYXRlZ3kgPSB0aGlzLmdldENvbmZpZ1ZhbHVlKCdmb3Jtcy5yZXNldFBhc3N3b3JkLnN0cmF0ZWd5Jyk7XG4gICAgfVxuICAgIHJlc2V0UGFzcygpIHtcbiAgICAgICAgdGhpcy5lcnJvcnMgPSB0aGlzLm1lc3NhZ2VzID0gW107XG4gICAgICAgIHRoaXMuc3VibWl0dGVkID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5zZXJ2aWNlLnJlc2V0UGFzc3dvcmQodGhpcy5zdHJhdGVneSwgdGhpcy51c2VyKS5zdWJzY3JpYmUoKHJlc3VsdCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5zdWJtaXR0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIGlmIChyZXN1bHQuaXNTdWNjZXNzKCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm1lc3NhZ2VzID0gcmVzdWx0LmdldE1lc3NhZ2VzKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLmVycm9ycyA9IHJlc3VsdC5nZXRFcnJvcnMoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IHJlZGlyZWN0ID0gcmVzdWx0LmdldFJlZGlyZWN0KCk7XG4gICAgICAgICAgICBpZiAocmVkaXJlY3QpIHtcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucm91dGVyLm5hdmlnYXRlQnlVcmwocmVkaXJlY3QpO1xuICAgICAgICAgICAgICAgIH0sIHRoaXMucmVkaXJlY3REZWxheSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmNkLmRldGVjdENoYW5nZXMoKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGdldENvbmZpZ1ZhbHVlKGtleSkge1xuICAgICAgICByZXR1cm4gZ2V0RGVlcEZyb21PYmplY3QodGhpcy5vcHRpb25zLCBrZXksIG51bGwpO1xuICAgIH1cbn07XG5OYlJlc2V0UGFzc3dvcmRDb21wb25lbnQgPSBfX2RlY29yYXRlJDE0KFtcbiAgICBDb21wb25lbnQoe1xuICAgICAgICBzZWxlY3RvcjogJ25iLXJlc2V0LXBhc3N3b3JkLXBhZ2UnLFxuICAgICAgICB0ZW1wbGF0ZTogXCI8aDEgaWQ9XFxcInRpdGxlXFxcIiBjbGFzcz1cXFwidGl0bGVcXFwiPkNoYW5nZSBwYXNzd29yZDwvaDE+XFxuPHAgY2xhc3M9XFxcInN1Yi10aXRsZVxcXCI+UGxlYXNlIHNldCBhIG5ldyBwYXNzd29yZDwvcD5cXG5cXG48bmItYWxlcnQgKm5nSWY9XFxcInNob3dNZXNzYWdlcy5lcnJvciAmJiBlcnJvcnM/Lmxlbmd0aCAmJiAhc3VibWl0dGVkXFxcIiBvdXRsaW5lPVxcXCJkYW5nZXJcXFwiIHJvbGU9XFxcImFsZXJ0XFxcIj5cXG4gIDxwIGNsYXNzPVxcXCJhbGVydC10aXRsZVxcXCI+PGI+T2ggc25hcCE8L2I+PC9wPlxcbiAgPHVsIGNsYXNzPVxcXCJhbGVydC1tZXNzYWdlLWxpc3RcXFwiPlxcbiAgICA8bGkgKm5nRm9yPVxcXCJsZXQgZXJyb3Igb2YgZXJyb3JzXFxcIiBjbGFzcz1cXFwiYWxlcnQtbWVzc2FnZVxcXCI+e3sgZXJyb3IgfX08L2xpPlxcbiAgPC91bD5cXG48L25iLWFsZXJ0PlxcblxcbjxuYi1hbGVydCAqbmdJZj1cXFwic2hvd01lc3NhZ2VzLnN1Y2Nlc3MgJiYgbWVzc2FnZXM/Lmxlbmd0aCAmJiAhc3VibWl0dGVkXFxcIiBvdXRsaW5lPVxcXCJzdWNjZXNzXFxcIiByb2xlPVxcXCJhbGVydFxcXCI+XFxuICA8cCBjbGFzcz1cXFwiYWxlcnQtdGl0bGVcXFwiPjxiPkhvb3JheSE8L2I+PC9wPlxcbiAgPHVsIGNsYXNzPVxcXCJhbGVydC1tZXNzYWdlLWxpc3RcXFwiPlxcbiAgICA8bGkgKm5nRm9yPVxcXCJsZXQgbWVzc2FnZSBvZiBtZXNzYWdlc1xcXCIgY2xhc3M9XFxcImFsZXJ0LW1lc3NhZ2VcXFwiPnt7IG1lc3NhZ2UgfX08L2xpPlxcbiAgPC91bD5cXG48L25iLWFsZXJ0Plxcblxcbjxmb3JtIChuZ1N1Ym1pdCk9XFxcInJlc2V0UGFzcygpXFxcIiAjcmVzZXRQYXNzRm9ybT1cXFwibmdGb3JtXFxcIiBhcmlhLWxhYmVsbGVkYnk9XFxcInRpdGxlXFxcIj5cXG5cXG4gIDxkaXYgY2xhc3M9XFxcImZvcm0tY29udHJvbC1ncm91cFxcXCI+XFxuICAgIDxsYWJlbCBjbGFzcz1cXFwibGFiZWxcXFwiIGZvcj1cXFwiaW5wdXQtcGFzc3dvcmRcXFwiPk5ldyBQYXNzd29yZDo8L2xhYmVsPlxcbiAgICA8aW5wdXQgbmJJbnB1dFxcbiAgICAgICAgICAgWyhuZ01vZGVsKV09XFxcInVzZXIucGFzc3dvcmRcXFwiXFxuICAgICAgICAgICAjcGFzc3dvcmQ9XFxcIm5nTW9kZWxcXFwiXFxuICAgICAgICAgICB0eXBlPVxcXCJwYXNzd29yZFxcXCJcXG4gICAgICAgICAgIGlkPVxcXCJpbnB1dC1wYXNzd29yZFxcXCJcXG4gICAgICAgICAgIG5hbWU9XFxcInBhc3N3b3JkXFxcIlxcbiAgICAgICAgICAgY2xhc3M9XFxcImZpcnN0XFxcIlxcbiAgICAgICAgICAgcGxhY2Vob2xkZXI9XFxcIk5ldyBQYXNzd29yZFxcXCJcXG4gICAgICAgICAgIGF1dG9mb2N1c1xcbiAgICAgICAgICAgZnVsbFdpZHRoXFxuICAgICAgICAgICBmaWVsZFNpemU9XFxcImxhcmdlXFxcIlxcbiAgICAgICAgICAgW3N0YXR1c109XFxcInBhc3N3b3JkLmRpcnR5ID8gKHBhc3N3b3JkLmludmFsaWQgID8gJ2RhbmdlcicgOiAnc3VjY2VzcycpIDogJydcXFwiXFxuICAgICAgICAgICBbcmVxdWlyZWRdPVxcXCJnZXRDb25maWdWYWx1ZSgnZm9ybXMudmFsaWRhdGlvbi5wYXNzd29yZC5yZXF1aXJlZCcpXFxcIlxcbiAgICAgICAgICAgW21pbmxlbmd0aF09XFxcImdldENvbmZpZ1ZhbHVlKCdmb3Jtcy52YWxpZGF0aW9uLnBhc3N3b3JkLm1pbkxlbmd0aCcpXFxcIlxcbiAgICAgICAgICAgW21heGxlbmd0aF09XFxcImdldENvbmZpZ1ZhbHVlKCdmb3Jtcy52YWxpZGF0aW9uLnBhc3N3b3JkLm1heExlbmd0aCcpXFxcIlxcbiAgICAgICAgICAgW2F0dHIuYXJpYS1pbnZhbGlkXT1cXFwicGFzc3dvcmQuaW52YWxpZCAmJiBwYXNzd29yZC50b3VjaGVkID8gdHJ1ZSA6IG51bGxcXFwiPlxcbiAgICA8bmctY29udGFpbmVyICpuZ0lmPVxcXCJwYXNzd29yZC5pbnZhbGlkICYmIHBhc3N3b3JkLnRvdWNoZWRcXFwiPlxcbiAgICAgIDxwIGNsYXNzPVxcXCJjYXB0aW9uIHN0YXR1cy1kYW5nZXJcXFwiICpuZ0lmPVxcXCJwYXNzd29yZC5lcnJvcnM/LnJlcXVpcmVkXFxcIj5cXG4gICAgICAgIFBhc3N3b3JkIGlzIHJlcXVpcmVkIVxcbiAgICAgIDwvcD5cXG4gICAgICA8cCBjbGFzcz1cXFwiY2FwdGlvbiBzdGF0dXMtZGFuZ2VyXFxcIiAqbmdJZj1cXFwicGFzc3dvcmQuZXJyb3JzPy5taW5sZW5ndGggfHwgcGFzc3dvcmQuZXJyb3JzPy5tYXhsZW5ndGhcXFwiPlxcbiAgICAgICAgUGFzc3dvcmQgc2hvdWxkIGNvbnRhaW5zXFxuICAgICAgICBmcm9tIHt7Z2V0Q29uZmlnVmFsdWUoJ2Zvcm1zLnZhbGlkYXRpb24ucGFzc3dvcmQubWluTGVuZ3RoJyl9fVxcbiAgICAgICAgdG8ge3tnZXRDb25maWdWYWx1ZSgnZm9ybXMudmFsaWRhdGlvbi5wYXNzd29yZC5tYXhMZW5ndGgnKX19XFxuICAgICAgICBjaGFyYWN0ZXJzXFxuICAgICAgPC9wPlxcbiAgICA8L25nLWNvbnRhaW5lcj5cXG4gIDwvZGl2PlxcblxcbiAgPGRpdiBjbGFzcz1cXFwiZm9ybS1ncm91cFxcXCI+XFxuICAgIDxsYWJlbCBjbGFzcz1cXFwibGFiZWxcXFwiIGZvcj1cXFwiaW5wdXQtcmUtcGFzc3dvcmRcXFwiPkNvbmZpcm0gUGFzc3dvcmQ6PC9sYWJlbD5cXG4gICAgPGlucHV0IG5iSW5wdXRcXG4gICAgICAgICAgIFsobmdNb2RlbCldPVxcXCJ1c2VyLmNvbmZpcm1QYXNzd29yZFxcXCJcXG4gICAgICAgICAgICNyZVBhc3M9XFxcIm5nTW9kZWxcXFwiXFxuICAgICAgICAgICBpZD1cXFwiaW5wdXQtcmUtcGFzc3dvcmRcXFwiXFxuICAgICAgICAgICBuYW1lPVxcXCJyZVBhc3NcXFwiXFxuICAgICAgICAgICB0eXBlPVxcXCJwYXNzd29yZFxcXCJcXG4gICAgICAgICAgIGNsYXNzPVxcXCJsYXN0XFxcIlxcbiAgICAgICAgICAgcGxhY2Vob2xkZXI9XFxcIkNvbmZpcm0gUGFzc3dvcmRcXFwiXFxuICAgICAgICAgICBmdWxsV2lkdGhcXG4gICAgICAgICAgIGZpZWxkU2l6ZT1cXFwibGFyZ2VcXFwiXFxuICAgICAgICAgICBbc3RhdHVzXT1cXFwicmVQYXNzLnRvdWNoZWRcXG4gICAgICAgICAgICAgICA/IChyZVBhc3MuaW52YWxpZCB8fCBwYXNzd29yZC52YWx1ZSAhPSByZVBhc3MudmFsdWUgPyAnZGFuZ2VyJyA6ICdzdWNjZXNzJylcXG4gICAgICAgICAgICAgICA6ICcnXFxcIlxcbiAgICAgICAgICAgW3JlcXVpcmVkXT1cXFwiZ2V0Q29uZmlnVmFsdWUoJ2Zvcm1zLnZhbGlkYXRpb24ucGFzc3dvcmQucmVxdWlyZWQnKVxcXCJcXG4gICAgICAgICAgIFthdHRyLmFyaWEtaW52YWxpZF09XFxcInJlUGFzcy5pbnZhbGlkICYmIHJlUGFzcy50b3VjaGVkID8gdHJ1ZSA6IG51bGxcXFwiPlxcbiAgICA8bmctY29udGFpbmVyICpuZ0lmPVxcXCJyZVBhc3MudG91Y2hlZFxcXCI+XFxuICAgICAgPHAgY2xhc3M9XFxcImNhcHRpb24gc3RhdHVzLWRhbmdlclxcXCIgKm5nSWY9XFxcInJlUGFzcy5pbnZhbGlkICYmIHJlUGFzcy5lcnJvcnM/LnJlcXVpcmVkXFxcIj5cXG4gICAgICAgIFBhc3N3b3JkIGNvbmZpcm1hdGlvbiBpcyByZXF1aXJlZCFcXG4gICAgICA8L3A+XFxuICAgICAgPHAgY2xhc3M9XFxcImNhcHRpb24gc3RhdHVzLWRhbmdlclxcXCIgKm5nSWY9XFxcInBhc3N3b3JkLnZhbHVlICE9IHJlUGFzcy52YWx1ZSAmJiAhcmVQYXNzLmVycm9ycz8ucmVxdWlyZWRcXFwiPlxcbiAgICAgICAgUGFzc3dvcmQgZG9lcyBub3QgbWF0Y2ggdGhlIGNvbmZpcm0gcGFzc3dvcmQuXFxuICAgICAgPC9wPlxcbiAgICA8L25nLWNvbnRhaW5lcj5cXG4gIDwvZGl2PlxcblxcbiAgPGJ1dHRvbiBuYkJ1dHRvblxcbiAgICAgICAgICBzdGF0dXM9XFxcInByaW1hcnlcXFwiXFxuICAgICAgICAgIGZ1bGxXaWR0aFxcbiAgICAgICAgICBzaXplPVxcXCJsYXJnZVxcXCJcXG4gICAgICAgICAgW2Rpc2FibGVkXT1cXFwic3VibWl0dGVkIHx8ICFyZXNldFBhc3NGb3JtLnZhbGlkXFxcIlxcbiAgICAgICAgICBbY2xhc3MuYnRuLXB1bHNlXT1cXFwic3VibWl0dGVkXFxcIj5cXG4gICAgQ2hhbmdlIHBhc3N3b3JkXFxuICA8L2J1dHRvbj5cXG48L2Zvcm0+XFxuXFxuPHNlY3Rpb24gY2xhc3M9XFxcInNpZ24taW4tb3ItdXBcXFwiIGFyaWEtbGFiZWw9XFxcIlNpZ24gaW4gb3Igc2lnbiB1cFxcXCI+XFxuICA8cD48YSBjbGFzcz1cXFwidGV4dC1saW5rXFxcIiByb3V0ZXJMaW5rPVxcXCIuLi9sb2dpblxcXCI+QmFjayB0byBMb2cgSW48L2E+PC9wPlxcbiAgPHA+PGEgY2xhc3M9XFxcInRleHQtbGlua1xcXCIgcm91dGVyTGluaz1cXFwiLi4vcmVnaXN0ZXJcXFwiPlJlZ2lzdGVyPC9hPjwvcD5cXG48L3NlY3Rpb24+XFxuXCIsXG4gICAgICAgIGNoYW5nZURldGVjdGlvbjogQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3kuT25QdXNoLFxuICAgICAgICBzdHlsZXM6IFtcIjpob3N0IC5mb3JtLWdyb3VwOmxhc3Qtb2YtdHlwZXttYXJnaW4tYm90dG9tOjNyZW19XFxuXCJdXG4gICAgfSksXG4gICAgX19wYXJhbSQ3KDEsIEluamVjdChOQl9BVVRIX09QVElPTlMpKSxcbiAgICBfX21ldGFkYXRhJDExKFwiZGVzaWduOnBhcmFtdHlwZXNcIiwgW05iQXV0aFNlcnZpY2UsIE9iamVjdCwgQ2hhbmdlRGV0ZWN0b3JSZWYsXG4gICAgICAgIFJvdXRlcl0pXG5dLCBOYlJlc2V0UGFzc3dvcmRDb21wb25lbnQpO1xuXG52YXIgX19kZWNvcmF0ZSA9ICh0aGlzICYmIHRoaXMuX19kZWNvcmF0ZSkgfHwgZnVuY3Rpb24gKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKSB7XG4gICAgdmFyIGMgPSBhcmd1bWVudHMubGVuZ3RoLCByID0gYyA8IDMgPyB0YXJnZXQgOiBkZXNjID09PSBudWxsID8gZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBrZXkpIDogZGVzYywgZDtcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QuZGVjb3JhdGUgPT09IFwiZnVuY3Rpb25cIikgciA9IFJlZmxlY3QuZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpO1xuICAgIGVsc2UgZm9yICh2YXIgaSA9IGRlY29yYXRvcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIGlmIChkID0gZGVjb3JhdG9yc1tpXSkgciA9IChjIDwgMyA/IGQocikgOiBjID4gMyA/IGQodGFyZ2V0LCBrZXksIHIpIDogZCh0YXJnZXQsIGtleSkpIHx8IHI7XG4gICAgcmV0dXJuIGMgPiAzICYmIHIgJiYgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCByKSwgcjtcbn07XG52YXIgTmJBdXRoTW9kdWxlXzE7XG5mdW5jdGlvbiBuYlN0cmF0ZWdpZXNGYWN0b3J5KG9wdGlvbnMsIGluamVjdG9yKSB7XG4gICAgY29uc3Qgc3RyYXRlZ2llcyA9IFtdO1xuICAgIG9wdGlvbnMuc3RyYXRlZ2llc1xuICAgICAgICAuZm9yRWFjaCgoW3N0cmF0ZWd5Q2xhc3MsIHN0cmF0ZWd5T3B0aW9uc10pID0+IHtcbiAgICAgICAgY29uc3Qgc3RyYXRlZ3kgPSBpbmplY3Rvci5nZXQoc3RyYXRlZ3lDbGFzcyk7XG4gICAgICAgIHN0cmF0ZWd5LnNldE9wdGlvbnMoc3RyYXRlZ3lPcHRpb25zKTtcbiAgICAgICAgc3RyYXRlZ2llcy5wdXNoKHN0cmF0ZWd5KTtcbiAgICB9KTtcbiAgICByZXR1cm4gc3RyYXRlZ2llcztcbn1cbmZ1bmN0aW9uIG5iVG9rZW5zRmFjdG9yeShzdHJhdGVnaWVzKSB7XG4gICAgY29uc3QgdG9rZW5zID0gW107XG4gICAgc3RyYXRlZ2llc1xuICAgICAgICAuZm9yRWFjaCgoc3RyYXRlZ3kpID0+IHtcbiAgICAgICAgdG9rZW5zLnB1c2goc3RyYXRlZ3kuZ2V0T3B0aW9uKCd0b2tlbi5jbGFzcycpKTtcbiAgICB9KTtcbiAgICByZXR1cm4gdG9rZW5zO1xufVxuZnVuY3Rpb24gbmJPcHRpb25zRmFjdG9yeShvcHRpb25zKSB7XG4gICAgcmV0dXJuIGRlZXBFeHRlbmQoZGVmYXVsdEF1dGhPcHRpb25zLCBvcHRpb25zKTtcbn1cbmZ1bmN0aW9uIG5iTm9PcEludGVyY2VwdG9yRmlsdGVyKHJlcSkge1xuICAgIHJldHVybiB0cnVlO1xufVxubGV0IE5iQXV0aE1vZHVsZSA9IE5iQXV0aE1vZHVsZV8xID0gY2xhc3MgTmJBdXRoTW9kdWxlIHtcbiAgICBzdGF0aWMgZm9yUm9vdChuYkF1dGhPcHRpb25zKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBuZ01vZHVsZTogTmJBdXRoTW9kdWxlXzEsXG4gICAgICAgICAgICBwcm92aWRlcnM6IFtcbiAgICAgICAgICAgICAgICB7IHByb3ZpZGU6IE5CX0FVVEhfVVNFUl9PUFRJT05TLCB1c2VWYWx1ZTogbmJBdXRoT3B0aW9ucyB9LFxuICAgICAgICAgICAgICAgIHsgcHJvdmlkZTogTkJfQVVUSF9PUFRJT05TLCB1c2VGYWN0b3J5OiBuYk9wdGlvbnNGYWN0b3J5LCBkZXBzOiBbTkJfQVVUSF9VU0VSX09QVElPTlNdIH0sXG4gICAgICAgICAgICAgICAgeyBwcm92aWRlOiBOQl9BVVRIX1NUUkFURUdJRVMsIHVzZUZhY3Rvcnk6IG5iU3RyYXRlZ2llc0ZhY3RvcnksIGRlcHM6IFtOQl9BVVRIX09QVElPTlMsIEluamVjdG9yXSB9LFxuICAgICAgICAgICAgICAgIHsgcHJvdmlkZTogTkJfQVVUSF9UT0tFTlMsIHVzZUZhY3Rvcnk6IG5iVG9rZW5zRmFjdG9yeSwgZGVwczogW05CX0FVVEhfU1RSQVRFR0lFU10gfSxcbiAgICAgICAgICAgICAgICB7IHByb3ZpZGU6IE5CX0FVVEhfRkFMTEJBQ0tfVE9LRU4sIHVzZVZhbHVlOiBOYkF1dGhTaW1wbGVUb2tlbiB9LFxuICAgICAgICAgICAgICAgIHsgcHJvdmlkZTogTkJfQVVUSF9JTlRFUkNFUFRPUl9IRUFERVIsIHVzZVZhbHVlOiAnQXV0aG9yaXphdGlvbicgfSxcbiAgICAgICAgICAgICAgICB7IHByb3ZpZGU6IE5CX0FVVEhfVE9LRU5fSU5URVJDRVBUT1JfRklMVEVSLCB1c2VWYWx1ZTogbmJOb09wSW50ZXJjZXB0b3JGaWx0ZXIgfSxcbiAgICAgICAgICAgICAgICB7IHByb3ZpZGU6IE5iVG9rZW5TdG9yYWdlLCB1c2VDbGFzczogTmJUb2tlbkxvY2FsU3RvcmFnZSB9LFxuICAgICAgICAgICAgICAgIE5iQXV0aFRva2VuUGFyY2VsZXIsXG4gICAgICAgICAgICAgICAgTmJBdXRoU2VydmljZSxcbiAgICAgICAgICAgICAgICBOYlRva2VuU2VydmljZSxcbiAgICAgICAgICAgICAgICBOYkR1bW15QXV0aFN0cmF0ZWd5LFxuICAgICAgICAgICAgICAgIE5iUGFzc3dvcmRBdXRoU3RyYXRlZ3ksXG4gICAgICAgICAgICAgICAgTmJPQXV0aDJBdXRoU3RyYXRlZ3ksXG4gICAgICAgICAgICBdLFxuICAgICAgICB9O1xuICAgIH1cbn07XG5OYkF1dGhNb2R1bGUgPSBOYkF1dGhNb2R1bGVfMSA9IF9fZGVjb3JhdGUoW1xuICAgIE5nTW9kdWxlKHtcbiAgICAgICAgaW1wb3J0czogW1xuICAgICAgICAgICAgQ29tbW9uTW9kdWxlLFxuICAgICAgICAgICAgTmJMYXlvdXRNb2R1bGUsXG4gICAgICAgICAgICBOYkNhcmRNb2R1bGUsXG4gICAgICAgICAgICBOYkNoZWNrYm94TW9kdWxlLFxuICAgICAgICAgICAgTmJBbGVydE1vZHVsZSxcbiAgICAgICAgICAgIE5iSW5wdXRNb2R1bGUsXG4gICAgICAgICAgICBOYkJ1dHRvbk1vZHVsZSxcbiAgICAgICAgICAgIFJvdXRlck1vZHVsZSxcbiAgICAgICAgICAgIEZvcm1zTW9kdWxlLFxuICAgICAgICAgICAgTmJJY29uTW9kdWxlLFxuICAgICAgICBdLFxuICAgICAgICBkZWNsYXJhdGlvbnM6IFtcbiAgICAgICAgICAgIE5iQXV0aENvbXBvbmVudCxcbiAgICAgICAgICAgIE5iQXV0aEJsb2NrQ29tcG9uZW50LFxuICAgICAgICAgICAgTmJMb2dpbkNvbXBvbmVudCxcbiAgICAgICAgICAgIE5iUmVnaXN0ZXJDb21wb25lbnQsXG4gICAgICAgICAgICBOYlJlcXVlc3RQYXNzd29yZENvbXBvbmVudCxcbiAgICAgICAgICAgIE5iUmVzZXRQYXNzd29yZENvbXBvbmVudCxcbiAgICAgICAgICAgIE5iTG9nb3V0Q29tcG9uZW50LFxuICAgICAgICBdLFxuICAgICAgICBleHBvcnRzOiBbXG4gICAgICAgICAgICBOYkF1dGhDb21wb25lbnQsXG4gICAgICAgICAgICBOYkF1dGhCbG9ja0NvbXBvbmVudCxcbiAgICAgICAgICAgIE5iTG9naW5Db21wb25lbnQsXG4gICAgICAgICAgICBOYlJlZ2lzdGVyQ29tcG9uZW50LFxuICAgICAgICAgICAgTmJSZXF1ZXN0UGFzc3dvcmRDb21wb25lbnQsXG4gICAgICAgICAgICBOYlJlc2V0UGFzc3dvcmRDb21wb25lbnQsXG4gICAgICAgICAgICBOYkxvZ291dENvbXBvbmVudCxcbiAgICAgICAgXSxcbiAgICB9KVxuXSwgTmJBdXRoTW9kdWxlKTtcblxuY29uc3Qgcm91dGVzID0gW1xuICAgIHtcbiAgICAgICAgcGF0aDogJ2F1dGgnLFxuICAgICAgICBjb21wb25lbnQ6IE5iQXV0aENvbXBvbmVudCxcbiAgICAgICAgY2hpbGRyZW46IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBwYXRoOiAnJyxcbiAgICAgICAgICAgICAgICBjb21wb25lbnQ6IE5iTG9naW5Db21wb25lbnQsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHBhdGg6ICdsb2dpbicsXG4gICAgICAgICAgICAgICAgY29tcG9uZW50OiBOYkxvZ2luQ29tcG9uZW50LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBwYXRoOiAncmVnaXN0ZXInLFxuICAgICAgICAgICAgICAgIGNvbXBvbmVudDogTmJSZWdpc3RlckNvbXBvbmVudCxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcGF0aDogJ2xvZ291dCcsXG4gICAgICAgICAgICAgICAgY29tcG9uZW50OiBOYkxvZ291dENvbXBvbmVudCxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcGF0aDogJ3JlcXVlc3QtcGFzc3dvcmQnLFxuICAgICAgICAgICAgICAgIGNvbXBvbmVudDogTmJSZXF1ZXN0UGFzc3dvcmRDb21wb25lbnQsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHBhdGg6ICdyZXNldC1wYXNzd29yZCcsXG4gICAgICAgICAgICAgICAgY29tcG9uZW50OiBOYlJlc2V0UGFzc3dvcmRDb21wb25lbnQsXG4gICAgICAgICAgICB9LFxuICAgICAgICBdLFxuICAgIH0sXG5dO1xuXG52YXIgX19kZWNvcmF0ZSQxNSA9ICh0aGlzICYmIHRoaXMuX19kZWNvcmF0ZSkgfHwgZnVuY3Rpb24gKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKSB7XG4gICAgdmFyIGMgPSBhcmd1bWVudHMubGVuZ3RoLCByID0gYyA8IDMgPyB0YXJnZXQgOiBkZXNjID09PSBudWxsID8gZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBrZXkpIDogZGVzYywgZDtcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QuZGVjb3JhdGUgPT09IFwiZnVuY3Rpb25cIikgciA9IFJlZmxlY3QuZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpO1xuICAgIGVsc2UgZm9yICh2YXIgaSA9IGRlY29yYXRvcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIGlmIChkID0gZGVjb3JhdG9yc1tpXSkgciA9IChjIDwgMyA/IGQocikgOiBjID4gMyA/IGQodGFyZ2V0LCBrZXksIHIpIDogZCh0YXJnZXQsIGtleSkpIHx8IHI7XG4gICAgcmV0dXJuIGMgPiAzICYmIHIgJiYgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCByKSwgcjtcbn07XG52YXIgX19tZXRhZGF0YSQxMiA9ICh0aGlzICYmIHRoaXMuX19tZXRhZGF0YSkgfHwgZnVuY3Rpb24gKGssIHYpIHtcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QubWV0YWRhdGEgPT09IFwiZnVuY3Rpb25cIikgcmV0dXJuIFJlZmxlY3QubWV0YWRhdGEoaywgdik7XG59O1xudmFyIF9fcGFyYW0kOCA9ICh0aGlzICYmIHRoaXMuX19wYXJhbSkgfHwgZnVuY3Rpb24gKHBhcmFtSW5kZXgsIGRlY29yYXRvcikge1xuICAgIHJldHVybiBmdW5jdGlvbiAodGFyZ2V0LCBrZXkpIHsgZGVjb3JhdG9yKHRhcmdldCwga2V5LCBwYXJhbUluZGV4KTsgfVxufTtcbmxldCBOYkF1dGhKV1RJbnRlcmNlcHRvciA9IGNsYXNzIE5iQXV0aEpXVEludGVyY2VwdG9yIHtcbiAgICBjb25zdHJ1Y3RvcihpbmplY3RvciwgZmlsdGVyJCQxKSB7XG4gICAgICAgIHRoaXMuaW5qZWN0b3IgPSBpbmplY3RvcjtcbiAgICAgICAgdGhpcy5maWx0ZXIgPSBmaWx0ZXIkJDE7XG4gICAgfVxuICAgIGludGVyY2VwdChyZXEsIG5leHQpIHtcbiAgICAgICAgLy8gZG8gbm90IGludGVyY2VwdCByZXF1ZXN0IHdob3NlIHVybHMgYXJlIGZpbHRlcmVkIGJ5IHRoZSBpbmplY3RlZCBmaWx0ZXJcbiAgICAgICAgaWYgKCF0aGlzLmZpbHRlcihyZXEpKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5hdXRoU2VydmljZS5pc0F1dGhlbnRpY2F0ZWRPclJlZnJlc2goKVxuICAgICAgICAgICAgICAgIC5waXBlKHN3aXRjaE1hcChhdXRoZW50aWNhdGVkID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoYXV0aGVudGljYXRlZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5hdXRoU2VydmljZS5nZXRUb2tlbigpLnBpcGUoc3dpdGNoTWFwKCh0b2tlbikgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgSldUID0gYEJlYXJlciAke3Rva2VuLmdldFZhbHVlKCl9YDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcSA9IHJlcS5jbG9uZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0SGVhZGVyczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiBKV1QsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5leHQuaGFuZGxlKHJlcSk7XG4gICAgICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFJlcXVlc3QgaXMgc2VudCB0byBzZXJ2ZXIgd2l0aG91dCBhdXRoZW50aWNhdGlvbiBzbyB0aGF0IHRoZSBjbGllbnQgY29kZVxuICAgICAgICAgICAgICAgICAgICAvLyByZWNlaXZlcyB0aGUgNDAxLzQwMyBlcnJvciBhbmQgY2FuIGFjdCBhcyBkZXNpcmVkICgnc2Vzc2lvbiBleHBpcmVkJywgcmVkaXJlY3QgdG8gbG9naW4sIGFzbylcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5leHQuaGFuZGxlKHJlcSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIG5leHQuaGFuZGxlKHJlcSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZ2V0IGF1dGhTZXJ2aWNlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5pbmplY3Rvci5nZXQoTmJBdXRoU2VydmljZSk7XG4gICAgfVxufTtcbk5iQXV0aEpXVEludGVyY2VwdG9yID0gX19kZWNvcmF0ZSQxNShbXG4gICAgSW5qZWN0YWJsZSgpLFxuICAgIF9fcGFyYW0kOCgxLCBJbmplY3QoTkJfQVVUSF9UT0tFTl9JTlRFUkNFUFRPUl9GSUxURVIpKSxcbiAgICBfX21ldGFkYXRhJDEyKFwiZGVzaWduOnBhcmFtdHlwZXNcIiwgW0luamVjdG9yLCBPYmplY3RdKVxuXSwgTmJBdXRoSldUSW50ZXJjZXB0b3IpO1xuXG52YXIgX19kZWNvcmF0ZSQxNiA9ICh0aGlzICYmIHRoaXMuX19kZWNvcmF0ZSkgfHwgZnVuY3Rpb24gKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKSB7XG4gICAgdmFyIGMgPSBhcmd1bWVudHMubGVuZ3RoLCByID0gYyA8IDMgPyB0YXJnZXQgOiBkZXNjID09PSBudWxsID8gZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBrZXkpIDogZGVzYywgZDtcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QuZGVjb3JhdGUgPT09IFwiZnVuY3Rpb25cIikgciA9IFJlZmxlY3QuZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpO1xuICAgIGVsc2UgZm9yICh2YXIgaSA9IGRlY29yYXRvcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIGlmIChkID0gZGVjb3JhdG9yc1tpXSkgciA9IChjIDwgMyA/IGQocikgOiBjID4gMyA/IGQodGFyZ2V0LCBrZXksIHIpIDogZCh0YXJnZXQsIGtleSkpIHx8IHI7XG4gICAgcmV0dXJuIGMgPiAzICYmIHIgJiYgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCByKSwgcjtcbn07XG52YXIgX19tZXRhZGF0YSQxMyA9ICh0aGlzICYmIHRoaXMuX19tZXRhZGF0YSkgfHwgZnVuY3Rpb24gKGssIHYpIHtcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QubWV0YWRhdGEgPT09IFwiZnVuY3Rpb25cIikgcmV0dXJuIFJlZmxlY3QubWV0YWRhdGEoaywgdik7XG59O1xudmFyIF9fcGFyYW0kOSA9ICh0aGlzICYmIHRoaXMuX19wYXJhbSkgfHwgZnVuY3Rpb24gKHBhcmFtSW5kZXgsIGRlY29yYXRvcikge1xuICAgIHJldHVybiBmdW5jdGlvbiAodGFyZ2V0LCBrZXkpIHsgZGVjb3JhdG9yKHRhcmdldCwga2V5LCBwYXJhbUluZGV4KTsgfVxufTtcbmxldCBOYkF1dGhTaW1wbGVJbnRlcmNlcHRvciA9IGNsYXNzIE5iQXV0aFNpbXBsZUludGVyY2VwdG9yIHtcbiAgICBjb25zdHJ1Y3RvcihpbmplY3RvciwgaGVhZGVyTmFtZSA9ICdBdXRob3JpemF0aW9uJykge1xuICAgICAgICB0aGlzLmluamVjdG9yID0gaW5qZWN0b3I7XG4gICAgICAgIHRoaXMuaGVhZGVyTmFtZSA9IGhlYWRlck5hbWU7XG4gICAgfVxuICAgIGludGVyY2VwdChyZXEsIG5leHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYXV0aFNlcnZpY2UuZ2V0VG9rZW4oKVxuICAgICAgICAgICAgLnBpcGUoc3dpdGNoTWFwKCh0b2tlbikgPT4ge1xuICAgICAgICAgICAgaWYgKHRva2VuICYmIHRva2VuLmdldFZhbHVlKCkpIHtcbiAgICAgICAgICAgICAgICByZXEgPSByZXEuY2xvbmUoe1xuICAgICAgICAgICAgICAgICAgICBzZXRIZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBbdGhpcy5oZWFkZXJOYW1lXTogdG9rZW4uZ2V0VmFsdWUoKSxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBuZXh0LmhhbmRsZShyZXEpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGdldCBhdXRoU2VydmljZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaW5qZWN0b3IuZ2V0KE5iQXV0aFNlcnZpY2UpO1xuICAgIH1cbn07XG5OYkF1dGhTaW1wbGVJbnRlcmNlcHRvciA9IF9fZGVjb3JhdGUkMTYoW1xuICAgIEluamVjdGFibGUoKSxcbiAgICBfX3BhcmFtJDkoMSwgSW5qZWN0KE5CX0FVVEhfSU5URVJDRVBUT1JfSEVBREVSKSksXG4gICAgX19tZXRhZGF0YSQxMyhcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtJbmplY3RvciwgU3RyaW5nXSlcbl0sIE5iQXV0aFNpbXBsZUludGVyY2VwdG9yKTtcblxuY2xhc3MgTmJVc2VyIHtcbiAgICBjb25zdHJ1Y3RvcihpZCwgZW1haWwsIHBhc3N3b3JkLCByZW1lbWJlck1lLCB0ZXJtcywgY29uZmlybVBhc3N3b3JkLCBmdWxsTmFtZSkge1xuICAgICAgICB0aGlzLmlkID0gaWQ7XG4gICAgICAgIHRoaXMuZW1haWwgPSBlbWFpbDtcbiAgICAgICAgdGhpcy5wYXNzd29yZCA9IHBhc3N3b3JkO1xuICAgICAgICB0aGlzLnJlbWVtYmVyTWUgPSByZW1lbWJlck1lO1xuICAgICAgICB0aGlzLnRlcm1zID0gdGVybXM7XG4gICAgICAgIHRoaXMuY29uZmlybVBhc3N3b3JkID0gY29uZmlybVBhc3N3b3JkO1xuICAgICAgICB0aGlzLmZ1bGxOYW1lID0gZnVsbE5hbWU7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgQWt2ZW8uIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIExpY2Vuc2UuIFNlZSBMaWNlbnNlLnR4dCBpbiB0aGUgcHJvamVjdCByb290IGZvciBsaWNlbnNlIGluZm9ybWF0aW9uLlxuICovXG5cbi8qKlxuICogR2VuZXJhdGVkIGJ1bmRsZSBpbmRleC4gRG8gbm90IGVkaXQuXG4gKi9cblxuZXhwb3J0IHsgZGVmYXVsdEF1dGhPcHRpb25zLCBOQl9BVVRIX09QVElPTlMsIE5CX0FVVEhfVVNFUl9PUFRJT05TLCBOQl9BVVRIX1NUUkFURUdJRVMsIE5CX0FVVEhfVE9LRU5TLCBOQl9BVVRIX0lOVEVSQ0VQVE9SX0hFQURFUiwgTkJfQVVUSF9UT0tFTl9JTlRFUkNFUFRPUl9GSUxURVIsIG5iU3RyYXRlZ2llc0ZhY3RvcnksIG5iVG9rZW5zRmFjdG9yeSwgbmJPcHRpb25zRmFjdG9yeSwgbmJOb09wSW50ZXJjZXB0b3JGaWx0ZXIsIE5iQXV0aE1vZHVsZSwgcm91dGVzLCBOYkF1dGhDb21wb25lbnQsIE5iQXV0aEJsb2NrQ29tcG9uZW50LCBOYkxvZ2luQ29tcG9uZW50LCBOYkxvZ291dENvbXBvbmVudCwgTmJSZWdpc3RlckNvbXBvbmVudCwgTmJSZXF1ZXN0UGFzc3dvcmRDb21wb25lbnQsIE5iUmVzZXRQYXNzd29yZENvbXBvbmVudCwgTmJBdXRoU2VydmljZSwgTmJBdXRoUmVzdWx0LCBOYkF1dGhKV1RJbnRlcmNlcHRvciwgTmJBdXRoU2ltcGxlSW50ZXJjZXB0b3IsIE5iQXV0aFRva2VuLCBOYkF1dGhUb2tlbk5vdEZvdW5kRXJyb3IsIE5iQXV0aElsbGVnYWxUb2tlbkVycm9yLCBOYkF1dGhFbXB0eVRva2VuRXJyb3IsIE5iQXV0aElsbGVnYWxKV1RUb2tlbkVycm9yLCBuYkF1dGhDcmVhdGVUb2tlbiwgZGVjb2RlSnd0UGF5bG9hZCwgTmJBdXRoU2ltcGxlVG9rZW4sIE5iQXV0aEpXVFRva2VuLCBOYkF1dGhPQXV0aDJUb2tlbiwgTmJBdXRoT0F1dGgySldUVG9rZW4sIMm1MCwgTmJUb2tlblN0b3JhZ2UsIE5iVG9rZW5Mb2NhbFN0b3JhZ2UsIE5iVG9rZW5TZXJ2aWNlLCBOQl9BVVRIX0ZBTExCQUNLX1RPS0VOLCBOYkF1dGhUb2tlblBhcmNlbGVyLCBOYkF1dGhTdHJhdGVneSwgTmJBdXRoU3RyYXRlZ3lPcHRpb25zLCBOYkR1bW15QXV0aFN0cmF0ZWd5LCBOYkR1bW15QXV0aFN0cmF0ZWd5T3B0aW9ucywgZHVtbXlTdHJhdGVneU9wdGlvbnMsIE5iUGFzc3dvcmRBdXRoU3RyYXRlZ3ksIE5iUGFzc3dvcmRBdXRoU3RyYXRlZ3lPcHRpb25zLCBwYXNzd29yZFN0cmF0ZWd5T3B0aW9ucywgTmJPQXV0aDJBdXRoU3RyYXRlZ3ksIE5iT0F1dGgyUmVzcG9uc2VUeXBlLCBOYk9BdXRoMkdyYW50VHlwZSwgTmJPQXV0aDJDbGllbnRBdXRoTWV0aG9kLCBOYk9BdXRoMkF1dGhTdHJhdGVneU9wdGlvbnMsIGF1dGgyU3RyYXRlZ3lPcHRpb25zLCBOYlVzZXIsIGRlZXBFeHRlbmQsIGdldERlZXBGcm9tT2JqZWN0LCB1cmxCYXNlNjREZWNvZGUsIGI2NGRlY29kZSwgYjY0RGVjb2RlVW5pY29kZSB9O1xuIl19","map":null,"metadata":{},"sourceType":"module"}